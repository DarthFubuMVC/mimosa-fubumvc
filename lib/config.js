"use strict";
var path, _;

_ = require("lodash");

path = require('path');

exports.defaults = function() {
  return {
    fubumvc: {
      usePolling: true,
      interval: 500,
      binaryInterval: 1000,
      excludePaths: ["bin", "obj", /^\./],
      conventions: []
    }
  };
};

exports.placeholder = function() {
  return "\t\n\n# fubumvc:\n  # usePolling: true\n  # interval: 500\n  # binaryInterval: 1000\n  # excludePaths: [\"bin\", \"obj\", /^\./]\n  # conventions: [\n    # provide 0 or more conventions\n    # { \n      # match: (file, ext, log) ->\n        # true #filename and extension, return true/false,\n      # transform: (file, path, log) ->\n        # file #filename and path module to do path.join, etc\n    # }\n  # ]";
};

exports.validate = function(config, validators) {
  var baseDir, binaryInterval, compiledDir, conventions, conventionsOk, errors, excludePaths, excludePathsOk, fubumvc, ignorePaths, interval, sourceDir, usePolling, _ref;
  errors = [];
  fubumvc = config.fubumvc;
  if (!((fubumvc != null) && _.isObject(fubumvc))) {
    errors.push("fubumvc config");
    return errors;
  }
  excludePaths = fubumvc.excludePaths, conventions = fubumvc.conventions, usePolling = fubumvc.usePolling, interval = fubumvc.interval, binaryInterval = fubumvc.binaryInterval, baseDir = fubumvc.baseDir;
  if (!((baseDir == null) || ((baseDir != null) && path.exists(baseDir)))) {
    errors.push("fubumvc.baseDir");
    return errors;
  }
  if (!((usePolling != null) && _.isBoolean(usePolling))) {
    errors.push("fubumvc.usePolling");
    return errors;
  }
  if (!((interval != null) && _.isNumber(interval))) {
    errors.push("fubumvc.interval");
    return errors;
  }
  if (!((binaryInterval != null) && _.isNumber(binaryInterval))) {
    errors.push("fubumvc.binaryInterval");
    return errors;
  }
  if (!((excludePaths != null) && _.isArray(excludePaths))) {
    errors.push("fubumvc.excludePaths");
    return errors;
  }
  excludePathsOk = _.all(excludePaths, function(item) {
    return _.isString(item) || _.isRegExp(item);
  });
  if (!excludePathsOk) {
    errors.push("fubumvc.excludePaths entries must be either strings or regexes");
    return errors;
  }
  if (!((conventions != null) && _.isArray(conventions))) {
    errors.push("fubumvc.conventions");
    return errors;
  }
  conventionsOk = _.all(conventions, function(item) {
    return _.isObject(item) && _.all(["match", "transform"], function(func) {
      return _.isFunction(item[func]);
    });
  });
  if (!conventionsOk) {
    errors.push("fubumvc.conventions entries must be objects with match: (file, ext) -> and transform: (file, path) ->");
    return errors;
  }
  _ref = config.watch, sourceDir = _ref.sourceDir, compiledDir = _ref.compiledDir;
  ignorePaths = _.map([sourceDir, compiledDir, 'node_modules'], function(p) {
    return path.basename(p);
  });
  config.fubumvc.excludePaths = excludePaths.concat(ignorePaths);
  config.fubumvc.sourceDir = sourceDir;
  config.fubumvc.compiledDir = compiledDir;
  config.fubumvc.isBuild = config.isBuild;
  return errors;
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL21udC9SZXNvdXJjZXMvUHJvamVjdHMvbWltb3NhLWZ1YnVtdmMvbGliL2NvbmZpZy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi9tbnQvUmVzb3VyY2VzL1Byb2plY3RzL21pbW9zYS1mdWJ1bXZjL3NyYy9jb25maWcuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLFlBQUEsQ0FBQTtBQUFBLElBQUEsT0FBQTs7QUFBQSxDQUVBLEdBQUksT0FBQSxDQUFRLFFBQVIsQ0FGSixDQUFBOztBQUFBLElBR0EsR0FBTyxPQUFBLENBQVEsTUFBUixDQUhQLENBQUE7O0FBQUEsT0FLTyxDQUFDLFFBQVIsR0FBbUIsU0FBQSxHQUFBO1NBQ2pCO0FBQUEsSUFBQSxPQUFBLEVBQ0U7QUFBQSxNQUFBLFVBQUEsRUFBWSxJQUFaO0FBQUEsTUFDQSxRQUFBLEVBQVUsR0FEVjtBQUFBLE1BRUEsY0FBQSxFQUFnQixJQUZoQjtBQUFBLE1BR0EsWUFBQSxFQUFjLENBQUMsS0FBRCxFQUFRLEtBQVIsRUFBZSxLQUFmLENBSGQ7QUFBQSxNQUlBLFdBQUEsRUFBYSxFQUpiO0tBREY7SUFEaUI7QUFBQSxDQUxuQixDQUFBOztBQUFBLE9BYU8sQ0FBQyxXQUFSLEdBQXNCLFNBQUEsR0FBQTtTQUNwQiw4WkFEb0I7QUFBQSxDQWJ0QixDQUFBOztBQUFBLE9BaUNPLENBQUMsUUFBUixHQUFtQixTQUFDLE1BQUQsRUFBUyxVQUFULEdBQUE7QUFDakIsTUFBQSxtS0FBQTtBQUFBLEVBQUEsTUFBQSxHQUFTLEVBQVQsQ0FBQTtBQUFBLEVBQ0MsVUFBVyxPQUFYLE9BREQsQ0FBQTtBQUVBLEVBQUEsSUFBQSxDQUFBLENBQU8saUJBQUEsSUFBYSxDQUFDLENBQUMsUUFBRixDQUFXLE9BQVgsQ0FBcEIsQ0FBQTtBQUNFLElBQUEsTUFBTSxDQUFDLElBQVAsQ0FBWSxnQkFBWixDQUFBLENBQUE7QUFDQSxXQUFPLE1BQVAsQ0FGRjtHQUZBO0FBQUEsRUFNQyx1QkFBQSxZ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QUFBLENBQWhELENBaERkLENBQUE7QUFBQSxFQWtEQSxNQUFNLENBQUMsT0FBTyxDQUFDLFlBQWYsR0FBOEIsWUFBWSxDQUFDLE1BQWIsQ0FBb0IsV0FBcEIsQ0FsRDlCLENBQUE7QUFBQSxFQW1EQSxNQUFNLENBQUMsT0FBTyxDQUFDLFNBQWYsR0FBMkIsU0FuRDNCLENBQUE7QUFBQSxFQW9EQSxNQUFNLENBQUMsT0FBTyxDQUFDLFdBQWYsR0FBNkIsV0FwRDdCLENBQUE7QUFBQSxFQXFEQSxNQUFNLENBQUMsT0FBTyxDQUFDLE9BQWYsR0FBeUIsTUFBTSxDQUFDLE9BckRoQyxDQUFBO1NBdURBLE9BeERpQjtBQUFBLENBakNuQixDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCJcblxuXyA9IHJlcXVpcmUgXCJsb2Rhc2hcIlxucGF0aCA9IHJlcXVpcmUgJ3BhdGgnXG5cbmV4cG9ydHMuZGVmYXVsdHMgPSAtPlxuICBmdWJ1bXZjOlxuICAgIHVzZVBvbGxpbmc6IHRydWVcbiAgICBpbnRlcnZhbDogNTAwXG4gICAgYmluYXJ5SW50ZXJ2YWw6IDEwMDBcbiAgICBleGNsdWRlUGF0aHM6IFtcImJpblwiLCBcIm9ialwiLCAvXlxcLi9dXG4gICAgY29udmVudGlvbnM6IFtdXG5cbmV4cG9ydHMucGxhY2Vob2xkZXIgPSAtPlxuICBcIlwiXCJcbiAgXFx0XG5cbiAgIyBmdWJ1bXZjOlxuICAgICMgdXNlUG9sbGluZzogdHJ1ZVxuICAgICMgaW50ZXJ2YWw6IDUwMFxuICAgICMgYmluYXJ5SW50ZXJ2YWw6IDEwMDBcbiAgICAjIGV4Y2x1ZGVQYXRoczogW1wiYmluXCIsIFwib2JqXCIsIC9eXFwuL11cbiAgICAjIGNvbnZlbnRpb25zOiBbXG4gICAgICAjIHByb3ZpZGUgMCBvciBtb3JlIGNvbnZlbnRpb25zXG4gICAgICAjIHsgXG4gICAgICAgICMgbWF0Y2g6IChmaWxlLCBleHQsIGxvZykgLT5cbiAgICAgICAgICAjIHRydWUgI2ZpbGVuYW1lIGFuZCBleHRlbnNpb24sIHJldHVybiB0cnVlL2ZhbHNlLFxuICAgICAgICAjIHRyYW5zZm9ybTogKGZpbGUsIHBhdGgsIGxvZykgLT5cbiAgICAgICAgICAjIGZpbGUgI2ZpbGVuYW1lIGFuZCBwYXRoIG1vZHVsZSB0byBkbyBwYXRoLmpvaW4sIGV0Y1xuICAgICAgIyB9XG4gICAgIyBdXG4gIFwiXCJcIlxuXG5leHBvcnRzLnZhbGlkYXRlID0gKGNvbmZpZywgdmFsaWRhdG9ycykgLT5cbiAgZXJyb3JzID0gW11cbiAge2Z1YnVtdmN9ID0gY29uZmlnXG4gIHVubGVzcyBmdWJ1bXZjPyBhbmQgXy5pc09iamVjdCBmdWJ1bXZjXG4gICAgZXJyb3JzLnB1c2ggXCJmdWJ1bXZjIGNvbmZpZ1wiXG4gICAgcmV0dXJuIGVycm9yc1xuXG4gIHtleGNsdWRlUGF0aHMsIGNvbnZlbnRpb25zLCB1c2VQb2xsaW5nLCBpbnRlcnZhbCwgYmluYXJ5SW50ZXJ2YWwsIGJhc2VEaXJ9ID0gZnVidW12Y1xuXG4gIHVubGVzcyAhYmFzZURpcj8gb3IgKGJhc2VEaXI/IGFuZCBwYXRoLmV4aXN0cyBiYXNlRGlyKVxuICAgIGVycm9ycy5wdXNoIFwiZnVidW12Yy5iYXNlRGlyXCJcbiAgICByZXR1cm4gZXJyb3JzXG5cbiAgdW5sZXNzIHVzZVBvbGxpbmc/IGFuZCBfLmlzQm9vbGVhbiB1c2VQb2xsaW5nXG4gICAgZXJyb3JzLnB1c2ggXCJmdWJ1bXZjLnVzZVBvbGxpbmdcIlxuICAgIHJldHVybiBlcnJvcnNcblxuICB1bmxlc3MgaW50ZXJ2YWw/IGFuZCBfLmlzTnVtYmVyIGludGVydmFsXG4gICAgZXJyb3JzLnB1c2ggXCJmdWJ1bXZjLmludGVydmFsXCJcbiAgICByZXR1cm4gZXJyb3JzXG5cbiAgdW5sZXNzIGJpbmFyeUludGVydmFsPyBhbmQgXy5pc051bWJlciBiaW5hcnlJbnRlcnZhbFxuICAgIGVycm9ycy5wdXNoIFwiZnVidW12Yy5iaW5hcnlJbnRlcnZhbFwiXG4gICAgcmV0dXJuIGVycm9yc1xuXG4gIHVubGVzcyBleGNsdWRlUGF0aHM/IGFuZCBfLmlzQXJyYXkgZXhjbHVkZVBhdGhzXG4gICAgZXJyb3JzLnB1c2ggXCJmdWJ1bXZjLmV4Y2x1ZGVQYXRoc1wiXG4gICAgcmV0dXJuIGVycm9yc1xuXG4gIGV4Y2x1ZGVQYXRoc09rID0gXy5hbGwgZXhjbHVkZVBhdGhzLCAoaXRlbSkgLT5cbiAgICBfLmlzU3RyaW5nKGl0ZW0pIG9yIF8uaXNSZWdFeHAoaXRlbSlcblxuICB1bmxlc3MgZXhjbHVkZVBhdGhzT2tcbiAgICBlcnJvcnMucHVzaCBcImZ1YnVtdmMuZXhjbHVkZVBhdGhzIGVudHJpZXMgbXVzdCBiZSBlaXRoZXIgc3RyaW5ncyBvciByZWdleGVzXCJcbiAgICByZXR1cm4gZXJyb3JzXG5cbiAgdW5sZXNzIGNvbnZlbnRpb25zPyBhbmQgXy5pc0FycmF5IGNvbnZlbnRpb25zXG4gICAgZXJyb3JzLnB1c2ggXCJmdWJ1bXZjLmNvbnZlbnRpb25zXCJcbiAgICByZXR1cm4gZXJyb3JzXG5cbiAgY29udmVudGlvbnNPayA9IF8uYWxsIGNvbnZlbnRpb25zLCAoaXRlbSkgLT5cbiAgICBfLmlzT2JqZWN0KGl0ZW0pIGFuZCBfLmFsbCBbXCJtYXRjaFwiLCBcInRyYW5zZm9ybVwiXSwgKGZ1bmMpIC0+IF8uaXNGdW5jdGlvbiBpdGVtW2Z1bmNdXG5cbiAgdW5sZXNzIGNvbnZlbnRpb25zT2tcbiAgICBlcnJvcnMucHVzaCBcImZ1YnVtdmMuY29udmVudGlvbnMgZW50cmllcyBtdXN0IGJlIG9iamVjdHMgd2l0aCBtYXRjaDogKGZpbGUsIGV4dCkgLT4gYW5kIHRyYW5zZm9ybTogKGZpbGUsIHBhdGgpIC0+XCJcbiAgICByZXR1cm4gZXJyb3JzXG5cbiAgI2F1dG8taW5jbHVkZSB0aGUgc291cmNlRGlyIGFuZCBjb21waWxlZERpciBpbnRvIGV4Y2x1ZGVQYXRocyBsaXN0XG4gIHt3YXRjaDoge3NvdXJjZURpciwgY29tcGlsZWREaXJ9fSA9IGNvbmZpZ1xuICBpZ25vcmVQYXRocyA9IF8ubWFwIFtzb3VyY2VEaXIsIGNvbXBpbGVkRGlyLCAnbm9kZV9tb2R1bGVzJ10sIChwKSAtPiBwYXRoLmJhc2VuYW1lIHBcblxuICBjb25maWcuZnVidW12Yy5leGNsdWRlUGF0aHMgPSBleGNsdWRlUGF0aHMuY29uY2F0IGlnbm9yZVBhdGhzXG4gIGNvbmZpZy5mdWJ1bXZjLnNvdXJjZURpciA9IHNvdXJjZURpclxuICBjb25maWcuZnVidW12Yy5jb21waWxlZERpciA9IGNvbXBpbGVkRGlyXG4gIGNvbmZpZy5mdWJ1bXZjLmlzQnVpbGQgPSBjb25maWcuaXNCdWlsZFxuXG4gIGVycm9yc1xuIl19
