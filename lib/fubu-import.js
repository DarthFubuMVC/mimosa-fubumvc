"use strict";
var Rx, buildExtensions, clean, cleanAssets, color, copyFile, deleteDirectory, deleteFile, deleteFileSync, excludeStrategies, findBottles, findSourceFiles, fs, getTargets, importAssets, isExcludedByConfig, log, matchesWithoutBaseDir, parseString, parseXml, path, prepareFileWatcher, printObj, setWorkingDir, shouldInclude, startWatching, trackCompletion, transformPath, watch, withoutBaseDir, withoutPath, workingDir, wrench, _, _ref;

_ref = require('./util'), log = _ref.log, printObj = _ref.printObj;

color = require('ansi-color').set;

fs = require('fs');

path = require('path');

watch = require('chokidar');

wrench = require('wrench');

_ = require('lodash');

parseString = require('xml2js').parseString;

workingDir = process.cwd();

Rx = require("rx");

findSourceFiles = function(from, extensions, excludes, baseDir) {
  return wrench.readdirSyncRecursive(from).filter(function(f) {
    var isFile, isIncluded, originalFile;
    originalFile = path.join(from, f);
    isFile = fs.statSync(originalFile).isFile();
    isIncluded = shouldInclude(f, isFile, extensions, excludes, baseDir);
    return isIncluded && isFile;
  }).map(function(f) {
    return path.join(from, f);
  });
};

shouldInclude = function(f, isFile, extensions, excludes, baseDir) {
  var atRoot, excluded, ext, matchesExtension;
  extensions = extensions.map(function(ext) {
    return "." + ext;
  });
  ext = path.extname(f);
  matchesExtension = !isFile || _.contains(extensions, ext);
  atRoot = isFile && f.indexOf(path.sep) === -1;
  excluded = isExcludedByConfig(f, excludes, baseDir);
  return matchesExtension && !excluded && !atRoot;
};

withoutPath = function(fromPath) {
  return function(input) {
    return input.replace("" + fromPath + path.sep, '');
  };
};

prepareFileWatcher = function(from, extensions, excludes, isBuild, fileWatcherSettings, baseDir) {
  var adds, changes, errors, files, fixPath, numberOfFiles, observableFor, settings, unlinks, watchSettings, watcher;
  files = findSourceFiles(from, extensions, excludes, baseDir);
  numberOfFiles = files.length;
  fixPath = withoutPath(from);
  settings = {
    ignored: function(file) {
      var f, isFile;
      isFile = fs.statSync(file).isFile();
      f = fixPath(file);
      return !(shouldInclude(f, isFile, extensions, excludes, baseDir));
    },
    persistent: !isBuild
  };
  watchSettings = _.extend(settings, fileWatcherSettings);
  observableFor = function(event) {
    return Rx.Observable.fromEvent(watcher, event);
  };
  log("debug", "starting file watcher on [[ " + from + " ]] usePolling: " + watchSettings.usePolling);
  watcher = watch.watch(from, watchSettings);
  adds = observableFor("add");
  changes = observableFor("change");
  unlinks = observableFor("unlink");
  errors = (observableFor("error")).selectMany(function(e) {
    return Rx.Observable["throw"](e);
  });
  return {
    numberOfFiles: numberOfFiles,
    adds: adds,
    changes: changes,
    unlinks: unlinks,
    errors: errors
  };
};

startWatching = function(from, _arg, options, cb) {
  var adds, changes, deletes, errors, fromSource, initialCopy, numberOfFiles, unlinks;
  numberOfFiles = _arg.numberOfFiles, adds = _arg.adds, changes = _arg.changes, unlinks = _arg.unlinks, errors = _arg.errors;
  fromSource = function(obs) {
    return obs.merge(errors);
  };
  initialCopy = fromSource(adds).take(numberOfFiles);
  initialCopy.subscribe(function(f) {
    return copyFile(f, from, options);
  }, function(e) {
    log("warn", "File watching error: " + e);
    if (cb) {
      return cb();
    }
  }, function() {
    var ongoingCopy;
    ongoingCopy = fromSource(adds.merge(changes));
    ongoingCopy.subscribe(function(f) {
      return copyFile(f, from, options);
    }, function(e) {
      return log("warn", "File watching error: " + e);
    });
    log("info", "finished initial copy for: " + from);
    if (cb) {
      return cb();
    }
  });
  deletes = fromSource(unlinks);
  return deletes.subscribe(function(f) {
    var outFile;
    outFile = transformPath(f, from, options);
    return deleteFile(outFile);
  }, function(e) {
    return log("warn", "File watching errors: " + e);
  });
};

copyFile = function(file, from, options) {
  return fs.readFile(file, function(err, data) {
    var dirname, outFile;
    if (err) {
      log("error", "Error reading file [[ " + file + " ]], " + err);
      return;
    }
    outFile = transformPath(file, from, options);
    dirname = path.dirname(outFile);
    if (!fs.existsSync(dirname)) {
      wrench.mkdirSyncRecursive(dirname, 0x1ff);
    }
    return fs.writeFile(outFile, data, function(err) {
      if (err) {
        return log("error", "Error reading file [[ " + file + " ]], " + err);
      } else {
        return log("success", "File copied to destination [[ " + outFile + " ]] from [[ " + file + " ]]");
      }
    });
  });
};

deleteFileSync = function(file) {
  if (fs.existsSync(file)) {
    fs.unlinkSync(file);
    return log("success", "File [[ " + file + " ]] deleted.");
  }
};

deleteFile = function(file) {
  return fs.exists(file, function(exists) {
    if (exists) {
      return fs.unlink(file, function(err) {
        if (err) {
          return log("error", "Error deleting file [[ " + file + " ]], " + err);
        } else {
          return log("success", "File [[ " + file + " ]] deleted.");
        }
      });
    }
  });
};

deleteDirectory = function(dir, cb) {
  if (fs.existsSync(dir)) {
    return fs.rmdir(dir, function(err) {
      if ((err != null ? err.code : void 0) === !"ENOTEMPTY") {
        log("error", "Unable to delete directory [[ " + dir + " ]]");
        log("error", err);
      } else {
        log("info", "Deleted empty directory [[ " + dir + " ]]");
      }
      if (cb) {
        return cb();
      }
    });
  } else {
    if (cb) {
      return cb();
    }
  }
};

withoutBaseDir = function(testPath, baseDir) {
  var cwd, newPath, returnVal, start;
  baseDir = baseDir && baseDir.length ? path.join(baseDir, "/") : baseDir;
  cwd = process.cwd();
  newPath = testPath.replace(cwd, "");
  start = Math.max(newPath.indexOf(baseDir), 0);
  newPath = newPath.substring(start);
  returnVal = newPath.replace(baseDir || "", "").replace(/^\/|^\\/, "");
  return returnVal;
};

transformPath = function(file, from, _arg) {
  var baseDir, conventions, finalPath, fixPath, newFile, newFilePath, newSourceDir, result, sourceDir;
  sourceDir = _arg.sourceDir, conventions = _arg.conventions, baseDir = _arg.baseDir;
  newFilePath = withoutBaseDir(file, baseDir);
  newSourceDir = withoutBaseDir(sourceDir, baseDir);
  fixPath = withoutPath(from);
  newFile = fixPath(newFilePath);
  result = _.reduce(conventions, function(acc, _arg1) {
    var ext, match, transform;
    match = _arg1.match, transform = _arg1.transform;
    ext = path.extname(acc);
    if (match(acc, ext, log)) {
      return transform(acc, path, log);
    } else {
      return acc;
    }
  }, newFile);
  result = result.replace(newSourceDir, "");
  finalPath = path.join(baseDir || "", newSourceDir, result);
  return finalPath;
};

matchesWithoutBaseDir = function(testPath, baseDir, predicate) {
  var newTest, shouldExclude;
  newTest = withoutBaseDir(testPath, baseDir);
  shouldExclude = predicate(newTest);
  return shouldExclude;
};

excludeStrategies = {
  string: {
    identity: _.isString,
    predicate: function(ex, testPath, baseDir) {
      return matchesWithoutBaseDir(testPath, baseDir, function(newPath) {
        return newPath.indexOf(ex) === 0;
      });
    }
  },
  regex: {
    identity: _.isRegExp,
    predicate: function(ex, testPath, baseDir) {
      return matchesWithoutBaseDir(testPath, baseDir, function(newPath) {
        return ex.test(newPath);
      });
    }
  }
};

isExcludedByConfig = function(testPath, excludes, baseDir) {
  var ofType;
  ofType = function(method) {
    return excludes.filter(function(f) {
      return method(f);
    });
  };
  return _.any(excludeStrategies, function(_arg) {
    var identity, predicate;
    identity = _arg.identity, predicate = _arg.predicate;
    return _.any(ofType(identity), function(ex) {
      return predicate(ex, testPath, baseDir);
    });
  });
};

parseXml = function(content) {
  var result;
  result = {};
  parseString(content, function(err, output) {
    return result = output;
  });
  return result;
};

findBottles = function(sourceDir) {
  var bottles, data, encoding, linksFile, linksXml, _ref1;
  linksFile = path.join(sourceDir, ".links");
  if (fs.existsSync(linksFile)) {
    encoding = "utf8";
    data = fs.readFileSync(linksFile, {
      encoding: encoding
    });
    linksXml = parseXml(data);
    bottles = (linksXml != null ? (_ref1 = linksXml.links) != null ? _ref1.include : void 0 : void 0) || [];
    if (!(bottles && _.isArray(bottles))) {
      log("error", ".links file not valid");
      return;
    }
    bottles = _.map(bottles, function(bottle) {
      return bottle.replace(/\\|\//, path.sep);
    });
    return bottles;
  } else {
    return [];
  }
};

buildExtensions = function(config) {
  var copy, css, extensions, javascript, _ref1;
  _ref1 = config.extensions, copy = _ref1.copy, javascript = _ref1.javascript, css = _ref1.css;
  return extensions = _.union(copy, javascript, css);
};

setWorkingDir = function(val) {
  return workingDir = val || process.cwd();
};

importAssets = function(mimosaConfig, options, next) {
  var baseDir, binaryInterval, compiledDir, conventions, excludePaths, extensions, fileWatcherSettings, finish, importFrom, interval, isBuild, sourceDir, targets, usePolling, _ref1;
  log("info", "importing assets");
  _ref1 = mimosaConfig.fubumvc, excludePaths = _ref1.excludePaths, sourceDir = _ref1.sourceDir, compiledDir = _ref1.compiledDir, isBuild = _ref1.isBuild, conventions = _ref1.conventions, usePolling = _ref1.usePolling, interval = _ref1.interval, binaryInterval = _ref1.binaryInterval, baseDir = _ref1.baseDir;
  extensions = buildExtensions(mimosaConfig);
  setWorkingDir(baseDir);
  log("debug", "allowed extensions [[ " + extensions + " ]]");
  log("debug", "excludePaths [[ " + excludePaths + " ]]");
  fileWatcherSettings = {
    usePolling: usePolling,
    interval: interval,
    binaryInterval: binaryInterval
  };
  importFrom = function(target, callback) {
    var fileWatcher;
    log("info", "watching " + target);
    fileWatcher = prepareFileWatcher(target, extensions, excludePaths, isBuild, fileWatcherSettings, mimosaConfig.fubumvc.baseDir);
    return startWatching(target, fileWatcher, {
      sourceDir: sourceDir,
      conventions: conventions,
      baseDir: baseDir
    }, callback);
  };
  targets = getTargets(workingDir);
  finish = trackCompletion("importAssets", targets, next);
  _.each(targets, function(target) {
    return importFrom(target, function() {
      return finish(target);
    });
  });
};

getTargets = function(dir) {
  var bottles, targets;
  bottles = _.map(findBottles(dir), function(bottle) {
    return path.resolve(dir, bottle);
  });
  return targets = [].concat(bottles, [dir]);
};

cleanAssets = function(mimosaConfig, options, next) {
  var allTargetFiles, baseDir, compiledDir, conventions, excludePaths, extensions, filesFor, finish, isBuild, sourceDir, targets, _ref1;
  log("info", "cleaning assets");
  _ref1 = mimosaConfig.fubumvc, extensions = _ref1.extensions, excludePaths = _ref1.excludePaths, sourceDir = _ref1.sourceDir, compiledDir = _ref1.compiledDir, isBuild = _ref1.isBuild, conventions = _ref1.conventions, baseDir = _ref1.baseDir;
  extensions = buildExtensions(mimosaConfig);
  options = {
    sourceDir: sourceDir,
    conventions: conventions,
    baseDir: baseDir
  };
  filesFor = function(target) {
    var files, outputFiles;
    log("debug", "finding files for: " + target + " with extensions: " + extensions + " and excludePaths: " + excludePaths);
    files = findSourceFiles(target, extensions, excludePaths);
    outputFiles = _.map(files, function(f) {
      return transformPath(f, target, options, mimosaConfig);
    });
    return [target, files, outputFiles];
  };
  targets = getTargets(workingDir);
  allTargetFiles = _.map(targets, filesFor);
  finish = trackCompletion("cleanAssets", targets, next);
  _.each(allTargetFiles, function(_arg) {
    var files, outputFiles, target;
    target = _arg[0], files = _arg[1], outputFiles = _arg[2];
    return clean([target, files, outputFiles], function() {
      return finish(target);
    });
  });
};

trackCompletion = function(title, initial, cb) {
  var done, remaining;
  remaining = [].concat(initial);
  done = function(dir) {
    remaining = _.without(remaining, dir);
    if (remaining.length === 0) {
      log("info", "finished " + title);
      return cb();
    }
  };
  return done;
};

clean = function(_arg, cb) {
  var dirs, files, finish, outputFiles, target;
  target = _arg[0], files = _arg[1], outputFiles = _arg[2];
  _.each(outputFiles, function(f) {
    return deleteFileSync(f);
  });
  dirs = _(outputFiles).map(function(f) {
    return path.dirname(f);
  }).unique().sortBy("length").reverse().value();
  if (dirs.length > 0) {
    finish = trackCompletion("clean", dirs, cb);
    return _(dirs).map(function(dir) {
      return [
        dir, function() {
          return finish(dir);
        }
      ];
    }).each(function(_arg1) {
      var cb, dir;
      dir = _arg1[0], cb = _arg1[1];
      return deleteDirectory(dir, cb);
    });
  } else {
    return cb();
  }
};

module.exports = {
  importAssets: importAssets,
  cleanAssets: cleanAssets
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL3NtaXRobS9kZXYvbWltb3NhLWZ1YnVtdmMvbGliL2Z1YnUtaW1wb3J0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiL1VzZXJzL3NtaXRobS9kZXYvbWltb3NhLWZ1YnVtdmMvc3JjL2Z1YnUtaW1wb3J0LmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxZQUFBLENBQUE7QUFBQSxJQUFBLDZhQUFBOztBQUFBLE9BRWtCLE9BQUEsQ0FBUSxRQUFSLENBQWxCLEVBQUMsV0FBQSxHQUFELEVBQU0sZ0JBQUEsUUFGTixDQUFBOztBQUFBLEtBR0EsR0FBUSxPQUFBLENBQVEsWUFBUixDQUFxQixDQUFDLEdBSDlCLENBQUE7O0FBQUEsRUFJQSxHQUFLLE9BQUEsQ0FBUSxJQUFSLENBSkwsQ0FBQTs7QUFBQSxJQUtBLEdBQU8sT0FBQSxDQUFRLE1BQVIsQ0FMUCxDQUFBOztBQUFBLEtBTUEsR0FBUSxPQUFBLENBQVEsVUFBUixDQU5SLENBQUE7O0FBQUEsTUFPQSxHQUFTLE9BQUEsQ0FBUSxRQUFSLENBUFQsQ0FBQTs7QUFBQSxDQVFBLEdBQUksT0FBQSxDQUFRLFFBQVIsQ0FSSixDQUFBOztBQUFBLFdBU0EsR0FBYyxPQUFBLENBQVEsUUFBUixDQUFpQixDQUFDLFdBVGhDLENBQUE7O0FBQUEsVUFVQSxHQUFhLE9BQU8sQ0FBQyxHQUFSLENBQUEsQ0FWYixDQUFBOztBQUFBLEVBV0EsR0FBSyxPQUFBLENBQVEsSUFBUixDQVhMLENBQUE7O0FBQUEsZUFhQSxHQUFrQixTQUFDLElBQUQsRUFBTyxVQUFQLEVBQW1CLFFBQW5CLEVBQTZCLE9BQTdCLEdBQUE7U0FDaEIsTUFBTSxDQUFDLG9CQUFQLENBQTRCLElBQTVCLENBQ0UsQ0FBQyxNQURILENBQ1UsU0FBQyxDQUFELEdBQUE7QUFDTixRQUFBLGdDQUFBO0FBQUEsSUFBQSxZQUFBLEdBQWUsSUFBSSxDQUFDLElBQUwsQ0FBVSxJQUFWLEVBQWdCLENBQWhCLENBQWYsQ0FBQTtB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O0dBQUEsTUFBQTtXQVFFLEVBQUEsQ0FBQSxFQVJGO0dBVk07QUFBQSxDQWhSUixDQUFBOztBQUFBLE1Bb1NNLENBQUMsT0FBUCxHQUFpQjtBQUFBLEVBQUMsY0FBQSxZQUFEO0FBQUEsRUFBZSxhQUFBLFdBQWY7Q0FwU2pCLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIlxuXG57bG9nLCBwcmludE9ian0gPSByZXF1aXJlICcuL3V0aWwnXG5jb2xvciA9IHJlcXVpcmUoJ2Fuc2ktY29sb3InKS5zZXRcbmZzID0gcmVxdWlyZSAnZnMnXG5wYXRoID0gcmVxdWlyZSAncGF0aCdcbndhdGNoID0gcmVxdWlyZSAnY2hva2lkYXInXG53cmVuY2ggPSByZXF1aXJlICd3cmVuY2gnXG5fID0gcmVxdWlyZSAnbG9kYXNoJ1xucGFyc2VTdHJpbmcgPSByZXF1aXJlKCd4bWwyanMnKS5wYXJzZVN0cmluZ1xud29ya2luZ0RpciA9IHByb2Nlc3MuY3dkKClcblJ4ID0gcmVxdWlyZSBcInJ4XCJcblxuZmluZFNvdXJjZUZpbGVzID0gKGZyb20sIGV4dGVuc2lvbnMsIGV4Y2x1ZGVzLCBiYXNlRGlyKSAtPlxuICB3cmVuY2gucmVhZGRpclN5bmNSZWN1cnNpdmUoZnJvbSlcbiAgICAuZmlsdGVyIChmKSAtPlxuICAgICAgb3JpZ2luYWxGaWxlID0gcGF0aC5qb2luIGZyb20sIGZcbiAgICAgIGlzRmlsZSA9IGZzLnN0YXRTeW5jKG9yaWdpbmFsRmlsZSkuaXNGaWxlKClcbiAgICAgIGlzSW5jbHVkZWQgPSBzaG91bGRJbmNsdWRlIGYsIGlzRmlsZSwgZXh0ZW5zaW9ucywgZXhjbHVkZXMsIGJhc2VEaXJcbiAgICAgIGlzSW5jbHVkZWQgYW5kIGlzRmlsZVxuICAgIC5tYXAgKGYpIC0+IHBhdGguam9pbiBmcm9tLCBmXG5cbnNob3VsZEluY2x1ZGUgPSAoZiwgaXNGaWxlLCBleHRlbnNpb25zLCBleGNsdWRlcywgYmFzZURpcikgLT5cbiAgI1RPRE86IG9ubHkgYWRkcyB0aGUgLiB0byB5b3UgZm9yIGV4dGVuc2lvbnMgaWYgaXRzIGxlZnQgb2ZmXG4gIGV4dGVuc2lvbnMgPSBleHRlbnNpb25zLm1hcCAoZXh0KSAtPiBcIi4je2V4dH1cIlxuICBleHQgPSBwYXRoLmV4dG5hbWUgZlxuICBtYXRjaGVzRXh0ZW5zaW9uID0gbm90IGlzRmlsZSBvciBfLmNvbnRhaW5zIGV4dGVuc2lvbnMsIGV4dFxuICBhdFJvb3QgPSBpc0ZpbGUgYW5kIGYuaW5kZXhPZihwYXRoLnNlcCkgPT0gLTFcbiAgZXhjbHVkZWQgPSBpc0V4Y2x1ZGVkQnlDb25maWcgZiwgZXhjbHVkZXMsIGJhc2VEaXJcbiAgbWF0Y2hlc0V4dGVuc2lvbiBhbmQgbm90IGV4Y2x1ZGVkIGFuZCBub3QgYXRSb290XG5cbndpdGhvdXRQYXRoID0gKGZyb21QYXRoKSAtPlxuICAoaW5wdXQpIC0+IGlucHV0LnJlcGxhY2UgXCIje2Zyb21QYXRofSN7cGF0aC5zZXB9XCIsICcnXG5cbnByZXBhcmVGaWxlV2F0Y2hlciA9IChmcm9tLCBleHRlbnNpb25zLCBleGNsdWRlcywgaXNCdWlsZCwgZmlsZVdhdGNoZXJTZXR0aW5ncywgYmFzZURpcikgLT5cbiAgI1RPRE86IG5vIG1vcmUgc3luYyBjYWxsc1xuICBmaWxlcyAgPSBmaW5kU291cmNlRmlsZXMgZnJvbSwgZXh0ZW5zaW9ucywgZXhjbHVkZXMsIGJhc2VEaXJcbiAgbnVtYmVyT2ZGaWxlcyAgPSBmaWxlcy5sZW5ndGhcbiAgZml4UGF0aCA9IHdpdGhvdXRQYXRoIGZyb21cblxuICBzZXR0aW5ncyA9XG4gICAgaWdub3JlZDogKGZpbGUpIC0+XG4gICAgICBpc0ZpbGUgPSBmcy5zdGF0U3luYyhmaWxlKS5pc0ZpbGUoKVxuICAgICAgZiA9IGZpeFBhdGggZmlsZVxuICAgICAgbm90IChzaG91bGRJbmNsdWRlIGYsIGlzRmlsZSwgZXh0ZW5zaW9ucywgZXhjbHVkZXMsIGJhc2VEaXIpXG4gICAgcGVyc2lzdGVudDogbm90IGlzQnVpbGRcblxuICB3YXRjaFNldHRpbmdzID0gXy5leHRlbmQgc2V0dGluZ3MsIGZpbGVXYXRjaGVyU2V0dGluZ3NcblxuICBvYnNlcnZhYmxlRm9yID0gKGV2ZW50KSAtPlxuICAgIFJ4Lk9ic2VydmFibGUuZnJvbUV2ZW50IHdhdGNoZXIsIGV2ZW50XG5cbiAgbG9nIFwiZGVidWdcIiwgXCJzdGFydGluZyBmaWxlIHdhdGNoZXIgb24gW1sgI3tmcm9tfSBdXSB1c2VQb2xsaW5nOiAje3dhdGNoU2V0dGluZ3MudXNlUG9sbGluZ31cIlxuXG4gIHdhdGNoZXIgPSB3YXRjaC53YXRjaCBmcm9tLCB3YXRjaFNldHRpbmdzXG4gIGFkZHMgPSBvYnNlcnZhYmxlRm9yIFwiYWRkXCJcbiAgY2hhbmdlcyA9IG9ic2VydmFibGVGb3IgXCJjaGFuZ2VcIlxuICB1bmxpbmtzID0gb2JzZXJ2YWJsZUZvciBcInVubGlua1wiXG4gIGVycm9ycyA9IChvYnNlcnZhYmxlRm9yIFwiZXJyb3JcIikuc2VsZWN0TWFueSAoZSkgLT4gUnguT2JzZXJ2YWJsZS50aHJvdyBlXG4gIHtudW1iZXJPZkZpbGVzLCBhZGRzLCBjaGFuZ2VzLCB1bmxpbmtzLCBlcnJvcnN9XG5cbnN0YXJ0V2F0Y2hpbmcgPSAoXG4gIGZyb20sXG4gIHtudW1iZXJPZkZpbGVzLCBhZGRzLCBjaGFuZ2VzLCB1bmxpbmtzLCBlcnJvcnN9LFxuICBvcHRpb25zLFxuICBjYikgLT5cblxuICBmcm9tU291cmNlID0gKG9icykgLT5cbiAgICBvYnMubWVyZ2UoZXJyb3JzKVxuXG4gIGluaXRpYWxDb3B5ID0gZnJvbVNvdXJjZShhZGRzKS50YWtlKG51bWJlck9mRmlsZXMpXG5cbiAgaW5pdGlhbENvcHkuc3Vic2NyaWJlKFxuICAgIChmKSAtPlxuICAgICAgY29weUZpbGUgZiwgZnJvbSwgb3B0aW9uc1xuICAgIChlKSAtPlxuICAgICAgbG9nIFwid2FyblwiLCBcIkZpbGUgd2F0Y2hpbmcgZXJyb3I6ICN7ZX1cIlxuICAgICAgY2IoKSBpZiBjYlxuICAgICgpIC0+XG4gICAgICBvbmdvaW5nQ29weSA9IGZyb21Tb3VyY2UoYWRkcy5tZXJnZSBjaGFuZ2VzKVxuICAgICAgb25nb2luZ0NvcHkuc3Vic2NyaWJlKFxuICAgICAgICAoZikgLT4gY29weUZpbGUgZiwgZnJvbSwgb3B0aW9uc1xuICAgICAgICAoZSkgLT4gbG9nIFwid2FyblwiLCBcIkZpbGUgd2F0Y2hpbmcgZXJyb3I6ICN7ZX1cIlxuICAgICAgKVxuICAgICAgbG9nIFwiaW5mb1wiLCBcImZpbmlzaGVkIGluaXRpYWwgY29weSBmb3I6ICN7ZnJvbX1cIlxuICAgICAgY2IoKSBpZiBjYlxuICApXG5cbiAgZGVsZXRlcyA9IGZyb21Tb3VyY2UodW5saW5rcylcblxuICBkZWxldGVzLnN1YnNjcmliZShcbiAgICAoZikgLT5cbiAgICAgIG91dEZpbGUgPSB0cmFuc2Zvcm1QYXRoIGYsIGZyb20sIG9wdGlvbnNcbiAgICAgIGRlbGV0ZUZpbGUgb3V0RmlsZVxuICAgIChlKSAtPiBsb2cgXCJ3YXJuXCIsIFwiRmlsZSB3YXRjaGluZyBlcnJvcnM6ICN7ZX1cIlxuICApXG5cbmNvcHlGaWxlID0gKGZpbGUsIGZyb20sIG9wdGlvbnMpIC0+XG4gIGZzLnJlYWRGaWxlIGZpbGUsIChlcnIsIGRhdGEpIC0+XG4gICAgaWYgZXJyXG4gICAgICBsb2cgXCJlcnJvclwiLCBcIkVycm9yIHJlYWRpbmcgZmlsZSBbWyAje2ZpbGV9IF1dLCAje2Vycn1cIlxuICAgICAgcmV0dXJuXG5cbiAgICBvdXRGaWxlID0gdHJhbnNmb3JtUGF0aCBmaWxlLCBmcm9tLCBvcHRpb25zXG5cbiAgICBkaXJuYW1lID0gcGF0aC5kaXJuYW1lIG91dEZpbGVcbiAgICB1bmxlc3MgZnMuZXhpc3RzU3luYyBkaXJuYW1lXG4gICAgICB3cmVuY2gubWtkaXJTeW5jUmVjdXJzaXZlIGRpcm5hbWUsIDBvMDc3N1xuXG4gICAgZnMud3JpdGVGaWxlIG91dEZpbGUsIGRhdGEsIChlcnIpIC0+XG4gICAgICBpZiBlcnJcbiAgICAgICAgbG9nIFwiZXJyb3JcIiwgXCJFcnJvciByZWFkaW5nIGZpbGUgW1sgI3tmaWxlfSBdXSwgI3tlcnJ9XCJcbiAgICAgIGVsc2VcbiAgICAgICAgbG9nIFwic3VjY2Vzc1wiLCBcIkZpbGUgY29waWVkIHRvIGRlc3RpbmF0aW9uIFtbICN7b3V0RmlsZX0gXV0gZnJvbSBbWyAje2ZpbGV9IF1dXCJcblxuZGVsZXRlRmlsZVN5bmMgPSAoZmlsZSkgLT5cbiAgaWYgZnMuZXhpc3RzU3luYyBmaWxlXG4gICAgZnMudW5saW5rU3luYyBmaWxlXG4gICAgbG9nIFwic3VjY2Vzc1wiLCBcIkZpbGUgW1sgI3tmaWxlfSBdXSBkZWxldGVkLlwiXG5cbmRlbGV0ZUZpbGUgPSAoZmlsZSkgLT5cbiAgZnMuZXhpc3RzIGZpbGUsIChleGlzdHMpIC0+XG4gICAgaWYgZXhpc3RzXG4gICAgICBmcy51bmxpbmsgZmlsZSwgKGVycikgLT5cbiAgICAgICAgaWYgZXJyXG4gICAgICAgICAgbG9nIFwiZXJyb3JcIiwgXCJFcnJvciBkZWxldGluZyBmaWxlIFtbICN7ZmlsZX0gXV0sICN7ZXJyfVwiXG4gICAgICAgIGVsc2VcbiAgICAgICAgICBsb2cgXCJzdWNjZXNzXCIsIFwiRmlsZSBbWyAje2ZpbGV9IF1dIGRlbGV0ZWQuXCJcblxuZGVsZXRlRGlyZWN0b3J5ID0gKGRpciwgY2IpIC0+XG4gIGlmIGZzLmV4aXN0c1N5bmMgZGlyXG4gICAgZnMucm1kaXIgZGlyLCAoZXJyKSAtPlxuICAgICAgaWYgZXJyPy5jb2RlIGlzIG5vdCBcIkVOT1RFTVBUWVwiXG4gICAgICAgIGxvZyBcImVycm9yXCIsIFwiVW5hYmxlIHRvIGRlbGV0ZSBkaXJlY3RvcnkgW1sgI3tkaXJ9IF1dXCJcbiAgICAgICAgbG9nIFwiZXJyb3JcIiwgZXJyXG4gICAgICBlbHNlXG4gICAgICAgIGxvZyBcImluZm9cIiwgXCJEZWxldGVkIGVtcHR5IGRpcmVjdG9yeSBbWyAje2Rpcn0gXV1cIlxuICAgICAgY2IoKSBpZiBjYlxuICBlbHNlIGNiKCkgaWYgY2Jcblxud2l0aG91dEJhc2VEaXIgPSAodGVzdFBhdGgsIGJhc2VEaXIpIC0+XG4gIGJhc2VEaXIgPSBpZiAoYmFzZURpciBhbmQgYmFzZURpci5sZW5ndGgpIHRoZW4gcGF0aC5qb2luKGJhc2VEaXIsIFwiL1wiKSBlbHNlIGJhc2VEaXJcbiAgY3dkID0gcHJvY2Vzcy5jd2QoKVxuICBuZXdQYXRoID0gdGVzdFBhdGgucmVwbGFjZShjd2QsIFwiXCIpXG4gIHN0YXJ0ID0gTWF0aC5tYXgobmV3UGF0aC5pbmRleE9mKGJhc2VEaXIpLCAwKVxuICBuZXdQYXRoID0gbmV3UGF0aC5zdWJzdHJpbmcoc3RhcnQpXG4gIHJldHVyblZhbCA9IG5ld1BhdGgucmVwbGFjZShiYXNlRGlyIG9yIFwiXCIsIFwiXCIpLnJlcGxhY2UoL15cXC98XlxcXFwvLCBcIlwiKVxuICByZXR1cm4gcmV0dXJuVmFsXG5cbnRyYW5zZm9ybVBhdGggPSAoZmlsZSwgZnJvbSwge3NvdXJjZURpciwgY29udmVudGlvbnMsIGJhc2VEaXJ9KSAtPlxuICBuZXdGaWxlUGF0aCA9IHdpdGhvdXRCYXNlRGlyIGZpbGUsIGJhc2VEaXJcbiAgbmV3U291cmNlRGlyID0gd2l0aG91dEJhc2VEaXIgc291cmNlRGlyLCBiYXNlRGlyXG4gIGZpeFBhdGggPSB3aXRob3V0UGF0aCBmcm9tXG4gIG5ld0ZpbGUgPSBmaXhQYXRoIG5ld0ZpbGVQYXRoXG4gIHJlc3VsdCA9IF8ucmVkdWNlKGNvbnZlbnRpb25zLCAoYWNjLCB7bWF0Y2gsIHRyYW5zZm9ybX0pIC0+XG4gICAgZXh0ID0gcGF0aC5leHRuYW1lIGFjY1xuICAgIGlmIG1hdGNoIGFjYywgZXh0LCBsb2cgdGhlbiB0cmFuc2Zvcm0gYWNjLCBwYXRoLCBsb2cgZWxzZSBhY2NcbiAgLCBuZXdGaWxlKVxuICByZXN1bHQgPSByZXN1bHQucmVwbGFjZShuZXdTb3VyY2VEaXIsIFwiXCIpXG4gIGZpbmFsUGF0aCA9IHBhdGguam9pbiBiYXNlRGlyIG9yIFwiXCIsIG5ld1NvdXJjZURpciwgcmVzdWx0XG4gIGZpbmFsUGF0aFxuXG5tYXRjaGVzV2l0aG91dEJhc2VEaXIgPSAodGVzdFBhdGgsIGJhc2VEaXIsIHByZWRpY2F0ZSkgLT5cbiAgbmV3VGVzdCA9IHdpdGhvdXRCYXNlRGlyIHRlc3RQYXRoLCBiYXNlRGlyXG4gIHNob3VsZEV4Y2x1ZGUgPSBwcmVkaWNhdGUobmV3VGVzdClcbiAgcmV0dXJuIHNob3VsZEV4Y2x1ZGVcblxuZXhjbHVkZVN0cmF0ZWdpZXMgPVxuICBzdHJpbmc6XG4gICAgaWRlbnRpdHk6IF8uaXNTdHJpbmdcbiAgICBwcmVkaWNhdGU6IChleCwgdGVzdFBhdGgsIGJhc2VEaXIpIC0+ICBtYXRjaGVzV2l0aG91dEJhc2VEaXIgdGVzdFBhdGgsIGJhc2VEaXIsIChuZXdQYXRoKSAtPiBuZXdQYXRoLmluZGV4T2YoZXgpID09IDBcbiAgcmVnZXg6XG4gICAgaWRlbnRpdHk6IF8uaXNSZWdFeHBcbiAgICBwcmVkaWNhdGU6IChleCwgdGVzdFBhdGgsIGJhc2VEaXIpIC0+IG1hdGNoZXNXaXRob3V0QmFzZURpciB0ZXN0UGF0aCwgYmFzZURpciwgKG5ld1BhdGgpIC0+IGV4LnRlc3QgbmV3UGF0aFxuXG5pc0V4Y2x1ZGVkQnlDb25maWcgPSAodGVzdFBhdGgsIGV4Y2x1ZGVzLCBiYXNlRGlyKSAtPlxuICBvZlR5cGUgPSAobWV0aG9kKSAtPlxuICAgIGV4Y2x1ZGVzLmZpbHRlciAoZikgLT4gbWV0aG9kKGYpXG5cbiAgXy5hbnkgZXhjbHVkZVN0cmF0ZWdpZXMsICh7aWRlbnRpdHksIHByZWRpY2F0ZX0pIC0+XG4gICAgXy5hbnkgKG9mVHlwZSBpZGVudGl0eSksIChleCkgLT4gcHJlZGljYXRlIGV4LCB0ZXN0UGF0aCwgYmFzZURpclxuXG5wYXJzZVhtbCA9IChjb250ZW50KSAtPlxuICByZXN1bHQgPSB7fVxuICBwYXJzZVN0cmluZyBjb250ZW50LCAoZXJyLCBvdXRwdXQpIC0+XG4gICAgcmVzdWx0ID0gb3V0cHV0XG4gIHJlc3VsdFxuXG5maW5kQm90dGxlcyA9IChzb3VyY2VEaXIpIC0+XG4gIGxpbmtzRmlsZSA9IHBhdGguam9pbiBzb3VyY2VEaXIsIFwiLmxpbmtzXCJcbiAgaWYgZnMuZXhpc3RzU3luYyBsaW5rc0ZpbGVcbiAgICBlbmNvZGluZyA9IFwidXRmOFwiXG4gICAgZGF0YSA9IGZzLnJlYWRGaWxlU3luYyBsaW5rc0ZpbGUsIHtlbmNvZGluZ31cbiAgICBsaW5rc1htbCA9IHBhcnNlWG1sIGRhdGFcbiAgICBib3R0bGVzID0gbGlua3NYbWw/LmxpbmtzPy5pbmNsdWRlIHx8IFtdXG4gICAgdW5sZXNzIGJvdHRsZXMgYW5kIF8uaXNBcnJheSBib3R0bGVzXG4gICAgICBsb2cgXCJlcnJvclwiLCBcIi5saW5rcyBmaWxlIG5vdCB2YWxpZFwiXG4gICAgICByZXR1cm5cbiAgICBib3R0bGVzID0gXy5tYXAoYm90dGxlcywgKGJvdHRsZSktPiBib3R0bGUucmVwbGFjZSgvXFxcXHxcXC8vLCBwYXRoLnNlcCkpXG4gICAgYm90dGxlc1xuICBlbHNlXG4gICAgW11cblxuYnVpbGRFeHRlbnNpb25zID0gKGNvbmZpZykgLT5cbiAge2NvcHksIGphdmFzY3JpcHQsIGNzc30gPSBjb25maWcuZXh0ZW5zaW9uc1xuICBleHRlbnNpb25zID0gXy51bmlvbiBjb3B5LCBqYXZhc2NyaXB0LCBjc3Ncblxuc2V0V29ya2luZ0RpciA9ICh2YWwpIC0+XG4gIHdvcmtpbmdEaXIgPSB2YWwgb3IgcHJvY2Vzcy5jd2QoKVxuXG5pbXBvcnRBc3NldHMgPSAobWltb3NhQ29uZmlnLCBvcHRpb25zLCBuZXh0KSAtPlxuICBsb2cgXCJpbmZvXCIsIFwiaW1wb3J0aW5nIGFzc2V0c1wiXG4gIHtleGNsdWRlUGF0aHMsIHNvdXJjZURpciwgY29tcGlsZWREaXIsIGlzQnVpbGQsIGNvbnZlbnRpb25zLCB1c2VQb2xsaW5nLCBpbnRlcnZhbCwgYmluYXJ5SW50ZXJ2YWwsIGJhc2VEaXJ9ID1cbiAgICBtaW1vc2FDb25maWcuZnVidW12Y1xuXG4gIGV4dGVuc2lvbnMgPSBidWlsZEV4dGVuc2lvbnMgbWltb3NhQ29uZmlnXG4gIHNldFdvcmtpbmdEaXIgYmFzZURpclxuXG4gIGxvZyBcImRlYnVnXCIsIFwiYWxsb3dlZCBleHRlbnNpb25zIFtbICN7ZXh0ZW5zaW9uc30gXV1cIlxuICBsb2cgXCJkZWJ1Z1wiLCBcImV4Y2x1ZGVQYXRocyBbWyAje2V4Y2x1ZGVQYXRoc30gXV1cIlxuXG4gIGZpbGVXYXRjaGVyU2V0dGluZ3MgPSB7dXNlUG9sbGluZywgaW50ZXJ2YWwsIGJpbmFyeUludGVydmFsfVxuXG4gIGltcG9ydEZyb20gPSAodGFyZ2V0LCBjYWxsYmFjaykgLT5cbiAgICBsb2cgXCJpbmZvXCIsIFwid2F0Y2hpbmcgI3t0YXJnZXR9XCJcbiAgICBmaWxlV2F0Y2hlciA9IHByZXBhcmVGaWxlV2F0Y2hlciB0YXJnZXQsIGV4dGVuc2lvbnMsIGV4Y2x1ZGVQYXRocywgaXNCdWlsZCwgZmlsZVdhdGNoZXJTZXR0aW5ncywgbWltb3NhQ29uZmlnLmZ1YnVtdmMuYmFzZURpclxuICAgIHN0YXJ0V2F0Y2hpbmcgdGFyZ2V0LCBmaWxlV2F0Y2hlciwge3NvdXJjZURpciwgY29udmVudGlvbnMsIGJhc2VEaXJ9LCBjYWxsYmFja1xuXG4gIHRhcmdldHMgPSBnZXRUYXJnZXRzIHdvcmtpbmdEaXJcblxuICBmaW5pc2ggPSB0cmFja0NvbXBsZXRpb24gXCJpbXBvcnRBc3NldHNcIiwgdGFyZ2V0cywgbmV4dFxuXG4gIF8uZWFjaCB0YXJnZXRzLCAodGFyZ2V0KSAtPlxuICAgIGltcG9ydEZyb20gdGFyZ2V0LCAoKSAtPiBmaW5pc2godGFyZ2V0KVxuICByZXR1cm5cblxuZ2V0VGFyZ2V0cyA9IChkaXIpIC0+XG4gIGJvdHRsZXMgPSBfLm1hcCAoZmluZEJvdHRsZXMgZGlyKSwgKGJvdHRsZSkgLT4gcGF0aC5yZXNvbHZlIGRpciwgYm90dGxlXG4gIHRhcmdldHMgPSBbXS5jb25jYXQgYm90dGxlcywgW2Rpcl1cblxuY2xlYW5Bc3NldHMgPSAobWltb3NhQ29uZmlnLCBvcHRpb25zLCBuZXh0KSAtPlxuICBsb2cgXCJpbmZvXCIsIFwiY2xlYW5pbmcgYXNzZXRzXCJcbiAge2V4dGVuc2lvbnMsIGV4Y2x1ZGVQYXRocywgc291cmNlRGlyLCBjb21waWxlZERpciwgaXNCdWlsZCwgY29udmVudGlvbnMsIGJhc2VEaXJ9ID1cbiAgICBtaW1vc2FDb25maWcuZnVidW12Y1xuICBleHRlbnNpb25zID0gYnVpbGRFeHRlbnNpb25zIG1pbW9zYUNvbmZpZ1xuICBvcHRpb25zID0ge3NvdXJjZURpciwgY29udmVudGlvbnMsIGJhc2VEaXJ9XG5cbiAgZmlsZXNGb3IgPSAodGFyZ2V0KSAtPlxuICAgIGxvZyBcImRlYnVnXCIsIFwiZmluZGluZyBmaWxlcyBmb3I6ICN7dGFyZ2V0fSB3aXRoIGV4dGVuc2lvbnM6ICN7ZXh0ZW5zaW9uc30gYW5kIGV4Y2x1ZGVQYXRoczogI3tleGNsdWRlUGF0aHN9XCJcbiAgICBmaWxlcyAgPSBmaW5kU291cmNlRmlsZXMgdGFyZ2V0LCBleHRlbnNpb25zLCBleGNsdWRlUGF0aHNcbiAgICBvdXRwdXRGaWxlcyA9IF8ubWFwIGZpbGVzLCAoZikgLT4gdHJhbnNmb3JtUGF0aCBmLCB0YXJnZXQsIG9wdGlvbnMsIG1pbW9zYUNvbmZpZ1xuICAgIFt0YXJnZXQsIGZpbGVzLCBvdXRwdXRGaWxlc11cblxuICB0YXJnZXRzID0gZ2V0VGFyZ2V0cyB3b3JraW5nRGlyXG5cbiAgYWxsVGFyZ2V0RmlsZXMgPSBfLm1hcCB0YXJnZXRzLCBmaWxlc0ZvclxuXG4gIGZpbmlzaCA9IHRyYWNrQ29tcGxldGlvbiBcImNsZWFuQXNzZXRzXCIsIHRhcmdldHMsIG5leHRcblxuICBfLmVhY2ggYWxsVGFyZ2V0RmlsZXMsIChbdGFyZ2V0LCBmaWxlcywgb3V0cHV0RmlsZXNdKSAtPlxuICAgIGNsZWFuIFt0YXJnZXQsIGZpbGVzLCBvdXRwdXRGaWxlc10sICgpIC0+IGZpbmlzaCh0YXJnZXQpXG4gIHJldHVyblxuXG50cmFja0NvbXBsZXRpb24gPSAodGl0bGUsIGluaXRpYWwsIGNiKSAtPlxuICByZW1haW5pbmcgPSBbXS5jb25jYXQgaW5pdGlhbFxuICBkb25lID0gKGRpcikgLT5cbiAgICByZW1haW5pbmcgPSBfLndpdGhvdXQgcmVtYWluaW5nLCBkaXJcbiAgICBpZiByZW1haW5pbmcubGVuZ3RoID09IDBcbiAgICAgIGxvZyBcImluZm9cIiwgXCJmaW5pc2hlZCAje3RpdGxlfVwiXG4gICAgICBjYigpXG4gIGRvbmVcblxuY2xlYW4gPSAoW3RhcmdldCwgZmlsZXMsIG91dHB1dEZpbGVzXSwgY2IpIC0+XG4gIF8uZWFjaCBvdXRwdXRGaWxlcywgKGYpIC0+IGRlbGV0ZUZpbGVTeW5jIGZcblxuICBkaXJzID0gXyBvdXRwdXRGaWxlc1xuICAgIC5tYXAgKGYpIC0+IHBhdGguZGlybmFtZSBmXG4gICAgLnVuaXF1ZSgpXG4gICAgLnNvcnRCeSBcImxlbmd0aFwiXG4gICAgLnJldmVyc2UoKVxuICAgIC52YWx1ZSgpXG5cbiAgaWYgZGlycy5sZW5ndGggPiAwXG4gICAgZmluaXNoID0gdHJhY2tDb21wbGV0aW9uIFwiY2xlYW5cIiwgZGlycywgY2JcblxuICAgIF8gZGlyc1xuICAgICAgLm1hcCAoZGlyKSAtPiBbZGlyLCAoKSAtPiBmaW5pc2goZGlyKV1cbiAgICAgIC5lYWNoIChbZGlyLCBjYl0pIC0+XG4gICAgICAgIGRlbGV0ZURpcmVjdG9yeSBkaXIsIGNiXG4gIGVsc2VcbiAgICBjYigpXG5cbm1vZHVsZS5leHBvcnRzID0ge2ltcG9ydEFzc2V0cywgY2xlYW5Bc3NldHN9XG4iXX0=
