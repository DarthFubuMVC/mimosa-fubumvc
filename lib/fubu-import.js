"use strict";
var Rx, buildExtensions, clean, cleanAssets, color, copyFile, deleteDirectory, deleteFile, deleteFileSync, excludeStrategies, findBottles, findSourceFiles, fs, getTargets, importAssets, isExcludedByConfig, log, matchesWithoutBaseDir, parseString, parseXml, path, prepareFileWatcher, printObj, setWorkingDir, shouldInclude, startWatching, trackCompletion, transformPath, watch, withoutBaseDir, withoutPath, workingDir, wrench, _, _ref;

_ref = require('./util'), log = _ref.log, printObj = _ref.printObj;

color = require('ansi-color').set;

fs = require('fs');

path = require('path');

watch = require('chokidar');

wrench = require('wrench');

_ = require('lodash');

parseString = require('xml2js').parseString;

workingDir = process.cwd();

Rx = require("rx");

findSourceFiles = function(from, extensions, excludes, baseDir) {
  return wrench.readdirSyncRecursive(from).filter(function(f) {
    var isFile, isIncluded, originalFile;
    originalFile = path.join(from, f);
    isFile = fs.statSync(originalFile).isFile();
    isIncluded = shouldInclude(f, isFile, extensions, excludes, baseDir);
    return isIncluded && isFile;
  }).map(function(f) {
    return path.join(from, f);
  });
};

shouldInclude = function(f, isFile, extensions, excludes, baseDir) {
  var atRoot, excluded, ext, matchesExtension;
  extensions = extensions.map(function(ext) {
    return "." + ext;
  });
  ext = path.extname(f);
  matchesExtension = !isFile || _.contains(extensions, ext);
  atRoot = isFile && f.indexOf(path.sep) === -1;
  excluded = isExcludedByConfig(f, excludes, baseDir);
  return matchesExtension && !excluded && !atRoot;
};

withoutPath = function(fromPath) {
  return function(input) {
    return input.replace("" + fromPath + path.sep, '');
  };
};

prepareFileWatcher = function(from, extensions, excludes, isBuild, fileWatcherSettings, baseDir) {
  var adds, changes, errors, files, fixPath, numberOfFiles, observableFor, settings, unlinks, watchSettings, watcher;
  files = findSourceFiles(from, extensions, excludes, baseDir);
  numberOfFiles = files.length;
  fixPath = withoutPath(from);
  settings = {
    ignored: function(file) {
      var f, isFile;
      isFile = fs.statSync(file).isFile();
      f = fixPath(file);
      return !(shouldInclude(f, isFile, extensions, excludes, baseDir));
    },
    persistent: !isBuild
  };
  watchSettings = _.extend(settings, fileWatcherSettings);
  observableFor = function(event) {
    return Rx.Observable.fromEvent(watcher, event);
  };
  log("debug", "starting file watcher on [[ " + from + " ]] usePolling: " + watchSettings.usePolling);
  watcher = watch.watch(from, watchSettings);
  adds = observableFor("add");
  changes = observableFor("change");
  unlinks = observableFor("unlink");
  errors = (observableFor("error")).selectMany(function(e) {
    return Rx.Observable["throw"](e);
  });
  return {
    numberOfFiles: numberOfFiles,
    adds: adds,
    changes: changes,
    unlinks: unlinks,
    errors: errors
  };
};

startWatching = function(from, _arg, options, cb) {
  var adds, changes, deletes, errors, fromSource, initialCopy, numberOfFiles, unlinks;
  numberOfFiles = _arg.numberOfFiles, adds = _arg.adds, changes = _arg.changes, unlinks = _arg.unlinks, errors = _arg.errors;
  fromSource = function(obs) {
    return obs.merge(errors);
  };
  initialCopy = fromSource(adds).take(numberOfFiles);
  initialCopy.subscribe(function(f) {
    return copyFile(f, from, options);
  }, function(e) {
    log("warn", "File watching error: " + e);
    if (cb) {
      return cb();
    }
  }, function() {
    var ongoingCopy;
    ongoingCopy = fromSource(adds.merge(changes));
    ongoingCopy.subscribe(function(f) {
      return copyFile(f, from, options);
    }, function(e) {
      return log("warn", "File watching error: " + e);
    });
    log("info", "finished initial copy for: " + from);
    if (cb) {
      return cb();
    }
  });
  deletes = fromSource(unlinks);
  return deletes.subscribe(function(f) {
    var outFile;
    outFile = transformPath(f, from, options);
    return deleteFile(outFile);
  }, function(e) {
    return log("warn", "File watching errors: " + e);
  });
};

copyFile = function(file, from, options) {
  return fs.readFile(file, function(err, data) {
    var dirname, outFile;
    if (err) {
      log("error", "Error reading file [[ " + file + " ]], " + err);
      return;
    }
    outFile = transformPath(file, from, options);
    dirname = path.dirname(outFile);
    if (!fs.existsSync(dirname)) {
      wrench.mkdirSyncRecursive(dirname, 0x1ff);
    }
    return fs.writeFile(outFile, data, function(err) {
      if (err) {
        return log("error", "Error reading file [[ " + file + " ]], " + err);
      } else {
        return log("success", "File copied to destination [[ " + outFile + " ]] from [[ " + file + " ]]");
      }
    });
  });
};

deleteFileSync = function(file) {
  if (fs.existsSync(file)) {
    fs.unlinkSync(file);
    return log("success", "File [[ " + file + " ]] deleted.");
  }
};

deleteFile = function(file) {
  return fs.exists(file, function(exists) {
    if (exists) {
      return fs.unlink(file, function(err) {
        if (err) {
          return log("error", "Error deleting file [[ " + file + " ]], " + err);
        } else {
          return log("success", "File [[ " + file + " ]] deleted.");
        }
      });
    }
  });
};

deleteDirectory = function(dir, cb) {
  if (fs.existsSync(dir)) {
    return fs.rmdir(dir, function(err) {
      if ((err != null ? err.code : void 0) === !"ENOTEMPTY") {
        log("error", "Unable to delete directory [[ " + dir + " ]]");
        log("error", err);
      } else {
        log("info", "Deleted empty directory [[ " + dir + " ]]");
      }
      if (cb) {
        return cb();
      }
    });
  } else {
    if (cb) {
      return cb();
    }
  }
};

withoutBaseDir = function(testPath, baseDir) {
  var cwd, newPath, returnVal, start;
  baseDir = baseDir && baseDir.length ? path.join(baseDir, "/") : baseDir;
  cwd = process.cwd();
  newPath = testPath.replace(cwd, "");
  start = Math.max(newPath.indexOf(baseDir), 0);
  newPath = newPath.substring(start);
  returnVal = newPath.replace(baseDir || "", "").replace(/^\/|^\\/, "");
  return returnVal;
};

transformPath = function(file, from, _arg) {
  var baseDir, conventions, finalPath, fixPath, newFile, newFilePath, newSourceDir, result, sourceDir, sourceRegex;
  sourceDir = _arg.sourceDir, conventions = _arg.conventions, baseDir = _arg.baseDir;
  baseDir = baseDir || "";
  newFilePath = withoutBaseDir(file, baseDir);
  newSourceDir = withoutBaseDir(sourceDir, baseDir);
  fixPath = withoutPath(from);
  newFile = fixPath(newFilePath);
  result = _.reduce(conventions, function(acc, _arg1) {
    var ext, match, transform;
    match = _arg1.match, transform = _arg1.transform;
    ext = path.extname(acc);
    if (match(acc, ext, log)) {
      return transform(acc, path, log);
    } else {
      return acc;
    }
  }, newFile);
  sourceRegex = new RegExp(newSourceDir, "g");
  result = result.replace(sourceRegex, "");
  finalPath = path.join(baseDir, newSourceDir, result);
  return finalPath;
};

matchesWithoutBaseDir = function(testPath, baseDir, predicate) {
  var newTest, shouldExclude;
  newTest = withoutBaseDir(testPath, baseDir || "");
  shouldExclude = predicate(newTest);
  return shouldExclude;
};

excludeStrategies = {
  string: {
    identity: _.isString,
    predicate: function(ex, testPath, baseDir) {
      return matchesWithoutBaseDir(testPath, baseDir, function(newPath) {
        return newPath.indexOf(ex) === 0;
      });
    }
  },
  regex: {
    identity: _.isRegExp,
    predicate: function(ex, testPath, baseDir) {
      return matchesWithoutBaseDir(testPath, baseDir, function(newPath) {
        return ex.test(newPath);
      });
    }
  }
};

isExcludedByConfig = function(testPath, excludes, baseDir) {
  var ofType;
  ofType = function(method) {
    return excludes.filter(function(f) {
      return method(f);
    });
  };
  return _.any(excludeStrategies, function(_arg) {
    var identity, predicate;
    identity = _arg.identity, predicate = _arg.predicate;
    return _.any(ofType(identity), function(ex) {
      return predicate(ex, testPath, baseDir);
    });
  });
};

parseXml = function(content) {
  var result;
  result = {};
  parseString(content, function(err, output) {
    return result = output;
  });
  return result;
};

findBottles = function(sourceDir) {
  var bottles, data, encoding, linksFile, linksXml, _ref1;
  linksFile = path.join(sourceDir, ".links");
  if (fs.existsSync(linksFile)) {
    encoding = "utf8";
    data = fs.readFileSync(linksFile, {
      encoding: encoding
    });
    linksXml = parseXml(data);
    bottles = (linksXml != null ? (_ref1 = linksXml.links) != null ? _ref1.include : void 0 : void 0) || [];
    if (!(bottles && _.isArray(bottles))) {
      log("error", ".links file not valid");
      return;
    }
    bottles = _.map(bottles, function(bottle) {
      return bottle.replace(/\\|\//, path.sep);
    });
    return bottles;
  } else {
    return [];
  }
};

buildExtensions = function(config) {
  var copy, css, extensions, javascript, _ref1;
  _ref1 = config.extensions, copy = _ref1.copy, javascript = _ref1.javascript, css = _ref1.css;
  return extensions = _.union(copy, javascript, css);
};

setWorkingDir = function(val) {
  return workingDir = val || process.cwd();
};

importAssets = function(mimosaConfig, options, next) {
  var baseDir, binaryInterval, compiledDir, conventions, excludePaths, extensions, fileWatcherSettings, finish, importFrom, interval, isBuild, sourceDir, targets, usePolling, _ref1;
  log("info", "importing assets");
  _ref1 = mimosaConfig.fubumvc, excludePaths = _ref1.excludePaths, sourceDir = _ref1.sourceDir, compiledDir = _ref1.compiledDir, isBuild = _ref1.isBuild, conventions = _ref1.conventions, usePolling = _ref1.usePolling, interval = _ref1.interval, binaryInterval = _ref1.binaryInterval, baseDir = _ref1.baseDir;
  extensions = buildExtensions(mimosaConfig);
  setWorkingDir(baseDir);
  log("debug", "allowed extensions [[ " + extensions + " ]]");
  log("debug", "excludePaths [[ " + excludePaths + " ]]");
  fileWatcherSettings = {
    usePolling: usePolling,
    interval: interval,
    binaryInterval: binaryInterval
  };
  importFrom = function(target, callback) {
    var fileWatcher;
    log("info", "watching " + target);
    fileWatcher = prepareFileWatcher(target, extensions, excludePaths, isBuild, fileWatcherSettings, mimosaConfig.fubumvc.baseDir);
    return startWatching(target, fileWatcher, {
      sourceDir: sourceDir,
      conventions: conventions,
      baseDir: baseDir
    }, callback);
  };
  targets = getTargets(workingDir);
  finish = trackCompletion("importAssets", targets, next);
  _.each(targets, function(target) {
    return importFrom(target, function() {
      return finish(target);
    });
  });
};

getTargets = function(dir) {
  var bottles, targets;
  bottles = _.map(findBottles(dir), function(bottle) {
    return path.resolve(dir, bottle);
  });
  return targets = [].concat(bottles, [dir]);
};

cleanAssets = function(mimosaConfig, options, next) {
  var allTargetFiles, baseDir, compiledDir, conventions, excludePaths, extensions, filesFor, finish, isBuild, sourceDir, targets, _ref1;
  log("info", "cleaning assets");
  _ref1 = mimosaConfig.fubumvc, extensions = _ref1.extensions, excludePaths = _ref1.excludePaths, sourceDir = _ref1.sourceDir, compiledDir = _ref1.compiledDir, isBuild = _ref1.isBuild, conventions = _ref1.conventions, baseDir = _ref1.baseDir;
  extensions = buildExtensions(mimosaConfig);
  options = {
    sourceDir: sourceDir,
    conventions: conventions,
    baseDir: baseDir
  };
  filesFor = function(target) {
    var files, outputFiles;
    log("debug", "finding files for: " + target + " with extensions: " + extensions + " and excludePaths: " + excludePaths);
    files = findSourceFiles(target, extensions, excludePaths);
    outputFiles = _.map(files, function(f) {
      return transformPath(f, target, options, mimosaConfig);
    });
    return [target, files, outputFiles];
  };
  targets = getTargets(workingDir);
  allTargetFiles = _.map(targets, filesFor);
  finish = trackCompletion("cleanAssets", targets, next);
  _.each(allTargetFiles, function(_arg) {
    var files, outputFiles, target;
    target = _arg[0], files = _arg[1], outputFiles = _arg[2];
    return clean([target, files, outputFiles], function() {
      return finish(target);
    });
  });
};

trackCompletion = function(title, initial, cb) {
  var done, remaining;
  remaining = [].concat(initial);
  done = function(dir) {
    remaining = _.without(remaining, dir);
    if (remaining.length === 0) {
      log("info", "finished " + title);
      return cb();
    }
  };
  return done;
};

clean = function(_arg, cb) {
  var dirs, files, finish, outputFiles, target;
  target = _arg[0], files = _arg[1], outputFiles = _arg[2];
  _.each(outputFiles, function(f) {
    return deleteFileSync(f);
  });
  dirs = _(outputFiles).map(function(f) {
    return path.dirname(f);
  }).unique().sortBy("length").reverse().value();
  if (dirs.length > 0) {
    finish = trackCompletion("clean", dirs, cb);
    return _(dirs).map(function(dir) {
      return [
        dir, function() {
          return finish(dir);
        }
      ];
    }).each(function(_arg1) {
      var cb, dir;
      dir = _arg1[0], cb = _arg1[1];
      return deleteDirectory(dir, cb);
    });
  } else {
    return cb();
  }
};

module.exports = {
  importAssets: importAssets,
  cleanAssets: cleanAssets
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL21udC9SZXNvdXJjZXMvUHJvamVjdHMvbWltb3NhLWZ1YnVtdmMvbGliL2Z1YnUtaW1wb3J0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiL21udC9SZXNvdXJjZXMvUHJvamVjdHMvbWltb3NhLWZ1YnVtdmMvc3JjL2Z1YnUtaW1wb3J0LmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxZQUFBLENBQUE7QUFBQSxJQUFBLDZhQUFBOztBQUFBLE9BRWtCLE9BQUEsQ0FBUSxRQUFSLENBQWxCLEVBQUMsV0FBQSxHQUFELEVBQU0sZ0JBQUEsUUFGTixDQUFBOztBQUFBLEtBR0EsR0FBUSxPQUFBLENBQVEsWUFBUixDQUFxQixDQUFDLEdBSDlCLENBQUE7O0FBQUEsRUFJQSxHQUFLLE9BQUEsQ0FBUSxJQUFSLENBSkwsQ0FBQTs7QUFBQSxJQUtBLEdBQU8sT0FBQSxDQUFRLE1BQVIsQ0FMUCxDQUFBOztBQUFBLEtBTUEsR0FBUSxPQUFBLENBQVEsVUFBUixDQU5SLENBQUE7O0FBQUEsTUFPQSxHQUFTLE9BQUEsQ0FBUSxRQUFSLENBUFQsQ0FBQTs7QUFBQSxDQVFBLEdBQUksT0FBQSxDQUFRLFFBQVIsQ0FSSixDQUFBOztBQUFBLFdBU0EsR0FBYyxPQUFBLENBQVEsUUFBUixDQUFpQixDQUFDLFdBVGhDLENBQUE7O0FBQUEsVUFVQSxHQUFhLE9BQU8sQ0FBQyxHQUFSLENBQUEsQ0FWYixDQUFBOztBQUFBLEVBV0EsR0FBSyxPQUFBLENBQVEsSUFBUixDQVhMLENBQUE7O0FBQUEsZUFhQSxHQUFrQixTQUFDLElBQUQsRUFBTyxVQUFQLEVBQW1CLFFBQW5CLEVBQTZCLE9BQTdCLEdBQUE7U0FDaEIsTUFBTSxDQUFDLG9CQUFQLENBQTRCLElBQTVCLENBQ0UsQ0FBQyxNQURILENBQ1UsU0FBQyxDQUFELEdBQUE7QUFDTixRQUFBLGdDQUFBO0FBQUEsSUFBQSxZQUFBLEdBQWUsSUFBSSxDQUFDLElBQUwsQ0FBVSxJQUFWLEVBQWdCLENBQWhC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SCxDQUVRLFNBQUMsS0FBRCxHQUFBO0FBQ0osVUFBQSxPQUFBO0FBQUEsTUFETSxnQkFBSyxhQUNYLENBQUE7YUFBQSxlQUFBLENBQWdCLEdBQWhCLEVBQXFCLEVBQXJCLEVBREk7SUFBQSxDQUZSLEVBSEY7R0FBQSxNQUFBO1dBUUUsRUFBQSxDQUFBLEVBUkY7R0FWTTtBQUFBLENBbFJSLENBQUE7O0FBQUEsTUFzU00sQ0FBQyxPQUFQLEdBQWlCO0FBQUEsRUFBQyxjQUFBLFlBQUQ7QUFBQSxFQUFlLGFBQUEsV0FBZjtDQXRTakIsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiXG5cbntsb2csIHByaW50T2JqfSA9IHJlcXVpcmUgJy4vdXRpbCdcbmNvbG9yID0gcmVxdWlyZSgnYW5zaS1jb2xvcicpLnNldFxuZnMgPSByZXF1aXJlICdmcydcbnBhdGggPSByZXF1aXJlICdwYXRoJ1xud2F0Y2ggPSByZXF1aXJlICdjaG9raWRhcidcbndyZW5jaCA9IHJlcXVpcmUgJ3dyZW5jaCdcbl8gPSByZXF1aXJlICdsb2Rhc2gnXG5wYXJzZVN0cmluZyA9IHJlcXVpcmUoJ3htbDJqcycpLnBhcnNlU3RyaW5nXG53b3JraW5nRGlyID0gcHJvY2Vzcy5jd2QoKVxuUnggPSByZXF1aXJlIFwicnhcIlxuXG5maW5kU291cmNlRmlsZXMgPSAoZnJvbSwgZXh0ZW5zaW9ucywgZXhjbHVkZXMsIGJhc2VEaXIpIC0+XG4gIHdyZW5jaC5yZWFkZGlyU3luY1JlY3Vyc2l2ZShmcm9tKVxuICAgIC5maWx0ZXIgKGYpIC0+XG4gICAgICBvcmlnaW5hbEZpbGUgPSBwYXRoLmpvaW4gZnJvbSwgZlxuICAgICAgaXNGaWxlID0gZnMuc3RhdFN5bmMob3JpZ2luYWxGaWxlKS5pc0ZpbGUoKVxuICAgICAgaXNJbmNsdWRlZCA9IHNob3VsZEluY2x1ZGUgZiwgaXNGaWxlLCBleHRlbnNpb25zLCBleGNsdWRlcywgYmFzZURpclxuICAgICAgaXNJbmNsdWRlZCBhbmQgaXNGaWxlXG4gICAgLm1hcCAoZikgLT4gcGF0aC5qb2luIGZyb20sIGZcblxuc2hvdWxkSW5jbHVkZSA9IChmLCBpc0ZpbGUsIGV4dGVuc2lvbnMsIGV4Y2x1ZGVzLCBiYXNlRGlyKSAtPlxuICAjVE9ETzogb25seSBhZGRzIHRoZSAuIHRvIHlvdSBmb3IgZXh0ZW5zaW9ucyBpZiBpdHMgbGVmdCBvZmZcbiAgZXh0ZW5zaW9ucyA9IGV4dGVuc2lvbnMubWFwIChleHQpIC0+IFwiLiN7ZXh0fVwiXG4gIGV4dCA9IHBhdGguZXh0bmFtZSBmXG4gIG1hdGNoZXNFeHRlbnNpb24gPSBub3QgaXNGaWxlIG9yIF8uY29udGFpbnMgZXh0ZW5zaW9ucywgZXh0XG4gIGF0Um9vdCA9IGlzRmlsZSBhbmQgZi5pbmRleE9mKHBhdGguc2VwKSA9PSAtMVxuICBleGNsdWRlZCA9IGlzRXhjbHVkZWRCeUNvbmZpZyBmLCBleGNsdWRlcywgYmFzZURpclxuICBtYXRjaGVzRXh0ZW5zaW9uIGFuZCBub3QgZXhjbHVkZWQgYW5kIG5vdCBhdFJvb3Rcblxud2l0aG91dFBhdGggPSAoZnJvbVBhdGgpIC0+XG4gIChpbnB1dCkgLT4gaW5wdXQucmVwbGFjZSBcIiN7ZnJvbVBhdGh9I3twYXRoLnNlcH1cIiwgJydcblxucHJlcGFyZUZpbGVXYXRjaGVyID0gKGZyb20sIGV4dGVuc2lvbnMsIGV4Y2x1ZGVzLCBpc0J1aWxkLCBmaWxlV2F0Y2hlclNldHRpbmdzLCBiYXNlRGlyKSAtPlxuICAjVE9ETzogbm8gbW9yZSBzeW5jIGNhbGxzXG4gIGZpbGVzICA9IGZpbmRTb3VyY2VGaWxlcyBmcm9tLCBleHRlbnNpb25zLCBleGNsdWRlcywgYmFzZURpclxuICBudW1iZXJPZkZpbGVzICA9IGZpbGVzLmxlbmd0aFxuICBmaXhQYXRoID0gd2l0aG91dFBhdGggZnJvbVxuXG4gIHNldHRpbmdzID1cbiAgICBpZ25vcmVkOiAoZmlsZSkgLT5cbiAgICAgIGlzRmlsZSA9IGZzLnN0YXRTeW5jKGZpbGUpLmlzRmlsZSgpXG4gICAgICBmID0gZml4UGF0aCBmaWxlXG4gICAgICBub3QgKHNob3VsZEluY2x1ZGUgZiwgaXNGaWxlLCBleHRlbnNpb25zLCBleGNsdWRlcywgYmFzZURpcilcbiAgICBwZXJzaXN0ZW50OiBub3QgaXNCdWlsZFxuXG4gIHdhdGNoU2V0dGluZ3MgPSBfLmV4dGVuZCBzZXR0aW5ncywgZmlsZVdhdGNoZXJTZXR0aW5nc1xuXG4gIG9ic2VydmFibGVGb3IgPSAoZXZlbnQpIC0+XG4gICAgUnguT2JzZXJ2YWJsZS5mcm9tRXZlbnQgd2F0Y2hlciwgZXZlbnRcblxuICBsb2cgXCJkZWJ1Z1wiLCBcInN0YXJ0aW5nIGZpbGUgd2F0Y2hlciBvbiBbWyAje2Zyb219IF1dIHVzZVBvbGxpbmc6ICN7d2F0Y2hTZXR0aW5ncy51c2VQb2xsaW5nfVwiXG5cbiAgd2F0Y2hlciA9IHdhdGNoLndhdGNoIGZyb20sIHdhdGNoU2V0dGluZ3NcbiAgYWRkcyA9IG9ic2VydmFibGVGb3IgXCJhZGRcIlxuICBjaGFuZ2VzID0gb2JzZXJ2YWJsZUZvciBcImNoYW5nZVwiXG4gIHVubGlua3MgPSBvYnNlcnZhYmxlRm9yIFwidW5saW5rXCJcbiAgZXJyb3JzID0gKG9ic2VydmFibGVGb3IgXCJlcnJvclwiKS5zZWxlY3RNYW55IChlKSAtPiBSeC5PYnNlcnZhYmxlLnRocm93IGVcbiAge251bWJlck9mRmlsZXMsIGFkZHMsIGNoYW5nZXMsIHVubGlua3MsIGVycm9yc31cblxuc3RhcnRXYXRjaGluZyA9IChcbiAgZnJvbSxcbiAge251bWJlck9mRmlsZXMsIGFkZHMsIGNoYW5nZXMsIHVubGlua3MsIGVycm9yc30sXG4gIG9wdGlvbnMsXG4gIGNiKSAtPlxuXG4gIGZyb21Tb3VyY2UgPSAob2JzKSAtPlxuICAgIG9icy5tZXJnZShlcnJvcnMpXG5cbiAgaW5pdGlhbENvcHkgPSBmcm9tU291cmNlKGFkZHMpLnRha2UobnVtYmVyT2ZGaWxlcylcblxuICBpbml0aWFsQ29weS5zdWJzY3JpYmUoXG4gICAgKGYpIC0+XG4gICAgICBjb3B5RmlsZSBmLCBmcm9tLCBvcHRpb25zXG4gICAgKGUpIC0+XG4gICAgICBsb2cgXCJ3YXJuXCIsIFwiRmlsZSB3YXRjaGluZyBlcnJvcjogI3tlfVwiXG4gICAgICBjYigpIGlmIGNiXG4gICAgKCkgLT5cbiAgICAgIG9uZ29pbmdDb3B5ID0gZnJvbVNvdXJjZShhZGRzLm1lcmdlIGNoYW5nZXMpXG4gICAgICBvbmdvaW5nQ29weS5zdWJzY3JpYmUoXG4gICAgICAgIChmKSAtPiBjb3B5RmlsZSBmLCBmcm9tLCBvcHRpb25zXG4gICAgICAgIChlKSAtPiBsb2cgXCJ3YXJuXCIsIFwiRmlsZSB3YXRjaGluZyBlcnJvcjogI3tlfVwiXG4gICAgICApXG4gICAgICBsb2cgXCJpbmZvXCIsIFwiZmluaXNoZWQgaW5pdGlhbCBjb3B5IGZvcjogI3tmcm9tfVwiXG4gICAgICBjYigpIGlmIGNiXG4gIClcblxuICBkZWxldGVzID0gZnJvbVNvdXJjZSh1bmxpbmtzKVxuXG4gIGRlbGV0ZXMuc3Vic2NyaWJlKFxuICAgIChmKSAtPlxuICAgICAgb3V0RmlsZSA9IHRyYW5zZm9ybVBhdGggZiwgZnJvbSwgb3B0aW9uc1xuICAgICAgZGVsZXRlRmlsZSBvdXRGaWxlXG4gICAgKGUpIC0+IGxvZyBcIndhcm5cIiwgXCJGaWxlIHdhdGNoaW5nIGVycm9yczogI3tlfVwiXG4gIClcblxuY29weUZpbGUgPSAoZmlsZSwgZnJvbSwgb3B0aW9ucykgLT5cbiAgZnMucmVhZEZpbGUgZmlsZSwgKGVyciwgZGF0YSkgLT5cbiAgICBpZiBlcnJcbiAgICAgIGxvZyBcImVycm9yXCIsIFwiRXJyb3IgcmVhZGluZyBmaWxlIFtbICN7ZmlsZX0gXV0sICN7ZXJyfVwiXG4gICAgICByZXR1cm5cblxuICAgIG91dEZpbGUgPSB0cmFuc2Zvcm1QYXRoIGZpbGUsIGZyb20sIG9wdGlvbnNcblxuICAgIGRpcm5hbWUgPSBwYXRoLmRpcm5hbWUgb3V0RmlsZVxuICAgIHVubGVzcyBmcy5leGlzdHNTeW5jIGRpcm5hbWVcbiAgICAgIHdyZW5jaC5ta2RpclN5bmNSZWN1cnNpdmUgZGlybmFtZSwgMG8wNzc3XG5cbiAgICBmcy53cml0ZUZpbGUgb3V0RmlsZSwgZGF0YSwgKGVycikgLT5cbiAgICAgIGlmIGVyclxuICAgICAgICBsb2cgXCJlcnJvclwiLCBcIkVycm9yIHJlYWRpbmcgZmlsZSBbWyAje2ZpbGV9IF1dLCAje2Vycn1cIlxuICAgICAgZWxzZVxuICAgICAgICBsb2cgXCJzdWNjZXNzXCIsIFwiRmlsZSBjb3BpZWQgdG8gZGVzdGluYXRpb24gW1sgI3tvdXRGaWxlfSBdXSBmcm9tIFtbICN7ZmlsZX0gXV1cIlxuXG5kZWxldGVGaWxlU3luYyA9IChmaWxlKSAtPlxuICBpZiBmcy5leGlzdHNTeW5jIGZpbGVcbiAgICBmcy51bmxpbmtTeW5jIGZpbGVcbiAgICBsb2cgXCJzdWNjZXNzXCIsIFwiRmlsZSBbWyAje2ZpbGV9IF1dIGRlbGV0ZWQuXCJcblxuZGVsZXRlRmlsZSA9IChmaWxlKSAtPlxuICBmcy5leGlzdHMgZmlsZSwgKGV4aXN0cykgLT5cbiAgICBpZiBleGlzdHNcbiAgICAgIGZzLnVubGluayBmaWxlLCAoZXJyKSAtPlxuICAgICAgICBpZiBlcnJcbiAgICAgICAgICBsb2cgXCJlcnJvclwiLCBcIkVycm9yIGRlbGV0aW5nIGZpbGUgW1sgI3tmaWxlfSBdXSwgI3tlcnJ9XCJcbiAgICAgICAgZWxzZVxuICAgICAgICAgIGxvZyBcInN1Y2Nlc3NcIiwgXCJGaWxlIFtbICN7ZmlsZX0gXV0gZGVsZXRlZC5cIlxuXG5kZWxldGVEaXJlY3RvcnkgPSAoZGlyLCBjYikgLT5cbiAgaWYgZnMuZXhpc3RzU3luYyBkaXJcbiAgICBmcy5ybWRpciBkaXIsIChlcnIpIC0+XG4gICAgICBpZiBlcnI/LmNvZGUgaXMgbm90IFwiRU5PVEVNUFRZXCJcbiAgICAgICAgbG9nIFwiZXJyb3JcIiwgXCJVbmFibGUgdG8gZGVsZXRlIGRpcmVjdG9yeSBbWyAje2Rpcn0gXV1cIlxuICAgICAgICBsb2cgXCJlcnJvclwiLCBlcnJcbiAgICAgIGVsc2VcbiAgICAgICAgbG9nIFwiaW5mb1wiLCBcIkRlbGV0ZWQgZW1wdHkgZGlyZWN0b3J5IFtbICN7ZGlyfSBdXVwiXG4gICAgICBjYigpIGlmIGNiXG4gIGVsc2UgY2IoKSBpZiBjYlxuXG53aXRob3V0QmFzZURpciA9ICh0ZXN0UGF0aCwgYmFzZURpcikgLT5cbiAgYmFzZURpciA9IGlmIChiYXNlRGlyIGFuZCBiYXNlRGlyLmxlbmd0aCkgdGhlbiBwYXRoLmpvaW4oYmFzZURpciwgXCIvXCIpIGVsc2UgYmFzZURpclxuICBjd2QgPSBwcm9jZXNzLmN3ZCgpXG4gIG5ld1BhdGggPSB0ZXN0UGF0aC5yZXBsYWNlKGN3ZCwgXCJcIilcbiAgc3RhcnQgPSBNYXRoLm1heChuZXdQYXRoLmluZGV4T2YoYmFzZURpciksIDApXG4gIG5ld1BhdGggPSBuZXdQYXRoLnN1YnN0cmluZyhzdGFydClcbiAgcmV0dXJuVmFsID0gbmV3UGF0aC5yZXBsYWNlKGJhc2VEaXIgb3IgXCJcIiwgXCJcIikucmVwbGFjZSgvXlxcL3xeXFxcXC8sIFwiXCIpXG4gIHJldHVybiByZXR1cm5WYWxcblxudHJhbnNmb3JtUGF0aCA9IChmaWxlLCBmcm9tLCB7c291cmNlRGlyLCBjb252ZW50aW9ucywgYmFzZURpcn0pIC0+XG4gIGJhc2VEaXIgPSBiYXNlRGlyIG9yIFwiXCJcbiAgbmV3RmlsZVBhdGggPSB3aXRob3V0QmFzZURpciBmaWxlLCBiYXNlRGlyXG4gIG5ld1NvdXJjZURpciA9IHdpdGhvdXRCYXNlRGlyIHNvdXJjZURpciwgYmFzZURpclxuICBmaXhQYXRoID0gd2l0aG91dFBhdGggZnJvbVxuICBuZXdGaWxlID0gZml4UGF0aCBuZXdGaWxlUGF0aFxuICByZXN1bHQgPSBfLnJlZHVjZShjb252ZW50aW9ucywgKGFjYywge21hdGNoLCB0cmFuc2Zvcm19KSAtPlxuICAgIGV4dCA9IHBhdGguZXh0bmFtZSBhY2NcbiAgICBpZiBtYXRjaCBhY2MsIGV4dCwgbG9nIHRoZW4gdHJhbnNmb3JtIGFjYywgcGF0aCwgbG9nIGVsc2UgYWNjXG4gICwgbmV3RmlsZSlcbiAgc291cmNlUmVnZXggPSBuZXcgUmVnRXhwKG5ld1NvdXJjZURpciwgXCJnXCIpXG4gIHJlc3VsdCA9IHJlc3VsdC5yZXBsYWNlKHNvdXJjZVJlZ2V4LCBcIlwiKVxuICBmaW5hbFBhdGggPSBwYXRoLmpvaW4gYmFzZURpciwgbmV3U291cmNlRGlyLCByZXN1bHRcbiAgZmluYWxQYXRoXG5cbm1hdGNoZXNXaXRob3V0QmFzZURpciA9ICh0ZXN0UGF0aCwgYmFzZURpciwgcHJlZGljYXRlKSAtPlxuICBuZXdUZXN0ID0gd2l0aG91dEJhc2VEaXIgdGVzdFBhdGgsIGJhc2VEaXIgb3IgXCJcIlxuICBzaG91bGRFeGNsdWRlID0gcHJlZGljYXRlKG5ld1Rlc3QpXG4gIHJldHVybiBzaG91bGRFeGNsdWRlXG5cbmV4Y2x1ZGVTdHJhdGVnaWVzID1cbiAgc3RyaW5nOlxuICAgIGlkZW50aXR5OiBfLmlzU3RyaW5nXG4gICAgcHJlZGljYXRlOiAoZXgsIHRlc3RQYXRoLCBiYXNlRGlyKSAtPiAgbWF0Y2hlc1dpdGhvdXRCYXNlRGlyIHRlc3RQYXRoLCBiYXNlRGlyLCAobmV3UGF0aCkgLT4gbmV3UGF0aC5pbmRleE9mKGV4KSA9PSAwXG4gIHJlZ2V4OlxuICAgIGlkZW50aXR5OiBfLmlzUmVnRXhwXG4gICAgcHJlZGljYXRlOiAoZXgsIHRlc3RQYXRoLCBiYXNlRGlyKSAtPiBtYXRjaGVzV2l0aG91dEJhc2VEaXIgdGVzdFBhdGgsIGJhc2VEaXIsIChuZXdQYXRoKSAtPiBleC50ZXN0IG5ld1BhdGhcblxuaXNFeGNsdWRlZEJ5Q29uZmlnID0gKHRlc3RQYXRoLCBleGNsdWRlcywgYmFzZURpcikgLT5cbiAgb2ZUeXBlID0gKG1ldGhvZCkgLT5cbiAgICBleGNsdWRlcy5maWx0ZXIgKGYpIC0+IG1ldGhvZChmKVxuXG4gIF8uYW55IGV4Y2x1ZGVTdHJhdGVnaWVzLCAoe2lkZW50aXR5LCBwcmVkaWNhdGV9KSAtPlxuICAgIF8uYW55IChvZlR5cGUgaWRlbnRpdHkpLCAoZXgpIC0+IHByZWRpY2F0ZSBleCwgdGVzdFBhdGgsIGJhc2VEaXJcblxucGFyc2VYbWwgPSAoY29udGVudCkgLT5cbiAgcmVzdWx0ID0ge31cbiAgcGFyc2VTdHJpbmcgY29udGVudCwgKGVyciwgb3V0cHV0KSAtPlxuICAgIHJlc3VsdCA9IG91dHB1dFxuICByZXN1bHRcblxuZmluZEJvdHRsZXMgPSAoc291cmNlRGlyKSAtPlxuICBsaW5rc0ZpbGUgPSBwYXRoLmpvaW4gc291cmNlRGlyLCBcIi5saW5rc1wiXG4gIGlmIGZzLmV4aXN0c1N5bmMgbGlua3NGaWxlXG4gICAgZW5jb2RpbmcgPSBcInV0ZjhcIlxuICAgIGRhdGEgPSBmcy5yZWFkRmlsZVN5bmMgbGlua3NGaWxlLCB7ZW5jb2Rpbmd9XG4gICAgbGlua3NYbWwgPSBwYXJzZVhtbCBkYXRhXG4gICAgYm90dGxlcyA9IGxpbmtzWG1sPy5saW5rcz8uaW5jbHVkZSB8fCBbXVxuICAgIHVubGVzcyBib3R0bGVzIGFuZCBfLmlzQXJyYXkgYm90dGxlc1xuICAgICAgbG9nIFwiZXJyb3JcIiwgXCIubGlua3MgZmlsZSBub3QgdmFsaWRcIlxuICAgICAgcmV0dXJuXG4gICAgYm90dGxlcyA9IF8ubWFwKGJvdHRsZXMsIChib3R0bGUpLT4gYm90dGxlLnJlcGxhY2UoL1xcXFx8XFwvLywgcGF0aC5zZXApKVxuICAgIGJvdHRsZXNcbiAgZWxzZVxuICAgIFtdXG5cbmJ1aWxkRXh0ZW5zaW9ucyA9IChjb25maWcpIC0+XG4gIHtjb3B5LCBqYXZhc2NyaXB0LCBjc3N9ID0gY29uZmlnLmV4dGVuc2lvbnNcbiAgZXh0ZW5zaW9ucyA9IF8udW5pb24gY29weSwgamF2YXNjcmlwdCwgY3NzXG5cbnNldFdvcmtpbmdEaXIgPSAodmFsKSAtPlxuICB3b3JraW5nRGlyID0gdmFsIG9yIHByb2Nlc3MuY3dkKClcblxuaW1wb3J0QXNzZXRzID0gKG1pbW9zYUNvbmZpZywgb3B0aW9ucywgbmV4dCkgLT5cbiAgbG9nIFwiaW5mb1wiLCBcImltcG9ydGluZyBhc3NldHNcIlxuICB7ZXhjbHVkZVBhdGhzLCBzb3VyY2VEaXIsIGNvbXBpbGVkRGlyLCBpc0J1aWxkLCBjb252ZW50aW9ucywgdXNlUG9sbGluZywgaW50ZXJ2YWwsIGJpbmFyeUludGVydmFsLCBiYXNlRGlyfSA9XG4gICAgbWltb3NhQ29uZmlnLmZ1YnVtdmNcblxuICBleHRlbnNpb25zID0gYnVpbGRFeHRlbnNpb25zIG1pbW9zYUNvbmZpZ1xuICBzZXRXb3JraW5nRGlyIGJhc2VEaXJcblxuICBsb2cgXCJkZWJ1Z1wiLCBcImFsbG93ZWQgZXh0ZW5zaW9ucyBbWyAje2V4dGVuc2lvbnN9IF1dXCJcbiAgbG9nIFwiZGVidWdcIiwgXCJleGNsdWRlUGF0aHMgW1sgI3tleGNsdWRlUGF0aHN9IF1dXCJcblxuICBmaWxlV2F0Y2hlclNldHRpbmdzID0ge3VzZVBvbGxpbmcsIGludGVydmFsLCBiaW5hcnlJbnRlcnZhbH1cblxuICBpbXBvcnRGcm9tID0gKHRhcmdldCwgY2FsbGJhY2spIC0+XG4gICAgbG9nIFwiaW5mb1wiLCBcIndhdGNoaW5nICN7dGFyZ2V0fVwiXG4gICAgZmlsZVdhdGNoZXIgPSBwcmVwYXJlRmlsZVdhdGNoZXIgdGFyZ2V0LCBleHRlbnNpb25zLCBleGNsdWRlUGF0aHMsIGlzQnVpbGQsIGZpbGVXYXRjaGVyU2V0dGluZ3MsIG1pbW9zYUNvbmZpZy5mdWJ1bXZjLmJhc2VEaXJcbiAgICBzdGFydFdhdGNoaW5nIHRhcmdldCwgZmlsZVdhdGNoZXIsIHtzb3VyY2VEaXIsIGNvbnZlbnRpb25zLCBiYXNlRGlyfSwgY2FsbGJhY2tcblxuICB0YXJnZXRzID0gZ2V0VGFyZ2V0cyB3b3JraW5nRGlyXG5cbiAgZmluaXNoID0gdHJhY2tDb21wbGV0aW9uIFwiaW1wb3J0QXNzZXRzXCIsIHRhcmdldHMsIG5leHRcblxuICBfLmVhY2ggdGFyZ2V0cywgKHRhcmdldCkgLT5cbiAgICBpbXBvcnRGcm9tIHRhcmdldCwgKCkgLT4gZmluaXNoKHRhcmdldClcbiAgcmV0dXJuXG5cbmdldFRhcmdldHMgPSAoZGlyKSAtPlxuICBib3R0bGVzID0gXy5tYXAgKGZpbmRCb3R0bGVzIGRpciksIChib3R0bGUpIC0+IHBhdGgucmVzb2x2ZSBkaXIsIGJvdHRsZVxuICB0YXJnZXRzID0gW10uY29uY2F0IGJvdHRsZXMsIFtkaXJdXG5cbmNsZWFuQXNzZXRzID0gKG1pbW9zYUNvbmZpZywgb3B0aW9ucywgbmV4dCkgLT5cbiAgbG9nIFwiaW5mb1wiLCBcImNsZWFuaW5nIGFzc2V0c1wiXG4gIHtleHRlbnNpb25zLCBleGNsdWRlUGF0aHMsIHNvdXJjZURpciwgY29tcGlsZWREaXIsIGlzQnVpbGQsIGNvbnZlbnRpb25zLCBiYXNlRGlyfSA9XG4gICAgbWltb3NhQ29uZmlnLmZ1YnVtdmNcbiAgZXh0ZW5zaW9ucyA9IGJ1aWxkRXh0ZW5zaW9ucyBtaW1vc2FDb25maWdcbiAgb3B0aW9ucyA9IHtzb3VyY2VEaXIsIGNvbnZlbnRpb25zLCBiYXNlRGlyfVxuXG4gIGZpbGVzRm9yID0gKHRhcmdldCkgLT5cbiAgICBsb2cgXCJkZWJ1Z1wiLCBcImZpbmRpbmcgZmlsZXMgZm9yOiAje3RhcmdldH0gd2l0aCBleHRlbnNpb25zOiAje2V4dGVuc2lvbnN9IGFuZCBleGNsdWRlUGF0aHM6ICN7ZXhjbHVkZVBhdGhzfVwiXG4gICAgZmlsZXMgID0gZmluZFNvdXJjZUZpbGVzIHRhcmdldCwgZXh0ZW5zaW9ucywgZXhjbHVkZVBhdGhzXG4gICAgb3V0cHV0RmlsZXMgPSBfLm1hcCBmaWxlcywgKGYpIC0+IHRyYW5zZm9ybVBhdGggZiwgdGFyZ2V0LCBvcHRpb25zLCBtaW1vc2FDb25maWdcbiAgICBbdGFyZ2V0LCBmaWxlcywgb3V0cHV0RmlsZXNdXG5cbiAgdGFyZ2V0cyA9IGdldFRhcmdldHMgd29ya2luZ0RpclxuXG4gIGFsbFRhcmdldEZpbGVzID0gXy5tYXAgdGFyZ2V0cywgZmlsZXNGb3JcblxuICBmaW5pc2ggPSB0cmFja0NvbXBsZXRpb24gXCJjbGVhbkFzc2V0c1wiLCB0YXJnZXRzLCBuZXh0XG5cbiAgXy5lYWNoIGFsbFRhcmdldEZpbGVzLCAoW3RhcmdldCwgZmlsZXMsIG91dHB1dEZpbGVzXSkgLT5cbiAgICBjbGVhbiBbdGFyZ2V0LCBmaWxlcywgb3V0cHV0RmlsZXNdLCAoKSAtPiBmaW5pc2godGFyZ2V0KVxuICByZXR1cm5cblxudHJhY2tDb21wbGV0aW9uID0gKHRpdGxlLCBpbml0aWFsLCBjYikgLT5cbiAgcmVtYWluaW5nID0gW10uY29uY2F0IGluaXRpYWxcbiAgZG9uZSA9IChkaXIpIC0+XG4gICAgcmVtYWluaW5nID0gXy53aXRob3V0IHJlbWFpbmluZywgZGlyXG4gICAgaWYgcmVtYWluaW5nLmxlbmd0aCA9PSAwXG4gICAgICBsb2cgXCJpbmZvXCIsIFwiZmluaXNoZWQgI3t0aXRsZX1cIlxuICAgICAgY2IoKVxuICBkb25lXG5cbmNsZWFuID0gKFt0YXJnZXQsIGZpbGVzLCBvdXRwdXRGaWxlc10sIGNiKSAtPlxuICBfLmVhY2ggb3V0cHV0RmlsZXMsIChmKSAtPiBkZWxldGVGaWxlU3luYyBmXG5cbiAgZGlycyA9IF8gb3V0cHV0RmlsZXNcbiAgICAubWFwIChmKSAtPiBwYXRoLmRpcm5hbWUgZlxuICAgIC51bmlxdWUoKVxuICAgIC5zb3J0QnkgXCJsZW5ndGhcIlxuICAgIC5yZXZlcnNlKClcbiAgICAudmFsdWUoKVxuXG4gIGlmIGRpcnMubGVuZ3RoID4gMFxuICAgIGZpbmlzaCA9IHRyYWNrQ29tcGxldGlvbiBcImNsZWFuXCIsIGRpcnMsIGNiXG5cbiAgICBfIGRpcnNcbiAgICAgIC5tYXAgKGRpcikgLT4gW2RpciwgKCkgLT4gZmluaXNoKGRpcildXG4gICAgICAuZWFjaCAoW2RpciwgY2JdKSAtPlxuICAgICAgICBkZWxldGVEaXJlY3RvcnkgZGlyLCBjYlxuICBlbHNlXG4gICAgY2IoKVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtpbXBvcnRBc3NldHMsIGNsZWFuQXNzZXRzfVxuIl19
