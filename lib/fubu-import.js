"use strict";
var Rx, buildExtensions, clean, cleanAssets, color, copyFile, cwd, deleteDirectory, deleteFile, deleteFileSync, excludeStrategies, findBottles, findSourceFiles, fs, getTargets, importAssets, isExcludedByConfig, log, parseString, parseXml, path, prepareFileWatcher, shouldInclude, startWatching, trackCompletion, transformPath, watch, withoutPath, wrench, _;

log = require('./util').log;

color = require('ansi-color').set;

fs = require('fs');

path = require('path');

watch = require('chokidar');

wrench = require('wrench');

_ = require('lodash');

parseString = require('xml2js').parseString;

cwd = process.cwd();

Rx = require("rx");

findSourceFiles = function(from, extensions, excludes) {
  return wrench.readdirSyncRecursive(from).filter(function(f) {
    var isFile, isIncluded, originalFile;
    originalFile = path.join(from, f);
    isFile = fs.statSync(originalFile).isFile();
    isIncluded = shouldInclude(f, isFile, extensions, excludes);
    return isIncluded && isFile;
  }).map(function(f) {
    return path.join(from, f);
  });
};

shouldInclude = function(f, isFile, extensions, excludes) {
  var atRoot, excluded, ext, matchesExtension;
  extensions = extensions.map(function(ext) {
    return "." + ext;
  });
  ext = path.extname(f);
  matchesExtension = !isFile || _.contains(extensions, ext);
  atRoot = isFile && f.indexOf(path.sep) === -1;
  excluded = isExcludedByConfig(f, excludes);
  return matchesExtension && !excluded && !atRoot;
};

withoutPath = function(fromPath) {
  return function(input) {
    return input.replace("" + fromPath + path.sep, '');
  };
};

prepareFileWatcher = function(from, extensions, excludes, isBuild) {
  var adds, changes, errors, files, fixPath, numberOfFiles, observableFor, unlinks, watchSettings, watcher;
  files = findSourceFiles(from, extensions, excludes);
  numberOfFiles = files.length;
  fixPath = withoutPath(from);
  watchSettings = {
    ignored: function(file) {
      var f, isFile;
      isFile = fs.statSync(file).isFile();
      f = fixPath(file);
      return !(shouldInclude(f, isFile, extensions, excludes));
    },
    persistent: !isBuild,
    usePolling: true,
    interval: 500,
    binaryInterval: 1000
  };
  observableFor = function(event) {
    return Rx.Observable.fromEvent(watcher, event);
  };
  watcher = watch.watch(from, watchSettings);
  adds = observableFor("add");
  changes = observableFor("change");
  unlinks = observableFor("unlink");
  errors = (observableFor("error")).selectMany(function(e) {
    return Rx.Observable["throw"](e);
  });
  return {
    numberOfFiles: numberOfFiles,
    adds: adds,
    changes: changes,
    unlinks: unlinks,
    errors: errors
  };
};

startWatching = function(from, _arg, options, cb) {
  var adds, changes, deletes, errors, fromSource, initialCopy, numberOfFiles, unlinks;
  numberOfFiles = _arg.numberOfFiles, adds = _arg.adds, changes = _arg.changes, unlinks = _arg.unlinks, errors = _arg.errors;
  fromSource = function(obs) {
    return obs.merge(errors);
  };
  initialCopy = fromSource(adds).take(numberOfFiles);
  initialCopy.subscribe(function(f) {
    return copyFile(f, from, options);
  }, function(e) {
    log("warn", "File watching error: " + e);
    if (cb) {
      return cb();
    }
  }, function() {
    var ongoingCopy;
    ongoingCopy = fromSource(adds.merge(changes));
    ongoingCopy.subscribe(function(f) {
      return copyFile(f, from, options);
    }, function(e) {
      return log("warn", "File watching error: " + e);
    });
    if (cb) {
      return cb();
    }
  });
  deletes = fromSource(unlinks);
  return deletes.subscribe(function(f) {
    var outFile;
    outFile = transformPath(f, from, options);
    return deleteFile(outFile);
  }, function(e) {
    return log("warn", "File watching errors: " + e);
  });
};

copyFile = function(file, from, options) {
  return fs.readFile(file, function(err, data) {
    var dirname, outFile;
    if (err) {
      log("error", "Error reading file [[ " + file + " ]], " + err);
      return;
    }
    console.log("file: " + file);
    outFile = transformPath(file, from, options);
    console.log("outFile: " + outFile);
    dirname = path.dirname(outFile);
    if (!fs.existsSync(dirname)) {
      wrench.mkdirSyncRecursive(dirname, 0x1ff);
    }
    return fs.writeFile(outFile, data, function(err) {
      if (err) {
        return log("error", "Error reading file [[ " + file + " ]], " + err);
      } else {
        return log("success", "File copied to destination [[ " + outFile + " ]].");
      }
    });
  });
};

deleteFileSync = function(file) {
  if (fs.existsSync(file)) {
    fs.unlinkSync(file);
    return log("success", "File [[ " + file + " ]] deleted.");
  }
};

deleteFile = function(file) {
  return fs.exists(file, function(exists) {
    if (exists) {
      return fs.unlink(file, function(err) {
        if (err) {
          return log("error", "Error deleting file [[ " + file + " ]], " + err);
        } else {
          return log("success", "File [[ " + file + " ]] deleted.");
        }
      });
    }
  });
};

deleteDirectory = function(dir, cb) {
  if (fs.existsSync(dir)) {
    return fs.rmdir(dir, function(err) {
      if ((err != null ? err.code : void 0) === !"ENOTEMPTY") {
        log("error", "Unable to delete directory [[ " + dir + " ]]");
        log("error", err);
      } else {
        log("info", "Deleted empty directory [[ " + dir + " ]]");
      }
      if (cb) {
        return cb();
      }
    });
  } else {
    if (cb) {
      return cb();
    }
  }
};

transformPath = function(file, from, _arg) {
  var conventions, fixPath, result, sourceDir;
  sourceDir = _arg.sourceDir, conventions = _arg.conventions;
  fixPath = withoutPath(from);
  result = _.reduce(conventions, function(acc, _arg1) {
    var ext, match, transform;
    match = _arg1.match, transform = _arg1.transform;
    ext = path.extname(acc);
    if (match(acc, ext)) {
      return transform(acc, path);
    } else {
      return acc;
    }
  }, fixPath(file));
  return path.join(sourceDir, result);
};

excludeStrategies = {
  string: {
    identity: _.isString,
    predicate: function(ex, path) {
      return path.indexOf(ex) === 0;
    }
  },
  regex: {
    identity: _.isRegExp,
    predicate: function(ex, path) {
      return ex.test(path);
    }
  }
};

isExcludedByConfig = function(path, excludes) {
  var ofType;
  ofType = function(method) {
    return excludes.filter(function(f) {
      return method(f);
    });
  };
  return _.any(excludeStrategies, function(_arg) {
    var identity, predicate;
    identity = _arg.identity, predicate = _arg.predicate;
    return _.any(ofType(identity), function(ex) {
      return predicate(ex, path);
    });
  });
};

parseXml = function(content) {
  var result;
  result = {};
  parseString(content, function(err, output) {
    return result = output;
  });
  return result;
};

findBottles = function(sourceDir) {
  var bottles, data, encoding, linksFile, linksXml, _ref;
  linksFile = path.join(sourceDir, ".links");
  if (fs.existsSync(linksFile)) {
    encoding = "utf8";
    data = fs.readFileSync(linksFile, {
      encoding: encoding
    });
    linksXml = parseXml(data);
    bottles = (linksXml != null ? (_ref = linksXml.links) != null ? _ref.include : void 0 : void 0) || [];
    if (!(bottles && _.isArray(bottles))) {
      log("error", ".links file not valid");
      return;
    }
    return bottles;
  } else {
    return [];
  }
};

buildExtensions = function(config) {
  var copy, css, extensions, javascript, _ref;
  _ref = config.extensions, copy = _ref.copy, javascript = _ref.javascript, css = _ref.css;
  return extensions = _.union(copy, javascript, css);
};

importAssets = function(mimosaConfig, options, next) {
  var compiledDir, conventions, excludePaths, extensions, importFrom, isBuild, sourceDir, targets, _ref;
  console.log("importing assets");
  _ref = mimosaConfig.fubumvc, excludePaths = _ref.excludePaths, sourceDir = _ref.sourceDir, compiledDir = _ref.compiledDir, isBuild = _ref.isBuild, conventions = _ref.conventions;
  extensions = buildExtensions(mimosaConfig);
  log("debug", "importing assets");
  log("debug", "allowed extensions [[ " + extensions + " ]]");
  log("debug", "excludePaths [[ " + excludePaths + " ]]");
  importFrom = function(target) {
    var fileWatcher;
    fileWatcher = prepareFileWatcher(target, extensions, excludePaths, isBuild);
    return startWatching(target, fileWatcher, {
      sourceDir: sourceDir,
      conventions: conventions
    }, next);
  };
  targets = getTargets(cwd);
  _.each(targets, function(target) {
    return importFrom(target);
  });
};

getTargets = function(dir) {
  var bottles, targets;
  bottles = _.map(findBottles(dir), function(bottle) {
    return path.resolve(dir, bottle);
  });
  return targets = [].concat(bottles, [dir]);
};

cleanAssets = function(mimosaConfig, options, next) {
  var allTargetFiles, compiledDir, conventions, excludePaths, extensions, filesFor, finish, isBuild, remainingTargets, sourceDir, targets, trackCompletion, _ref;
  _ref = mimosaConfig.fubumvc, extensions = _ref.extensions, excludePaths = _ref.excludePaths, sourceDir = _ref.sourceDir, compiledDir = _ref.compiledDir, isBuild = _ref.isBuild, conventions = _ref.conventions;
  extensions = buildExtensions(mimosaConfig);
  options = {
    sourceDir: sourceDir,
    conventions: conventions
  };
  filesFor = function(target) {
    var files, outputFiles;
    files = findSourceFiles(target, extensions, excludePaths);
    outputFiles = _.map(files, function(f) {
      return transformPath(f, target, options);
    });
    return [target, files, outputFiles];
  };
  targets = getTargets(cwd);
  allTargetFiles = _.map(targets, filesFor);
  trackCompletion = function(initial, cb) {
    var done, remaining;
    remaining = [].concat(initial);
    done = function(dir) {
      remaining = _.without(remaining, dir);
      if (remaining.length === 0) {
        return cb();
      }
    };
    return done;
  };
  remainingTargets = [].concat(targets);
  finish = trackCompletion(targets, next);
  _.each(allTargetFiles, function(_arg) {
    var files, outputFiles, target;
    target = _arg[0], files = _arg[1], outputFiles = _arg[2];
    return clean([target, files, outputFiles], function() {
      return finish(target);
    });
  });
};

trackCompletion = function(initial, cb) {
  var done, remaining;
  remaining = [].concat(initial);
  done = function(dir) {
    remaining = _.without(remaining, dir);
    if (remaining.length === 0) {
      return cb();
    }
  };
  return done;
};

clean = function(_arg, cb) {
  var dirs, done, files, outputFiles, target;
  target = _arg[0], files = _arg[1], outputFiles = _arg[2];
  _.each(outputFiles, function(f) {
    return deleteFileSync(f);
  });
  dirs = _(outputFiles).map(function(f) {
    return path.dirname(f);
  }).sortBy("length").reverse().value();
  done = trackCompletion(dirs, cb);
  return _(dirs).map(function(dir) {
    return [
      dir, function() {
        return done(dir);
      }
    ];
  }).each(function(_arg1) {
    var cb, dir;
    dir = _arg1[0], cb = _arg1[1];
    return deleteDirectory(dir, cb);
  });
};

module.exports = {
  importAssets: importAssets,
  cleanAssets: cleanAssets
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYzpcXGhvbWVcXGdpdGh1YlxcZGVsZXRlTWVcXG1pbW9zYS1mdWJ1bXZjXFxsaWJcXGZ1YnUtaW1wb3J0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiYzpcXGhvbWVcXGdpdGh1YlxcZGVsZXRlTWVcXG1pbW9zYS1mdWJ1bXZjXFxzcmNcXGZ1YnUtaW1wb3J0LmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxZQUFBLENBQUE7QUFBQSxJQUFBLGdXQUFBOztBQUFBLE1BRVEsT0FBQSxDQUFRLFFBQVIsRUFBUCxHQUZELENBQUE7O0FBQUEsS0FHQSxHQUFRLE9BQUEsQ0FBUSxZQUFSLENBQXFCLENBQUMsR0FIOUIsQ0FBQTs7QUFBQSxFQUlBLEdBQUssT0FBQSxDQUFRLElBQVIsQ0FKTCxDQUFBOztBQUFBLElBS0EsR0FBTyxPQUFBLENBQVEsTUFBUixDQUxQLENBQUE7O0FBQUEsS0FNQSxHQUFRLE9BQUEsQ0FBUSxVQUFSLENBTlIsQ0FBQTs7QUFBQSxNQU9BLEdBQVMsT0FBQSxDQUFRLFFBQVIsQ0FQVCxDQUFBOztBQUFBLENBUUEsR0FBSSxPQUFBLENBQVEsUUFBUixDQVJKLENBQUE7O0FBQUEsV0FTQSxHQUFjLE9BQUEsQ0FBUSxRQUFSLENBQWlCLENBQUMsV0FUaEMsQ0FBQTs7QUFBQSxHQVVBLEdBQU0sT0FBTyxDQUFDLEdBQVIsQ0FBQSxDQVZOLENBQUE7O0FBQUEsRUFXQSxHQUFLLE9BQUEsQ0FBUSxJQUFSLENBWEwsQ0FBQTs7QUFBQSxlQWFBLEdBQWtCLFNBQUMsSUFBRCxFQUFPLFVBQVAsRUFBbUIsUUFBbkIsR0FBQTtTQUNoQixNQUFNLENBQUMsb0JBQVAsQ0FBNEIsSUFBNUIsQ0FDRSxDQUFDLE1BREgsQ0FDVSxTQUFDLENBQUQsR0FBQTtBQUNOLFFBQUEsZ0NBQUE7QUFBQSxJQUFBLFlBQUEsR0FBZSxJQUFJLENBQUMsSUFBTCxDQUFVLElBQVYsRUFBZ0IsQ0FBaEIsQ0FBZixDQUFBO0FBQUEsSUFDQSxNQUFBLEdBQVMsRUFBRSxDQUFDLFFBQUgsQ0FBWSxZQUFaLENBQXlCLENBQUMsTUFBMUIsQ0FBQSxDQURULENBQUE7QUFBQSxJQUVBLFVBQUEsR0FBYSxhQUFBLENBQWMsQ0FBZCxFQUFpQixNQUFqQixFQUF5QixVQUF6QixFQUFxQyxRQUFyQyxDQUZiLENBQUE7V0FHQSxVQUFBLElBQWUsT0FKVDtFQUFBLENBRFYsQ0FNRSxDQUFDLEdBTkgsQ0FNTyxTQUFDLENBQUQsR0FBQTtXQUFPLElBQUksQ0FBQyxJQUFMLENBQVUsSUFBVixFQUFnQixDQUFoQixFQUFQO0VBQUEsQ0FOUCxFQURnQjtBQUFBLENBYmxCLENBQUE7O0FBQUEsYUFzQkEsR0FBZ0IsU0FBQyxDQUFELEVBQUksTUFBSixFQUFZLFVBQVosRUFBd0IsUUFBeEIsR0FBQTtBQUVkLE1BQUEsdUNBQUE7QUFBQSxFQUFBLFVBQUEsR0FBYSxVQUFVLENBQUMsR0FBWCxDQUFlLFNBQUMsR0FBRCxHQUFBO1dBQVUsR0FBQSxHQUFFLElBQVo7RUFBQSxDQUFmLENBQWIsQ0FBQTtBQUFBLEVBQ0EsR0FBQSxHQUFNLElBQUksQ0FBQyxPQUFMLENBQWEsQ0FBYixDQUROLENBQUE7QUFBQSxFQUVBLGdCQUFBLEdBQW1CLENBQUEsTUFBQSxJQUFjLENBQUMsQ0FBQyxRQUFGLENBQVcsVUFBWCxFQUF1QixHQUF2QixDQUZqQyxDQUFBO0FBQUEsRUFHQSxNQUFBLEdBQVMsTUFBQSxJQUFXLENBQUMsQ0FBQyxPQUFGLENBQVUsSUFBSSxDQUFDLEdBQWYsQ0FBQSxLQUF1QixDQUFBLENBSDNDLENBQUE7QUFBQSxFQUlBLFFBQUEsR0FBVyxrQkFBQSxDQUFtQixDQUFuQixFQUFzQixRQUF0QixDQUpYLENBQUE7U0FLQSxnQkFBQSxJQUFxQixDQUFBLFFBQXJCLElBQXNDLENBQUEsT0FQeEI7QUFBQSxDQXRCaEIsQ0FBQTs7QUFBQSxXQStCQSxHQUFjLFNBQUMsUUFBRCxHQUFBO1NBQ1osU0FBQyxLQUFELEdBQUE7V0FBVyxLQUFLLENBQUMsT0FBTixDQUFjLEVBQUEsR0FBRSxRQUFGLEdBQWEsSUFBSSxDQUFDLEdBQWhDLEVBQXdDLEVBQXhDLEVBQVg7RUFBQSxFQURZO0FBQUEsQ0EvQmQsQ0FBQTs7QUFBQSxrQkFrQ0EsR0FBcUIsU0FBQyxJQUFELEVBQU8sVUFBUCxFQUFtQixRQUFuQixFQUE2QixPQUE3QixHQUFBO0FBRW5CLE1BQUEsb0dBQUE7QUFBQSxFQUFBLEtBQUEsR0FBUyxlQUFBLENBQWdCLElBQWhCLEVBQXNCLFVBQXRCLEVBQWtDLFFBQWxDLENBQVQsQ0FBQTtBQUFBLEVBQ0EsYUFBQSxHQUFpQixLQUFLLENBQUMsTUFEdkIsQ0FBQTtBQUFBLEVBRUEsT0FBQSxHQUFVLFdBQUEsQ0FBWSxJQUFaLENBRlYsQ0FBQTtBQUFBLEVBSUEsYUFBQSxHQUNFO0FBQUEsSUFBQSxPQUFBLEVBQVMsU0FBQyxJQUFELEdBQUE7QUFDUCxVQUFBLFNBQUE7QUFBQSxNQUFBLE1BQUEsR0FBUyxFQUFFLENBQUMsUUFBSCxDQUFZLElBQVosQ0FBaUIsQ0FBQyxNQUFsQixDQUFBLENBQVQsQ0FBQTtBQUFBLE1BQ0EsQ0FBQSxHQUFJLE9BQUEsQ0FBUSxJQUFSLENBREosQ0FBQTthQUVBLENBQUEsQ0FBSyxhQUFBLENBQWMsQ0FBZCxFQUFpQixNQUFqQixFQUF5QixVQUF6QixFQUFxQyxRQUFyQyxDQUFELEVBSEc7SUFBQSxDQUFUO0FBQUEsSUFJQSxVQUFBLEVBQVksQ0FBQSxPQUpaO0FBQUEsSUFLQSxVQUFBLEVBQVksSUFMWjtBQUFBLElBTUEsUUFBQSxFQUFVLEdBTlY7QUFBQSxJQU9BLGNBQUEsRUFBZ0IsSUFQaEI7R0FMRixDQUFBO0FBQUEsRUFjQSxhQUFBLEdBQWdCLFNBQUMsS0FBRCxHQUFBO1dBQ2QsRUFBRSxDQUFDLFVBQVUsQ0FBQyxTQUFkLENBQXdCLE9BQXhCLEVBQWlDLEtBQWpDLEVBRGM7RUFBQSxDQWRoQixDQUFBO0FBQUEsRUFpQkEsT0FBQSxHQUFVLEtBQUssQ0FBQyxLQUFOLENBQVksSUFBWixFQUFrQixhQUFsQixDQWpCVixDQUFBO0FBQUEsRUFrQkEsSUFBQSxHQUFPLGFBQUEsQ0FBYyxLQUFkLENBbEJQLENBQUE7QUFBQSxFQW1CQSxPQUFBLEdBQVUsYUFBQSxDQUFjLFFBQWQsQ0FuQlYsQ0FBQTtBQUFBLEVBb0JBLE9BQUEsR0FBVSxhQUFBLENBQWMsUUFBZCxDQXBCVixDQUFBO0FBQUEsRUFxQkEsTUFBQSxHQUFTLENBQUMsYUFBQSxDQUFjLE9BQWQsQ0FBRCxDQUF1QixDQUFDLFVBQXhCLENBQW1DLFNBQUMsQ0FBRCxHQUFBO1dBQU8sRUFBRSxDQUFDLFVBQVUsQ0FBQyxPQUFELENBQWIsQ0FBb0IsQ0FBcEIsRUFBUDtFQUFBLENBQW5DLENBckJULENBQUE7U0FzQkE7QUFBQSxJQUFDLGVBQUEsYUFBRDtBQUFBLElBQWdCLE1BQUEsSUFBaEI7QUFBQSxJQUFzQixTQUFBLE9BQXRCO0FBQUEsSUFBK0IsU0FBQSxPQUEvQjtBQUFBLElBQXdDLFFBQUEsTUFBeEM7SUF4Qm1CO0FBQUEsQ0FsQ3JCLENBQUE7O0FBQUEsYUE0REEsR0FBZ0IsU0FDZCxJQURjLEVBRWQsSUFGYyxFQUdkLE9BSGMsRUFJZCxFQUpjLEdBQUE7QUFNZCxNQUFBLCtFQUFBO0FBQUEsRUFKQyxxQkFBQSxlQUFlLFlBQUEsTUFBTSxlQUFBLFNBQVMsZUFBQSxTQUFTLGNBQUEsTUFJeEMsQ0FBQTtBQUFBLEVBQUEsVUFBQSxHQUFhLFNBQUMsR0FBRCxHQUFBO1dBQ1gsR0FBRyxDQUFDLEtBQUosQ0FBVSxNQUFWLEVBRFc7RUFBQSxDQUFiLENBQUE7QUFBQSxFQUdBLFdBQUEsR0FBYyxVQUFBLENBQVcsSUFBWCxDQUFnQixDQUFDLElBQWpCLENBQXNCLGFBQXRCLENBSGQsQ0FBQTtBQUFBLEVBS0EsV0FBVyxDQUFDLFNBQVosQ0FDRSxTQUFDLENBQUQsR0FBQTtXQUNFLFFBQUEsQ0FBUyxDQUFULEVBQVksSUFBWixFQUFrQixPQUFsQixFQURGO0VBQUEsQ0FERixFQUdFLFNBQUMsQ0FBRCxHQUFBO0FBQ0UsSUFBQSxHQUFBLENBQUksTUFBSixFQUFhLHVCQUFBLEdBQXNCLENBQW5DLENBQUEsQ0FBQTtBQUNBLElBQUEsSUFBUSxFQUFSO2FBQUEsRUFBQSxDQUFBLEVBQUE7S0FGRjtFQUFBLENBSEYsRUFNRSxTQUFBLEdBQUE7QUFDRSxRQUFBLFdBQUE7QUFBQSxJQUFBLFdBQUEsR0FBYyxVQUFBLENBQVcsSUFBSSxDQUFDLEtBQUwsQ0FBVyxPQUFYLENBQVgsQ0FBZCxDQUFBO0FBQUEsSUFDQSxXQUFXLENBQUMsU0FBWixDQUNFLFNBQUMsQ0FBRCxHQUFBO2FBQU8sUUFBQSxDQUFTLENBQVQsRUFBWSxJQUFaLEVBQWtCLE9BQWxCLEVBQVA7SUFBQSxDQURGLEVBRUUsU0FBQyxDQUFELEdBQUE7YUFBTyxHQUFBLENBQUksTUFBSixFQUFhLHVCQUFBLEdBQXNCLENBQW5DLEVBQVA7SUFBQSxDQUZGLENBREEsQ0FBQTtBQUtBLElBQUEsSUFBUSxFQUFSO2FBQUEsRUFBQSxDQUFBLEVBQUE7S0FORjtFQUFBLENBTkYsQ0FMQSxDQUFBO0FBQUEsRUFvQkEsT0FBQSxHQUFVLFVBQUEsQ0FBVyxPQUFYLENBcEJWLENBQUE7U0FzQkEsT0FBTyxDQUFDLFNBQVIsQ0FDRSxTQUFDLENBQUQsR0FBQTtBQUNFLFFBQUEsT0FBQTtBQUFBLElBQUEsT0FBQSxHQUFVLGFBQUEsQ0FBYyxDQUFkLEVBQWlCLElBQWpCLEVBQXVCLE9BQXZCLENBQVYsQ0FBQTtXQUNBLFVBQUEsQ0FBVyxPQUFYLEVBRkY7RUFBQSxDQURGLEVBSUUsU0FBQyxDQUFELEdBQUE7V0FBTyxHQUFBLENBQUksTUFBSixFQUFhLHdCQUFBLEdBQXVCLENBQXBDLEVBQVA7RUFBQSxDQUpGLEVBNUJjO0FBQUEsQ0E1RGhCLENBQUE7O0FBQUEsUUErRkEsR0FBVyxTQUFDLElBQUQsRUFBTyxJQUFQLEVBQWEsT0FBYixHQUFBO1NBQ1QsRUFBRSxDQUFDLFFBQUgsQ0FBWSxJQUFaLEVBQWtCLFNBQUMsR0FBRCxFQUFNLElBQU4sR0FBQTtBQUNoQixRQUFBLGdCQUFBO0FBQUEsSUFBQSxJQUFHLEdBQUg7QUFDRSxNQUFBLEdBQUEsQ0FBSSxPQUFKLEVBQWMsd0JBQUEsR0FBdUIsSUFBdkIsR0FBNkIsT0FBN0IsR0FBbUMsR0FBakQsQ0FBQSxDQUFBO0FBQ0EsWUFBQSxDQUZGO0tBQUE7QUFBQSxJQUlBLE9BQU8sQ0FBQyxHQUFSLENBQWEsUUFBQSxHQUFPLElBQXBCLENBSkEsQ0FBQTtBQUFBLElBS0EsT0FBQSxHQUFVLGFBQUEsQ0FBYyxJQUFkLEVBQW9CLElBQXBCLEVBQTBCLE9BQTFCLENBTFYsQ0FBQTtBQUFBLElBTUEsT0FBTyxDQUFDLEdBQVIsQ0FBYSxXQUFBLEdBQVUsT0FBdkIsQ0FOQSxDQUFBO0FBQUEsSUFRQSxPQUFBLEdBQVUsSUFBSSxDQUFDLE9BQUwsQ0FBYSxPQUFiLENBUlYsQ0FBQTtBQVNBLElBQUEsSUFBQSxDQUFBLEVBQVMsQ0FBQyxVQUFILENBQWMsT0FBZCxDQUFQO0FBQ0UsTUFBQSxNQUFNLENBQUMsa0JBQVAsQ0FBMEIsT0FBMUIsRUFBbUMsS0FBbkMsQ0FBQSxDQURGO0tBVEE7V0FZQSxFQUFFLENBQUMsU0FBSCxDQUFhLE9BQWIsRUFBc0IsSUFBdEIsRUFBNEIsU0FBQyxHQUFELEdBQUE7QUFDMUIsTUFBQSxJQUFHLEdBQUg7ZUFDRSxHQUFBLENBQUksT0FBSixFQUFjLHdCQUFBLEdBQXVCLElBQXZCLEdBQTZCLE9BQTdCLEdBQW1DLEdBQWpELEVBREY7T0FBQSxNQUFBO2VBR0UsR0FBQSxDQUFJLFNBQUosRUFBZ0IsZ0NBQUEsR0FBK0IsT0FBL0IsR0FBd0MsTUFBeEQsRUFIRjtPQUQwQjtJQUFBLENBQTVCLEVBYmdCO0VBQUEsQ0FBbEIsRUFEUztBQUFBLENBL0ZYLENBQUE7O0FBQUEsY0FtSEEsR0FBaUIsU0FBQyxJQUFELEdBQUE7QUFDZixFQUFBLElBQUcsRUFBRSxDQUFDLFVBQUgsQ0FBYyxJQUFkLENBQUg7QUFDRSxJQUFBLEVBQUUsQ0FBQyxVQUFILENBQWMsSUFBZCxDQUFBLENBQUE7V0FDQSxHQUFBLENBQUksU0FBSixFQUFnQixVQUFBLEdBQVMsSUFBVCxHQUFlLGNBQS9CLEVBRkY7R0FEZTtBQUFBLENBbkhqQixDQUFBOztBQUFBLFVBd0hBLEdBQWEsU0FBQyxJQUFELEdBQUE7U0FDWCxFQUFFLENBQUMsTUFBSCxDQUFVLElBQVYsRUFBZ0IsU0FBQyxNQUFELEdBQUE7QUFDZCxJQUFBLElBQUcsTUFBSDthQUNFLEVBQUUsQ0FBQyxNQUFILENBQVUsSUFBVixFQUFnQixTQUFDLEdBQUQsR0FBQTtBQUNkLFFBQUEsSUFBRyxHQUFIO2lCQUNFLEdBQUEsQ0FBSSxPQUFKLEVBQWMseUJBQUEsR0FBd0IsSUFBeEIsR0FBOEIsT0FBOUIsR0FBb0MsR0FBbEQsRUFERjtTQUFBLE1BQUE7aUJBR0UsR0FBQSxDQUFJLFNBQUosRUFBZ0IsVUFBQSxHQUFTLElBQVQsR0FBZSxjQUEvQixFQUhGO1NBRGM7TUFBQSxDQUFoQixFQURGO0tBRGM7RUFBQSxDQUFoQixFQURXO0FBQUEsQ0F4SGIsQ0FBQTs7QUFBQSxlQWlJQSxHQUFrQixTQUFDLEdBQUQsRUFBTSxFQUFOLEdBQUE7QUFDaEIsRUFBQSxJQUFHLEVBQUUsQ0FBQyxVQUFILENBQWMsR0FBZCxDQUFIO1dBQ0UsRUFBRSxDQUFDLEtBQUgsQ0FBUyxHQUFULEVBQWMsU0FBQyxHQUFELEdBQUE7QUFDWixNQUFBLG1CQUFHLEdBQUcsQ0FBRSxjQUFMLEtBQWEsQ0FBQSxXQUFoQjtBQUNFLFFBQUEsR0FBQSxDQUFJLE9BQUosRUFBYyxnQ0FBQSxHQUErQixHQUEvQixHQUFvQyxLQUFsRCxDQUFBLENBQUE7QUFBQSxRQUNBLEdBQUEsQ0FBSSxPQUFKLEVBQWEsR0FBYixDQURBLENBREY7T0FBQSxNQUFBO0FBSUUsUUFBQSxHQUFBLENBQUksTUFBSixFQUFhLDZCQUFBLEdBQTRCLEdBQTVCLEdBQWlDLEtBQTlDLENBQUEsQ0FKRjtPQUFBO0FBS0EsTUFBQSxJQUFRLEVBQVI7ZUFBQSxFQUFBLENBQUEsRUFBQTtPQU5ZO0lBQUEsQ0FBZCxFQURGO0dBQUEsTUFBQTtBQVFLLElBQUEsSUFBUSxFQUFSO2FBQUEsRUFBQSxDQUFBLEVBQUE7S0FSTDtHQURnQjtBQUFBLENBaklsQixDQUFBOztBQUFBLGFBNElBLEdBQWdCLFNBQUMsSUFBRCxFQUFPLElBQVAsRUFBYSxJQUFiLEdBQUE7QUFDZCxNQUFBLHVDQUFBO0FBQUEsRUFENEIsaUJBQUEsV0FBVyxtQkFBQSxXQUN2QyxDQUFBO0FBQUEsRUFBQSxPQUFBLEdBQVUsV0FBQSxDQUFZLElBQVosQ0FBVixDQUFBO0FBQUEsRUFDQSxNQUFBLEdBQVMsQ0FBQyxDQUFDLE1BQUYsQ0FBUyxXQUFULEVBQXNCLFNBQUMsR0FBRCxFQUFNLEtBQU4sR0FBQTtBQUM3QixRQUFBLHFCQUFBO0FBQUEsSUFEb0MsY0FBQSxPQUFPLGtCQUFBLFNBQzNDLENBQUE7QUFBQSxJQUFBLEdBQUEsR0FBTSxJQUFJLENBQUMsT0FBTCxDQUFhLEdBQWIsQ0FBTixDQUFBO0FBQ0EsSUFBQSxJQUFHLEtBQUEsQ0FBTSxHQUFOLEVBQVcsR0FBWCxDQUFIO2FBQXVCLFNBQUEsQ0FBVSxHQUFWLEVBQWUsSUFBZixFQUF2QjtLQUFBLE1BQUE7YUFBZ0QsSUFBaEQ7S0FGNkI7RUFBQSxDQUF0QixFQUdQLE9BQUEsQ0FBUSxJQUFSLENBSE8sQ0FEVCxDQUFBO1NBS0EsSUFBSSxDQUFDLElBQUwsQ0FBVSxTQUFWLEVBQXFCLE1BQXJCLEVBTmM7QUFBQSxDQTVJaEIsQ0FBQTs7QUFBQSxpQkFvSkEsR0FDRTtBQUFBLEVBQUEsTUFBQSxFQUNFO0FBQUEsSUFBQSxRQUFBLEVBQVUsQ0FBQyxDQUFDLFFBQVo7QUFBQSxJQUNBLFNBQUEsRUFBVyxTQUFDLEVBQUQsRUFBSyxJQUFMLEdBQUE7YUFBYyxJQUFJLENBQUMsT0FBTCxDQUFhLEVBQWIsQ0FBQSxLQUFvQixFQUFsQztJQUFBLENBRFg7R0FERjtBQUFBLEVBR0EsS0FBQSxFQUNFO0FBQUEsSUFBQSxRQUFBLEVBQVUsQ0FBQyxDQUFDLFFBQVo7QUFBQSxJQUNBLFNBQUEsRUFBVyxTQUFDLEVBQUQsRUFBSyxJQUFMLEdBQUE7YUFBYyxFQUFFLENBQUMsSUFBSCxDQUFRLElBQVIsRUFBZDtJQUFBLENBRFg7R0FKRjtDQXJKRixDQUFBOztBQUFBLGtCQTRKQSxHQUFxQixTQUFDLElBQUQsRUFBTyxRQUFQLEdBQUE7QUFDbkIsTUFBQSxNQUFBO0FBQUEsRUFBQSxNQUFBLEdBQVMsU0FBQyxNQUFELEdBQUE7V0FDUCxRQUFRLENBQUMsTUFBVCxDQUFnQixTQUFDLENBQUQsR0FBQTthQUFPLE1BQUEsQ0FBTyxDQUFQLEVBQVA7SUFBQSxDQUFoQixFQURPO0VBQUEsQ0FBVCxDQUFBO1NBR0EsQ0FBQyxDQUFDLEdBQUYsQ0FBTSxpQkFBTixFQUF5QixTQUFDLElBQUQsR0FBQTtBQUN2QixRQUFBLG1CQUFBO0FBQUEsSUFEeUIsZ0JBQUEsVUFBVSxpQkFBQSxTQUNuQyxDQUFBO1dBQUEsQ0FBQyxDQUFDLEdBQUYsQ0FBTyxNQUFBLENBQU8sUUFBUCxDQUFQLEVBQXlCLFNBQUMsRUFBRCxHQUFBO2FBQVEsU0FBQSxDQUFVLEVBQVYsRUFBYyxJQUFkLEVBQVI7SUFBQSxDQUF6QixFQUR1QjtFQUFBLENBQXpCLEVBSm1CO0FBQUEsQ0E1SnJCLENBQUE7O0FBQUEsUUFtS0EsR0FBVyxTQUFDLE9BQUQsR0FBQTtBQUNULE1BQUEsTUFBQTtBQUFBLEVBQUEsTUFBQSxHQUFTLEVBQVQsQ0FBQTtBQUFBLEVBQ0EsV0FBQSxDQUFZLE9BQVosRUFBcUIsU0FBQyxHQUFELEVBQU0sTUFBTixHQUFBO1dBQ25CLE1BQUEsR0FBUyxPQURVO0VBQUEsQ0FBckIsQ0FEQSxDQUFBO1NBR0EsT0FKUztBQUFBLENBbktYLENBQUE7O0FBQUEsV0F5S0EsR0FBYyxTQUFDLFNBQUQsR0FBQTtBQUNaLE1BQUEsa0RBQUE7QUFBQSxFQUFBLFNBQUEsR0FBWSxJQUFJLENBQUMsSUFBTCxDQUFVLFNBQVYsRUFBcUIsUUFBckIsQ0FBWixDQUFBO0FBQ0EsRUFBQSxJQUFHLEVBQUUsQ0FBQyxVQUFILENBQWMsU0FBZCxDQUFIO0FBQ0UsSUFBQSxRQUFBLEdBQVcsTUFBWCxDQUFBO0FBQUEsSUFDQSxJQUFBLEdBQU8sRUFBRSxDQUFDLFlBQUgsQ0FBZ0IsU0FBaEIsRUFBMkI7QUFBQSxNQUFDLFVBQUEsUUFBRDtLQUEzQixDQURQLENBQUE7QUFBQSxJQUVBLFFBQUEsR0FBVyxRQUFBLENBQVMsSUFBVCxDQUZYLENBQUE7QUFBQSxJQUdBLE9BQUEsNkRBQXlCLENBQUUsMEJBQWpCLElBQTRCLEVBSHRDLENBQUE7QUFJQSxJQUFBLElBQUEsQ0FBQSxDQUFPLE9BQUEsSUFBWSxDQUFDLENBQUMsT0FBRixDQUFVLE9BQVYsQ0FBbkIsQ0FBQTtBQUNFLE1BQUEsR0FBQSxDQUFJLE9BQUosRUFBYSx1QkFBYixDQUFBLENBQUE7QUFDQSxZQUFBLENBRkY7S0FKQTtXQVFBLFFBVEY7R0FBQSxNQUFBO1dBV0UsR0FYRjtHQUZZO0FBQUEsQ0F6S2QsQ0FBQTs7QUFBQSxlQXdMQSxHQUFrQixTQUFDLE1BQUQsR0FBQTtBQUNoQixNQUFBLHVDQUFBO0FBQUEsRUFBQSxPQUEwQixNQUFNLENBQUMsVUFBakMsRUFBQyxZQUFBLElBQUQsRUFBTyxrQkFBQSxVQUFQLEVBQW1CLFdBQUEsR0FBbkIsQ0FBQTtTQUNBLFVBQUEsR0FBYSxDQUFDLENBQUMsS0FBRixDQUFRLElBQVIsRUFBYyxVQUFkLEVBQTBCLEdBQTFCLEVBRkc7QUFBQSxDQXhMbEIsQ0FBQTs7QUFBQSxZQTRMQSxHQUFlLFNBQUMsWUFBRCxFQUFlLE9BQWYsRUFBd0IsSUFBeEIsR0FBQTtBQUNiLE1BQUEsaUdBQUE7QUFBQSxFQUFBLE9BQU8sQ0FBQyxHQUFSLENBQVksa0JBQVosQ0FBQSxDQUFBO0FBQUEsRUFDQSxPQUNFLFlBQVksQ0FBQyxPQURmLEVBQUMsb0JBQUEsWUFBRCxFQUFlLGlCQUFBLFNBQWYsRUFBMEIsbUJBQUEsV0FBMUIsRUFBdUMsZUFBQSxPQUF2QyxFQUFnRCxtQkFBQSxXQURoRCxDQUFBO0FBQUEsRUFJQSxVQUFBLEdBQWEsZUFBQSxDQUFnQixZQUFoQixDQUpiLENBQUE7QUFBQSxFQU1BLEdBQUEsQ0FBSSxPQUFKLEVBQWEsa0JBQWIsQ0FOQSxDQUFBO0FBQUEsRUFPQSxHQUFBLENBQUksT0FBSixFQUFjLHdCQUFBLEdBQXVCLFVBQXZCLEdBQW1DLEtBQWpELENBUEEsQ0FBQTtBQUFBLEVBUUEsR0FBQSxDQUFJLE9BQUosRUFBYyxrQkFBQSxHQUFpQixZQUFqQixHQUErQixLQUE3QyxDQVJBLENBQUE7QUFBQSxFQVVBLFVBQUEsR0FBYSxTQUFDLE1BQUQsR0FBQTtBQUNYLFFBQUEsV0FBQTtBQUFBLElBQUEsV0FBQSxHQUFjLGtCQUFBLENBQW1CLE1BQW5CLEVBQTJCLFVBQTNCLEVBQXVDLFlBQXZDLEVBQXFELE9BQXJELENBQWQsQ0FBQTtXQUNBLGFBQUEsQ0FBYyxNQUFkLEVBQXNCLFdBQXRCLEVBQW1DO0FBQUEsTUFBQyxXQUFBLFNBQUQ7QUFBQSxNQUFZLGFBQUEsV0FBWjtLQUFuQyxFQUE2RCxJQUE3RCxFQUZXO0VBQUEsQ0FWYixDQUFBO0FBQUEsRUFjQSxPQUFBLEdBQVUsVUFBQSxDQUFXLEdBQVgsQ0FkVixDQUFBO0FBQUEsRUFnQkEsQ0FBQyxDQUFDLElBQUYsQ0FBTyxPQUFQLEVBQWdCLFNBQUMsTUFBRCxHQUFBO1dBQVksVUFBQSxDQUFXLE1BQVgsRUFBWjtFQUFBLENBQWhCLENBaEJBLENBRGE7QUFBQSxDQTVMZixDQUFBOztBQUFBLFVBZ05BLEdBQWEsU0FBQyxHQUFELEdBQUE7QUFDWCxNQUFBLGdCQUFBO0FBQUEsRUFBQSxPQUFBLEdBQVUsQ0FBQyxDQUFDLEdBQUYsQ0FBTyxXQUFBLENBQVksR0FBWixDQUFQLEVBQXlCLFNBQUMsTUFBRCxHQUFBO1dBQVksSUFBSSxDQUFDLE9BQUwsQ0FBYSxHQUFiLEVBQWtCLE1BQWxCLEVBQVo7RUFBQSxDQUF6QixDQUFWLENBQUE7U0FDQSxPQUFBLEdBQVUsRUFBRSxDQUFDLE1BQUgsQ0FBVSxPQUFWLEVBQW1CLENBQUMsR0FBRCxDQUFuQixFQUZDO0FBQUEsQ0FoTmIsQ0FBQTs7QUFBQSxXQW9OQSxHQUFjLFNBQUMsWUFBRCxFQUFlLE9BQWYsRUFBd0IsSUFBeEIsR0FBQTtBQUNaLE1BQUEsMEpBQUE7QUFBQSxFQUFBLE9BQ0UsWUFBWSxDQUFDLE9BRGYsRUFBQyxrQkFBQSxVQUFELEVBQWEsb0JBQUEsWUFBYixFQUEyQixpQkFBQSxTQUEzQixFQUFzQyxtQkFBQSxXQUF0QyxFQUFtRCxlQUFBLE9BQW5ELEVBQTRELG1CQUFBLFdBQTVELENBQUE7QUFBQSxFQUVBLFVBQUEsR0FBYSxlQUFBLENBQWdCLFlBQWhCLENBRmIsQ0FBQTtBQUFBLEVBR0EsT0FBQSxHQUFVO0FBQUEsSUFBQyxXQUFBLFNBQUQ7QUFBQSxJQUFZLGFBQUEsV0FBWjtHQUhWLENBQUE7QUFBQSxFQUtBLFFBQUEsR0FBVyxTQUFDLE1BQUQsR0FBQTtBQUNULFFBQUEsa0JBQUE7QUFBQSxJQUFBLEtBQUEsR0FBUyxlQUFBLENBQWdCLE1BQWhCLEVBQXdCLFVBQXhCLEVBQW9DLFlBQXBDLENBQVQsQ0FBQTtBQUFBLElBQ0EsV0FBQSxHQUFjLENBQUMsQ0FBQyxHQUFGLENBQU0sS0FBTixFQUFhLFNBQUMsQ0FBRCxHQUFBO2FBQU8sYUFBQSxDQUFjLENBQWQsRUFBaUIsTUFBakIsRUFBeUIsT0FBekIsRUFBUDtJQUFBLENBQWIsQ0FEZCxDQUFBO1dBRUEsQ0FBQyxNQUFELEVBQVMsS0FBVCxFQUFnQixXQUFoQixFQUhTO0VBQUEsQ0FMWCxDQUFBO0FBQUEsRUFVQSxPQUFBLEdBQVUsVUFBQSxDQUFXLEdBQVgsQ0FWVixDQUFBO0FBQUEsRUFXQSxjQUFBLEdBQWlCLENBQUMsQ0FBQyxHQUFGLENBQU0sT0FBTixFQUFlLFFBQWYsQ0FYakIsQ0FBQTtBQUFBLEVBYUEsZUFBQSxHQUFrQixTQUFDLE9BQUQsRUFBVSxFQUFWLEdBQUE7QUFDaEIsUUFBQSxlQUFBO0FBQUEsSUFBQSxTQUFBLEdBQVksRUFBRSxDQUFDLE1BQUgsQ0FBVSxPQUFWLENBQVosQ0FBQTtBQUFBLElBQ0EsSUFBQSxHQUFPLFNBQUMsR0FBRCxHQUFBO0FBQ0wsTUFBQSxTQUFBLEdBQVksQ0FBQyxDQUFDLE9BQUYsQ0FBVSxTQUFWLEVBQXFCLEdBQXJCLENBQVosQ0FBQTtBQUNBLE1BQUEsSUFBRyxTQUFTLENBQUMsTUFBVixLQUFvQixDQUF2QjtlQUNFLEVBQUEsQ0FBQSxFQURGO09BRks7SUFBQSxDQURQLENBQUE7V0FLQSxLQU5nQjtFQUFBLENBYmxCLENBQUE7QUFBQSxFQXFCQSxnQkFBQSxHQUFtQixFQUFFLENBQUMsTUFBSCxDQUFVLE9BQVYsQ0FyQm5CLENBQUE7QUFBQSxFQXVCQSxNQUFBLEdBQVMsZUFBQSxDQUFnQixPQUFoQixFQUF5QixJQUF6QixDQXZCVCxDQUFBO0FBQUEsRUF5QkEsQ0FBQyxDQUFDLElBQUYsQ0FBTyxjQUFQLEVBQXVCLFNBQUMsSUFBRCxHQUFBO0FBQ3JCLFFBQUEsMEJBQUE7QUFBQSxJQUR1QixrQkFBUSxpQkFBTyxxQkFDdEMsQ0FBQTtXQUFBLEtBQUEsQ0FBTSxDQUFDLE1BQUQsRUFBUyxLQUFULEVBQWdCLFdBQWhCLENBQU4sRUFBb0MsU0FBQSxHQUFBO2FBQU0sTUFBQSxDQUFPLE1BQVAsRUFBTjtJQUFBLENBQXBDLEVBRHFCO0VBQUEsQ0FBdkIsQ0F6QkEsQ0FEWTtBQUFBLENBcE5kLENBQUE7O0FBQUEsZUFtUEEsR0FBa0IsU0FBQyxPQUFELEVBQVUsRUFBVixHQUFBO0FBQ2hCLE1BQUEsZUFBQTtBQUFBLEVBQUEsU0FBQSxHQUFZLEVBQUUsQ0FBQyxNQUFILENBQVUsT0FBVixDQUFaLENBQUE7QUFBQSxFQUNBLElBQUEsR0FBTyxTQUFDLEdBQUQsR0FBQTtBQUNMLElBQUEsU0FBQSxHQUFZLENBQUMsQ0FBQyxPQUFGLENBQVUsU0FBVixFQUFxQixHQUFyQixDQUFaLENBQUE7QUFDQSxJQUFBLElBQUcsU0FBUyxDQUFDLE1BQVYsS0FBb0IsQ0FBdkI7YUFDRSxFQUFBLENBQUEsRUFERjtLQUZLO0VBQUEsQ0FEUCxDQUFBO1NBS0EsS0FOZ0I7QUFBQSxDQW5QbEIsQ0FBQTs7QUFBQSxLQTJQQSxHQUFRLFNBQUMsSUFBRCxFQUErQixFQUEvQixHQUFBO0FBQ04sTUFBQSxzQ0FBQTtBQUFBLEVBRFEsa0JBQVEsaUJBQU8scUJBQ3ZCLENBQUE7QUFBQSxFQUFBLENBQUMsQ0FBQyxJQUFGLENBQU8sV0FBUCxFQUFvQixTQUFDLENBQUQsR0FBQTtXQUFPLGNBQUEsQ0FBZSxDQUFmLEVBQVA7RUFBQSxDQUFwQixDQUFBLENBQUE7QUFBQSxFQUVBLElBQUEsR0FBTyxDQUFBLENBQUUsV0FBRixDQUNMLENBQUMsR0FESSxDQUNBLFNBQUMsQ0FBRCxHQUFBO1dBQU8sSUFBSSxDQUFDLE9BQUwsQ0FBYSxDQUFiLEVBQVA7RUFBQSxDQURBLENBRUwsQ0FBQyxNQUZJLENBRUcsUUFGSCxDQUdMLENBQUMsT0FISSxDQUFBLENBSUwsQ0FBQyxLQUpJLENBQUEsQ0FGUCxDQUFBO0FBQUEsRUFRQSxJQUFBLEdBQU8sZUFBQSxDQUFnQixJQUFoQixFQUFzQixFQUF0QixDQVJQLENBQUE7U0FVQSxDQUFBLENBQUUsSUFBRixDQUNFLENBQUMsR0FESCxDQUNPLFNBQUMsR0FBRCxHQUFBO1dBQVM7TUFBQyxHQUFELEVBQU0sU0FBQSxHQUFBO2VBQU0sSUFBQSxDQUFLLEdBQUwsRUFBTjtNQUFBLENBQU47TUFBVDtFQUFBLENBRFAsQ0FFRSxDQUFDLElBRkgsQ0FFUSxTQUFDLEtBQUQsR0FBQTtBQUNKLFFBQUEsT0FBQTtBQUFBLElBRE0sZ0JBQUssYUFDWCxDQUFBO1dBQUEsZUFBQSxDQUFnQixHQUFoQixFQUFxQixFQUFyQixFQURJO0VBQUEsQ0FGUixFQVhNO0FBQUEsQ0EzUFIsQ0FBQTs7QUFBQSxNQXFTTSxDQUFDLE9BQVAsR0FBaUI7QUFBQSxFQUFDLGNBQUEsWUFBRDtBQUFBLEVBQWUsYUFBQSxXQUFmO0NBclNqQixDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCJcclxuXHJcbntsb2d9ID0gcmVxdWlyZSAnLi91dGlsJ1xyXG5jb2xvciA9IHJlcXVpcmUoJ2Fuc2ktY29sb3InKS5zZXRcclxuZnMgPSByZXF1aXJlICdmcydcclxucGF0aCA9IHJlcXVpcmUgJ3BhdGgnXHJcbndhdGNoID0gcmVxdWlyZSAnY2hva2lkYXInXHJcbndyZW5jaCA9IHJlcXVpcmUgJ3dyZW5jaCdcclxuXyA9IHJlcXVpcmUgJ2xvZGFzaCdcclxucGFyc2VTdHJpbmcgPSByZXF1aXJlKCd4bWwyanMnKS5wYXJzZVN0cmluZ1xyXG5jd2QgPSBwcm9jZXNzLmN3ZCgpXHJcblJ4ID0gcmVxdWlyZSBcInJ4XCJcclxuXHJcbmZpbmRTb3VyY2VGaWxlcyA9IChmcm9tLCBleHRlbnNpb25zLCBleGNsdWRlcykgLT5cclxuICB3cmVuY2gucmVhZGRpclN5bmNSZWN1cnNpdmUoZnJvbSlcclxuICAgIC5maWx0ZXIgKGYpIC0+XHJcbiAgICAgIG9yaWdpbmFsRmlsZSA9IHBhdGguam9pbiBmcm9tLCBmXHJcbiAgICAgIGlzRmlsZSA9IGZzLnN0YXRTeW5jKG9yaWdpbmFsRmlsZSkuaXNGaWxlKClcclxuICAgICAgaXNJbmNsdWRlZCA9IHNob3VsZEluY2x1ZGUgZiwgaXNGaWxlLCBleHRlbnNpb25zLCBleGNsdWRlc1xyXG4gICAgICBpc0luY2x1ZGVkIGFuZCBpc0ZpbGVcclxuICAgIC5tYXAgKGYpIC0+IHBhdGguam9pbiBmcm9tLCBmXHJcblxyXG5zaG91bGRJbmNsdWRlID0gKGYsIGlzRmlsZSwgZXh0ZW5zaW9ucywgZXhjbHVkZXMpIC0+XHJcbiAgI1RPRE86IG9ubHkgYWRkcyB0aGUgLiB0byB5b3UgZm9yIGV4dGVuc2lvbnMgaWYgaXRzIGxlZnQgb2ZmXHJcbiAgZXh0ZW5zaW9ucyA9IGV4dGVuc2lvbnMubWFwIChleHQpIC0+IFwiLiN7ZXh0fVwiXHJcbiAgZXh0ID0gcGF0aC5leHRuYW1lIGZcclxuICBtYXRjaGVzRXh0ZW5zaW9uID0gbm90IGlzRmlsZSBvciBfLmNvbnRhaW5zIGV4dGVuc2lvbnMsIGV4dFxyXG4gIGF0Um9vdCA9IGlzRmlsZSBhbmQgZi5pbmRleE9mKHBhdGguc2VwKSA9PSAtMVxyXG4gIGV4Y2x1ZGVkID0gaXNFeGNsdWRlZEJ5Q29uZmlnIGYsIGV4Y2x1ZGVzXHJcbiAgbWF0Y2hlc0V4dGVuc2lvbiBhbmQgbm90IGV4Y2x1ZGVkIGFuZCBub3QgYXRSb290XHJcblxyXG53aXRob3V0UGF0aCA9IChmcm9tUGF0aCkgLT5cclxuICAoaW5wdXQpIC0+IGlucHV0LnJlcGxhY2UgXCIje2Zyb21QYXRofSN7cGF0aC5zZXB9XCIsICcnXHJcblxyXG5wcmVwYXJlRmlsZVdhdGNoZXIgPSAoZnJvbSwgZXh0ZW5zaW9ucywgZXhjbHVkZXMsIGlzQnVpbGQpIC0+XHJcbiAgI1RPRE86IG5vIG1vcmUgc3luYyBjYWxsc1xyXG4gIGZpbGVzICA9IGZpbmRTb3VyY2VGaWxlcyBmcm9tLCBleHRlbnNpb25zLCBleGNsdWRlc1xyXG4gIG51bWJlck9mRmlsZXMgID0gZmlsZXMubGVuZ3RoXHJcbiAgZml4UGF0aCA9IHdpdGhvdXRQYXRoIGZyb21cclxuXHJcbiAgd2F0Y2hTZXR0aW5ncyA9XHJcbiAgICBpZ25vcmVkOiAoZmlsZSkgLT5cclxuICAgICAgaXNGaWxlID0gZnMuc3RhdFN5bmMoZmlsZSkuaXNGaWxlKClcclxuICAgICAgZiA9IGZpeFBhdGggZmlsZVxyXG4gICAgICBub3QgKHNob3VsZEluY2x1ZGUgZiwgaXNGaWxlLCBleHRlbnNpb25zLCBleGNsdWRlcylcclxuICAgIHBlcnNpc3RlbnQ6IG5vdCBpc0J1aWxkXHJcbiAgICB1c2VQb2xsaW5nOiB0cnVlXHJcbiAgICBpbnRlcnZhbDogNTAwXHJcbiAgICBiaW5hcnlJbnRlcnZhbDogMTAwMFxyXG5cclxuICBvYnNlcnZhYmxlRm9yID0gKGV2ZW50KSAtPlxyXG4gICAgUnguT2JzZXJ2YWJsZS5mcm9tRXZlbnQgd2F0Y2hlciwgZXZlbnRcclxuXHJcbiAgd2F0Y2hlciA9IHdhdGNoLndhdGNoIGZyb20sIHdhdGNoU2V0dGluZ3NcclxuICBhZGRzID0gb2JzZXJ2YWJsZUZvciBcImFkZFwiXHJcbiAgY2hhbmdlcyA9IG9ic2VydmFibGVGb3IgXCJjaGFuZ2VcIlxyXG4gIHVubGlua3MgPSBvYnNlcnZhYmxlRm9yIFwidW5saW5rXCJcclxuICBlcnJvcnMgPSAob2JzZXJ2YWJsZUZvciBcImVycm9yXCIpLnNlbGVjdE1hbnkgKGUpIC0+IFJ4Lk9ic2VydmFibGUudGhyb3cgZVxyXG4gIHtudW1iZXJPZkZpbGVzLCBhZGRzLCBjaGFuZ2VzLCB1bmxpbmtzLCBlcnJvcnN9XHJcblxyXG5zdGFydFdhdGNoaW5nID0gKFxyXG4gIGZyb20sXHJcbiAge251bWJlck9mRmlsZXMsIGFkZHMsIGNoYW5nZXMsIHVubGlua3MsIGVycm9yc30sXHJcbiAgb3B0aW9ucyxcclxuICBjYikgLT5cclxuXHJcbiAgZnJvbVNvdXJjZSA9IChvYnMpIC0+XHJcbiAgICBvYnMubWVyZ2UoZXJyb3JzKVxyXG5cclxuICBpbml0aWFsQ29weSA9IGZyb21Tb3VyY2UoYWRkcykudGFrZShudW1iZXJPZkZpbGVzKVxyXG5cclxuICBpbml0aWFsQ29weS5zdWJzY3JpYmUoXHJcbiAgICAoZikgLT5cclxuICAgICAgY29weUZpbGUgZiwgZnJvbSwgb3B0aW9uc1xyXG4gICAgKGUpIC0+XHJcbiAgICAgIGxvZyBcIndhcm5cIiwgXCJGaWxlIHdhdGNoaW5nIGVycm9yOiAje2V9XCJcclxuICAgICAgY2IoKSBpZiBjYlxyXG4gICAgKCkgLT5cclxuICAgICAgb25nb2luZ0NvcHkgPSBmcm9tU291cmNlKGFkZHMubWVyZ2UgY2hhbmdlcylcclxuICAgICAgb25nb2luZ0NvcHkuc3Vic2NyaWJlKFxyXG4gICAgICAgIChmKSAtPiBjb3B5RmlsZSBmLCBmcm9tLCBvcHRpb25zXHJcbiAgICAgICAgKGUpIC0+IGxvZyBcIndhcm5cIiwgXCJGaWxlIHdhdGNoaW5nIGVycm9yOiAje2V9XCJcclxuICAgICAgKVxyXG4gICAgICBjYigpIGlmIGNiXHJcbiAgKVxyXG5cclxuICBkZWxldGVzID0gZnJvbVNvdXJjZSh1bmxpbmtzKVxyXG5cclxuICBkZWxldGVzLnN1YnNjcmliZShcclxuICAgIChmKSAtPlxyXG4gICAgICBvdXRGaWxlID0gdHJhbnNmb3JtUGF0aCBmLCBmcm9tLCBvcHRpb25zXHJcbiAgICAgIGRlbGV0ZUZpbGUgb3V0RmlsZVxyXG4gICAgKGUpIC0+IGxvZyBcIndhcm5cIiwgXCJGaWxlIHdhdGNoaW5nIGVycm9yczogI3tlfVwiXHJcbiAgKVxyXG5cclxuY29weUZpbGUgPSAoZmlsZSwgZnJvbSwgb3B0aW9ucykgLT5cclxuICBmcy5yZWFkRmlsZSBmaWxlLCAoZXJyLCBkYXRhKSAtPlxyXG4gICAgaWYgZXJyXHJcbiAgICAgIGxvZyBcImVycm9yXCIsIFwiRXJyb3IgcmVhZGluZyBmaWxlIFtbICN7ZmlsZX0gXV0sICN7ZXJyfVwiXHJcbiAgICAgIHJldHVyblxyXG5cclxuICAgIGNvbnNvbGUubG9nIFwiZmlsZTogI3tmaWxlfVwiXHJcbiAgICBvdXRGaWxlID0gdHJhbnNmb3JtUGF0aCBmaWxlLCBmcm9tLCBvcHRpb25zXHJcbiAgICBjb25zb2xlLmxvZyBcIm91dEZpbGU6ICN7b3V0RmlsZX1cIlxyXG5cclxuICAgIGRpcm5hbWUgPSBwYXRoLmRpcm5hbWUgb3V0RmlsZVxyXG4gICAgdW5sZXNzIGZzLmV4aXN0c1N5bmMgZGlybmFtZVxyXG4gICAgICB3cmVuY2gubWtkaXJTeW5jUmVjdXJzaXZlIGRpcm5hbWUsIDBvMDc3N1xyXG5cclxuICAgIGZzLndyaXRlRmlsZSBvdXRGaWxlLCBkYXRhLCAoZXJyKSAtPlxyXG4gICAgICBpZiBlcnJcclxuICAgICAgICBsb2cgXCJlcnJvclwiLCBcIkVycm9yIHJlYWRpbmcgZmlsZSBbWyAje2ZpbGV9IF1dLCAje2Vycn1cIlxyXG4gICAgICBlbHNlXHJcbiAgICAgICAgbG9nIFwic3VjY2Vzc1wiLCBcIkZpbGUgY29waWVkIHRvIGRlc3RpbmF0aW9uIFtbICN7b3V0RmlsZX0gXV0uXCJcclxuXHJcbmRlbGV0ZUZpbGVTeW5jID0gKGZpbGUpIC0+XHJcbiAgaWYgZnMuZXhpc3RzU3luYyBmaWxlXHJcbiAgICBmcy51bmxpbmtTeW5jIGZpbGVcclxuICAgIGxvZyBcInN1Y2Nlc3NcIiwgXCJGaWxlIFtbICN7ZmlsZX0gXV0gZGVsZXRlZC5cIlxyXG5cclxuZGVsZXRlRmlsZSA9IChmaWxlKSAtPlxyXG4gIGZzLmV4aXN0cyBmaWxlLCAoZXhpc3RzKSAtPlxyXG4gICAgaWYgZXhpc3RzXHJcbiAgICAgIGZzLnVubGluayBmaWxlLCAoZXJyKSAtPlxyXG4gICAgICAgIGlmIGVyclxyXG4gICAgICAgICAgbG9nIFwiZXJyb3JcIiwgXCJFcnJvciBkZWxldGluZyBmaWxlIFtbICN7ZmlsZX0gXV0sICN7ZXJyfVwiXHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgICAgbG9nIFwic3VjY2Vzc1wiLCBcIkZpbGUgW1sgI3tmaWxlfSBdXSBkZWxldGVkLlwiXHJcblxyXG5kZWxldGVEaXJlY3RvcnkgPSAoZGlyLCBjYikgLT5cclxuICBpZiBmcy5leGlzdHNTeW5jIGRpclxyXG4gICAgZnMucm1kaXIgZGlyLCAoZXJyKSAtPlxyXG4gICAgICBpZiBlcnI/LmNvZGUgaXMgbm90IFwiRU5PVEVNUFRZXCJcclxuICAgICAgICBsb2cgXCJlcnJvclwiLCBcIlVuYWJsZSB0byBkZWxldGUgZGlyZWN0b3J5IFtbICN7ZGlyfSBdXVwiXHJcbiAgICAgICAgbG9nIFwiZXJyb3JcIiwgZXJyXHJcbiAgICAgIGVsc2VcclxuICAgICAgICBsb2cgXCJpbmZvXCIsIFwiRGVsZXRlZCBlbXB0eSBkaXJlY3RvcnkgW1sgI3tkaXJ9IF1dXCJcclxuICAgICAgY2IoKSBpZiBjYlxyXG4gIGVsc2UgY2IoKSBpZiBjYlxyXG5cclxudHJhbnNmb3JtUGF0aCA9IChmaWxlLCBmcm9tLCB7c291cmNlRGlyLCBjb252ZW50aW9uc30pIC0+XHJcbiAgZml4UGF0aCA9IHdpdGhvdXRQYXRoIGZyb21cclxuICByZXN1bHQgPSBfLnJlZHVjZShjb252ZW50aW9ucywgKGFjYywge21hdGNoLCB0cmFuc2Zvcm19KSAtPlxyXG4gICAgZXh0ID0gcGF0aC5leHRuYW1lIGFjY1xyXG4gICAgaWYgbWF0Y2ggYWNjLCBleHQgdGhlbiB0cmFuc2Zvcm0gYWNjLCBwYXRoIGVsc2UgYWNjXHJcbiAgLCBmaXhQYXRoIGZpbGUpXHJcbiAgcGF0aC5qb2luIHNvdXJjZURpciwgcmVzdWx0XHJcblxyXG5leGNsdWRlU3RyYXRlZ2llcyA9XHJcbiAgc3RyaW5nOlxyXG4gICAgaWRlbnRpdHk6IF8uaXNTdHJpbmdcclxuICAgIHByZWRpY2F0ZTogKGV4LCBwYXRoKSAtPiBwYXRoLmluZGV4T2YoZXgpID09IDBcclxuICByZWdleDpcclxuICAgIGlkZW50aXR5OiBfLmlzUmVnRXhwXHJcbiAgICBwcmVkaWNhdGU6IChleCwgcGF0aCkgLT4gZXgudGVzdCBwYXRoXHJcblxyXG5pc0V4Y2x1ZGVkQnlDb25maWcgPSAocGF0aCwgZXhjbHVkZXMpIC0+XHJcbiAgb2ZUeXBlID0gKG1ldGhvZCkgLT5cclxuICAgIGV4Y2x1ZGVzLmZpbHRlciAoZikgLT4gbWV0aG9kKGYpXHJcblxyXG4gIF8uYW55IGV4Y2x1ZGVTdHJhdGVnaWVzLCAoe2lkZW50aXR5LCBwcmVkaWNhdGV9KSAtPlxyXG4gICAgXy5hbnkgKG9mVHlwZSBpZGVudGl0eSksIChleCkgLT4gcHJlZGljYXRlIGV4LCBwYXRoXHJcblxyXG5wYXJzZVhtbCA9IChjb250ZW50KSAtPlxyXG4gIHJlc3VsdCA9IHt9XHJcbiAgcGFyc2VTdHJpbmcgY29udGVudCwgKGVyciwgb3V0cHV0KSAtPlxyXG4gICAgcmVzdWx0ID0gb3V0cHV0XHJcbiAgcmVzdWx0XHJcblxyXG5maW5kQm90dGxlcyA9IChzb3VyY2VEaXIpIC0+XHJcbiAgbGlua3NGaWxlID0gcGF0aC5qb2luIHNvdXJjZURpciwgXCIubGlua3NcIlxyXG4gIGlmIGZzLmV4aXN0c1N5bmMgbGlua3NGaWxlXHJcbiAgICBlbmNvZGluZyA9IFwidXRmOFwiXHJcbiAgICBkYXRhID0gZnMucmVhZEZpbGVTeW5jIGxpbmtzRmlsZSwge2VuY29kaW5nfVxyXG4gICAgbGlua3NYbWwgPSBwYXJzZVhtbCBkYXRhXHJcbiAgICBib3R0bGVzID0gbGlua3NYbWw/LmxpbmtzPy5pbmNsdWRlIHx8IFtdXHJcbiAgICB1bmxlc3MgYm90dGxlcyBhbmQgXy5pc0FycmF5IGJvdHRsZXNcclxuICAgICAgbG9nIFwiZXJyb3JcIiwgXCIubGlua3MgZmlsZSBub3QgdmFsaWRcIlxyXG4gICAgICByZXR1cm5cclxuXHJcbiAgICBib3R0bGVzXHJcbiAgZWxzZVxyXG4gICAgW11cclxuXHJcbmJ1aWxkRXh0ZW5zaW9ucyA9IChjb25maWcpIC0+XHJcbiAge2NvcHksIGphdmFzY3JpcHQsIGNzc30gPSBjb25maWcuZXh0ZW5zaW9uc1xyXG4gIGV4dGVuc2lvbnMgPSBfLnVuaW9uIGNvcHksIGphdmFzY3JpcHQsIGNzc1xyXG5cclxuaW1wb3J0QXNzZXRzID0gKG1pbW9zYUNvbmZpZywgb3B0aW9ucywgbmV4dCkgLT5cclxuICBjb25zb2xlLmxvZyBcImltcG9ydGluZyBhc3NldHNcIlxyXG4gIHtleGNsdWRlUGF0aHMsIHNvdXJjZURpciwgY29tcGlsZWREaXIsIGlzQnVpbGQsIGNvbnZlbnRpb25zfSA9XHJcbiAgICBtaW1vc2FDb25maWcuZnVidW12Y1xyXG5cclxuICBleHRlbnNpb25zID0gYnVpbGRFeHRlbnNpb25zIG1pbW9zYUNvbmZpZ1xyXG5cclxuICBsb2cgXCJkZWJ1Z1wiLCBcImltcG9ydGluZyBhc3NldHNcIlxyXG4gIGxvZyBcImRlYnVnXCIsIFwiYWxsb3dlZCBleHRlbnNpb25zIFtbICN7ZXh0ZW5zaW9uc30gXV1cIlxyXG4gIGxvZyBcImRlYnVnXCIsIFwiZXhjbHVkZVBhdGhzIFtbICN7ZXhjbHVkZVBhdGhzfSBdXVwiXHJcblxyXG4gIGltcG9ydEZyb20gPSAodGFyZ2V0KSAtPlxyXG4gICAgZmlsZVdhdGNoZXIgPSBwcmVwYXJlRmlsZVdhdGNoZXIgdGFyZ2V0LCBleHRlbnNpb25zLCBleGNsdWRlUGF0aHMsIGlzQnVpbGRcclxuICAgIHN0YXJ0V2F0Y2hpbmcgdGFyZ2V0LCBmaWxlV2F0Y2hlciwge3NvdXJjZURpciwgY29udmVudGlvbnN9LCBuZXh0XHJcblxyXG4gIHRhcmdldHMgPSBnZXRUYXJnZXRzIGN3ZFxyXG5cclxuICBfLmVhY2ggdGFyZ2V0cywgKHRhcmdldCkgLT4gaW1wb3J0RnJvbSB0YXJnZXRcclxuICByZXR1cm5cclxuXHJcbmdldFRhcmdldHMgPSAoZGlyKSAtPlxyXG4gIGJvdHRsZXMgPSBfLm1hcCAoZmluZEJvdHRsZXMgZGlyKSwgKGJvdHRsZSkgLT4gcGF0aC5yZXNvbHZlIGRpciwgYm90dGxlXHJcbiAgdGFyZ2V0cyA9IFtdLmNvbmNhdCBib3R0bGVzLCBbZGlyXVxyXG5cclxuY2xlYW5Bc3NldHMgPSAobWltb3NhQ29uZmlnLCBvcHRpb25zLCBuZXh0KSAtPlxyXG4gIHtleHRlbnNpb25zLCBleGNsdWRlUGF0aHMsIHNvdXJjZURpciwgY29tcGlsZWREaXIsIGlzQnVpbGQsIGNvbnZlbnRpb25zfSA9XHJcbiAgICBtaW1vc2FDb25maWcuZnVidW12Y1xyXG4gIGV4dGVuc2lvbnMgPSBidWlsZEV4dGVuc2lvbnMgbWltb3NhQ29uZmlnXHJcbiAgb3B0aW9ucyA9IHtzb3VyY2VEaXIsIGNvbnZlbnRpb25zfVxyXG5cclxuICBmaWxlc0ZvciA9ICh0YXJnZXQpIC0+XHJcbiAgICBmaWxlcyAgPSBmaW5kU291cmNlRmlsZXMgdGFyZ2V0LCBleHRlbnNpb25zLCBleGNsdWRlUGF0aHNcclxuICAgIG91dHB1dEZpbGVzID0gXy5tYXAgZmlsZXMsIChmKSAtPiB0cmFuc2Zvcm1QYXRoIGYsIHRhcmdldCwgb3B0aW9uc1xyXG4gICAgW3RhcmdldCwgZmlsZXMsIG91dHB1dEZpbGVzXVxyXG5cclxuICB0YXJnZXRzID0gZ2V0VGFyZ2V0cyBjd2RcclxuICBhbGxUYXJnZXRGaWxlcyA9IF8ubWFwIHRhcmdldHMsIGZpbGVzRm9yXHJcblxyXG4gIHRyYWNrQ29tcGxldGlvbiA9IChpbml0aWFsLCBjYikgLT5cclxuICAgIHJlbWFpbmluZyA9IFtdLmNvbmNhdCBpbml0aWFsXHJcbiAgICBkb25lID0gKGRpcikgLT5cclxuICAgICAgcmVtYWluaW5nID0gXy53aXRob3V0IHJlbWFpbmluZywgZGlyXHJcbiAgICAgIGlmIHJlbWFpbmluZy5sZW5ndGggPT0gMFxyXG4gICAgICAgIGNiKClcclxuICAgIGRvbmVcclxuXHJcbiAgcmVtYWluaW5nVGFyZ2V0cyA9IFtdLmNvbmNhdCB0YXJnZXRzXHJcblxyXG4gIGZpbmlzaCA9IHRyYWNrQ29tcGxldGlvbiB0YXJnZXRzLCBuZXh0XHJcblxyXG4gIF8uZWFjaCBhbGxUYXJnZXRGaWxlcywgKFt0YXJnZXQsIGZpbGVzLCBvdXRwdXRGaWxlc10pIC0+XHJcbiAgICBjbGVhbiBbdGFyZ2V0LCBmaWxlcywgb3V0cHV0RmlsZXNdLCAoKSAtPiBmaW5pc2godGFyZ2V0KVxyXG5cclxuICByZXR1cm5cclxuXHJcbnRyYWNrQ29tcGxldGlvbiA9IChpbml0aWFsLCBjYikgLT5cclxuICByZW1haW5pbmcgPSBbXS5jb25jYXQgaW5pdGlhbFxyXG4gIGRvbmUgPSAoZGlyKSAtPlxyXG4gICAgcmVtYWluaW5nID0gXy53aXRob3V0IHJlbWFpbmluZywgZGlyXHJcbiAgICBpZiByZW1haW5pbmcubGVuZ3RoID09IDBcclxuICAgICAgY2IoKVxyXG4gIGRvbmVcclxuXHJcbmNsZWFuID0gKFt0YXJnZXQsIGZpbGVzLCBvdXRwdXRGaWxlc10sIGNiKSAtPlxyXG4gIF8uZWFjaCBvdXRwdXRGaWxlcywgKGYpIC0+IGRlbGV0ZUZpbGVTeW5jIGZcclxuXHJcbiAgZGlycyA9IF8gb3V0cHV0RmlsZXNcclxuICAgIC5tYXAgKGYpIC0+IHBhdGguZGlybmFtZSBmXHJcbiAgICAuc29ydEJ5IFwibGVuZ3RoXCJcclxuICAgIC5yZXZlcnNlKClcclxuICAgIC52YWx1ZSgpXHJcblxyXG4gIGRvbmUgPSB0cmFja0NvbXBsZXRpb24gZGlycywgY2JcclxuXHJcbiAgXyBkaXJzXHJcbiAgICAubWFwIChkaXIpIC0+IFtkaXIsICgpIC0+IGRvbmUoZGlyKV1cclxuICAgIC5lYWNoIChbZGlyLCBjYl0pIC0+XHJcbiAgICAgIGRlbGV0ZURpcmVjdG9yeSBkaXIsIGNiXHJcblxyXG4gICNmaWxlcyAgPSBmaW5kU291cmNlRmlsZXMgY3dkLCBleHRlbnNpb25zLCBleGNsdWRlUGF0aHNcclxuICAjb3V0cHV0RmlsZXMgPSBfLm1hcCBmaWxlcywgKGYpIC0+IHRyYW5zZm9ybVBhdGggZiwgY3dkLCBvcHRpb25zXHJcblxyXG4gICNjb25zb2xlLmxvZyBcImZpbGVzOiAje2ZpbGVzfVwiXHJcbiAgI2NvbnNvbGUubG9nIFwib3V0cHV0RmlsZXM6ICN7b3V0cHV0RmlsZXN9XCJcclxuXHJcbiAgI18uZWFjaCBvdXRwdXRGaWxlcywgKGYpIC0+IGRlbGV0ZUZpbGVTeW5jIGZcclxuXHJcbiAgI2RpcnMgPSBfIGZpbGVzXHJcbiAgIyAgLm1hcCAoZikgLT4gdHJhbnNmb3JtUGF0aCBmLCBjd2QsIG9wdGlvbnNcclxuICAjICAubWFwIChmKSAtPiBwYXRoLmRpcm5hbWUgZlxyXG4gICMgIC5zb3J0QnkgXCJsZW5ndGhcIlxyXG4gICMgIC5yZXZlcnNlKClcclxuICAjICAudmFsdWUoKVxyXG5cclxuICAjcmVtYWluaW5nRGlycyA9IFtdLmNvbmNhdCBkaXJzXHJcbiAgI2RvbmUgPSAoZGlyKSAtPlxyXG4gICMgIHJlbWFpbmluZ0RpcnMgPSBfLndpdGhvdXQgcmVtYWluaW5nRGlycywgZGlyXHJcbiAgIyAgaWYgcmVtYWluaW5nRGlycy5sZW5ndGggPT0gMFxyXG4gICMgICAgbmV4dCgpXHJcblxyXG4gICNfIGRpcnNcclxuICAjICAubWFwIChkaXIpIC0+IFtkaXIsICgpIC0+IGRvbmUoZGlyKV1cclxuICAjICAuZWFjaCAoW2RpciwgY2JdKSAtPlxyXG4gICMgICAgZGVsZXRlRGlyZWN0b3J5IGRpciwgY2JcclxuXHJcbm1vZHVsZS5leHBvcnRzID0ge2ltcG9ydEFzc2V0cywgY2xlYW5Bc3NldHN9XHJcbiJdfQ==
