"use strict";
var Rx, buildExtensions, clean, cleanAssets, color, copyFile, cwd, deleteDirectory, deleteFile, deleteFileSync, excludeStrategies, findBottles, findSourceFiles, fs, getTargets, importAssets, isExcludedByConfig, log, parseString, parseXml, path, prepareFileWatcher, printObj, shouldInclude, startWatching, trackCompletion, transformPath, watch, withoutPath, wrench, _, _ref;

_ref = require('./util'), log = _ref.log, printObj = _ref.printObj;

color = require('ansi-color').set;

fs = require('fs');

path = require('path');

watch = require('chokidar');

wrench = require('wrench');

_ = require('lodash');

parseString = require('xml2js').parseString;

cwd = process.cwd();

Rx = require("rx");

findSourceFiles = function(from, extensions, excludes) {
  return wrench.readdirSyncRecursive(from).filter(function(f) {
    var isFile, isIncluded, originalFile;
    originalFile = path.join(from, f);
    isFile = fs.statSync(originalFile).isFile();
    isIncluded = shouldInclude(f, isFile, extensions, excludes);
    return isIncluded && isFile;
  }).map(function(f) {
    return path.join(from, f);
  });
};

shouldInclude = function(f, isFile, extensions, excludes) {
  var atRoot, excluded, ext, matchesExtension;
  extensions = extensions.map(function(ext) {
    return "." + ext;
  });
  ext = path.extname(f);
  matchesExtension = !isFile || _.contains(extensions, ext);
  atRoot = isFile && f.indexOf(path.sep) === -1;
  excluded = isExcludedByConfig(f, excludes);
  return matchesExtension && !excluded && !atRoot;
};

withoutPath = function(fromPath) {
  return function(input) {
    return input.replace("" + fromPath + path.sep, '');
  };
};

prepareFileWatcher = function(from, extensions, excludes, isBuild, fileWatcherSettings) {
  var adds, changes, errors, files, fixPath, numberOfFiles, observableFor, settings, unlinks, watchSettings, watcher;
  files = findSourceFiles(from, extensions, excludes);
  numberOfFiles = files.length;
  fixPath = withoutPath(from);
  settings = {
    ignored: function(file) {
      var f, isFile;
      isFile = fs.statSync(file).isFile();
      f = fixPath(file);
      return !(shouldInclude(f, isFile, extensions, excludes));
    },
    persistent: !isBuild
  };
  watchSettings = _.extend(settings, fileWatcherSettings);
  observableFor = function(event) {
    return Rx.Observable.fromEvent(watcher, event);
  };
  log("debug", "starting file watcher on [[ " + from + " ]] usePolling: " + watchSettings.usePolling);
  watcher = watch.watch(from, watchSettings);
  adds = observableFor("add");
  changes = observableFor("change");
  unlinks = observableFor("unlink");
  errors = (observableFor("error")).selectMany(function(e) {
    return Rx.Observable["throw"](e);
  });
  return {
    numberOfFiles: numberOfFiles,
    adds: adds,
    changes: changes,
    unlinks: unlinks,
    errors: errors
  };
};

startWatching = function(from, _arg, options, cb) {
  var adds, changes, deletes, errors, fromSource, initialCopy, numberOfFiles, unlinks;
  numberOfFiles = _arg.numberOfFiles, adds = _arg.adds, changes = _arg.changes, unlinks = _arg.unlinks, errors = _arg.errors;
  fromSource = function(obs) {
    return obs.merge(errors);
  };
  initialCopy = fromSource(adds).take(numberOfFiles);
  initialCopy.subscribe(function(f) {
    return copyFile(f, from, options);
  }, function(e) {
    log("warn", "File watching error: " + e);
    if (cb) {
      return cb();
    }
  }, function() {
    var ongoingCopy;
    ongoingCopy = fromSource(adds.merge(changes));
    ongoingCopy.subscribe(function(f) {
      return copyFile(f, from, options);
    }, function(e) {
      return log("warn", "File watching error: " + e);
    });
    log("info", "finished initial copy for: " + from);
    if (cb) {
      return cb();
    }
  });
  deletes = fromSource(unlinks);
  return deletes.subscribe(function(f) {
    var outFile;
    outFile = transformPath(f, from, options);
    return deleteFile(outFile);
  }, function(e) {
    return log("warn", "File watching errors: " + e);
  });
};

copyFile = function(file, from, options) {
  return fs.readFile(file, function(err, data) {
    var dirname, outFile;
    if (err) {
      log("error", "Error reading file [[ " + file + " ]], " + err);
      return;
    }
    outFile = transformPath(file, from, options);
    dirname = path.dirname(outFile);
    if (!fs.existsSync(dirname)) {
      wrench.mkdirSyncRecursive(dirname, 0x1ff);
    }
    return fs.writeFile(outFile, data, function(err) {
      if (err) {
        return log("error", "Error reading file [[ " + file + " ]], " + err);
      } else {
        return log("success", "File copied to destination [[ " + outFile + " ]].");
      }
    });
  });
};

deleteFileSync = function(file) {
  if (fs.existsSync(file)) {
    fs.unlinkSync(file);
    return log("success", "File [[ " + file + " ]] deleted.");
  }
};

deleteFile = function(file) {
  return fs.exists(file, function(exists) {
    if (exists) {
      return fs.unlink(file, function(err) {
        if (err) {
          return log("error", "Error deleting file [[ " + file + " ]], " + err);
        } else {
          return log("success", "File [[ " + file + " ]] deleted.");
        }
      });
    }
  });
};

deleteDirectory = function(dir, cb) {
  if (fs.existsSync(dir)) {
    return fs.rmdir(dir, function(err) {
      if ((err != null ? err.code : void 0) === !"ENOTEMPTY") {
        log("error", "Unable to delete directory [[ " + dir + " ]]");
        log("error", err);
      } else {
        log("info", "Deleted empty directory [[ " + dir + " ]]");
      }
      if (cb) {
        return cb();
      }
    });
  } else {
    if (cb) {
      return cb();
    }
  }
};

transformPath = function(file, from, _arg) {
  var conventions, fixPath, result, sourceDir;
  sourceDir = _arg.sourceDir, conventions = _arg.conventions;
  fixPath = withoutPath(from);
  result = _.reduce(conventions, function(acc, _arg1) {
    var ext, match, transform;
    match = _arg1.match, transform = _arg1.transform;
    ext = path.extname(acc);
    if (match(acc, ext, log)) {
      return transform(acc, path, log);
    } else {
      return acc;
    }
  }, fixPath(file));
  return path.join(sourceDir, result);
};

excludeStrategies = {
  string: {
    identity: _.isString,
    predicate: function(ex, path) {
      return path.indexOf(ex) === 0;
    }
  },
  regex: {
    identity: _.isRegExp,
    predicate: function(ex, path) {
      return ex.test(path);
    }
  }
};

isExcludedByConfig = function(path, excludes) {
  var ofType;
  ofType = function(method) {
    return excludes.filter(function(f) {
      return method(f);
    });
  };
  return _.any(excludeStrategies, function(_arg) {
    var identity, predicate;
    identity = _arg.identity, predicate = _arg.predicate;
    return _.any(ofType(identity), function(ex) {
      return predicate(ex, path);
    });
  });
};

parseXml = function(content) {
  var result;
  result = {};
  parseString(content, function(err, output) {
    return result = output;
  });
  return result;
};

findBottles = function(sourceDir) {
  var bottles, data, encoding, linksFile, linksXml, _ref1;
  linksFile = path.join(sourceDir, ".links");
  if (fs.existsSync(linksFile)) {
    encoding = "utf8";
    data = fs.readFileSync(linksFile, {
      encoding: encoding
    });
    linksXml = parseXml(data);
    bottles = (linksXml != null ? (_ref1 = linksXml.links) != null ? _ref1.include : void 0 : void 0) || [];
    if (!(bottles && _.isArray(bottles))) {
      log("error", ".links file not valid");
      return;
    }
    return bottles;
  } else {
    return [];
  }
};

buildExtensions = function(config) {
  var copy, css, extensions, javascript, _ref1;
  _ref1 = config.extensions, copy = _ref1.copy, javascript = _ref1.javascript, css = _ref1.css;
  return extensions = _.union(copy, javascript, css);
};

importAssets = function(mimosaConfig, options, next) {
  var binaryInterval, compiledDir, conventions, excludePaths, extensions, fileWatcherSettings, finish, importFrom, interval, isBuild, sourceDir, targets, usePolling, _ref1;
  log("info", "importing assets");
  _ref1 = mimosaConfig.fubumvc, excludePaths = _ref1.excludePaths, sourceDir = _ref1.sourceDir, compiledDir = _ref1.compiledDir, isBuild = _ref1.isBuild, conventions = _ref1.conventions, usePolling = _ref1.usePolling, interval = _ref1.interval, binaryInterval = _ref1.binaryInterval;
  extensions = buildExtensions(mimosaConfig);
  log("debug", "allowed extensions [[ " + extensions + " ]]");
  log("debug", "excludePaths [[ " + excludePaths + " ]]");
  fileWatcherSettings = {
    usePolling: usePolling,
    interval: interval,
    binaryInterval: binaryInterval
  };
  importFrom = function(target, callback) {
    var fileWatcher;
    fileWatcher = prepareFileWatcher(target, extensions, excludePaths, isBuild, fileWatcherSettings);
    return startWatching(target, fileWatcher, {
      sourceDir: sourceDir,
      conventions: conventions
    }, callback);
  };
  targets = getTargets(cwd);
  finish = trackCompletion("importAssets", targets, next);
  _.each(targets, function(target) {
    return importFrom(target, function() {
      return finish(target);
    });
  });
};

getTargets = function(dir) {
  var bottles, targets;
  bottles = _.map(findBottles(dir), function(bottle) {
    return path.resolve(dir, bottle);
  });
  return targets = [].concat(bottles, [dir]);
};

cleanAssets = function(mimosaConfig, options, next) {
  var allTargetFiles, compiledDir, conventions, excludePaths, extensions, filesFor, finish, isBuild, sourceDir, targets, _ref1;
  log("info", "cleaning assets");
  _ref1 = mimosaConfig.fubumvc, extensions = _ref1.extensions, excludePaths = _ref1.excludePaths, sourceDir = _ref1.sourceDir, compiledDir = _ref1.compiledDir, isBuild = _ref1.isBuild, conventions = _ref1.conventions;
  extensions = buildExtensions(mimosaConfig);
  options = {
    sourceDir: sourceDir,
    conventions: conventions
  };
  filesFor = function(target) {
    var files, outputFiles;
    log("debug", "finding files for: " + target + " with extensions: " + extensions + " and excludePaths: " + excludePaths);
    files = findSourceFiles(target, extensions, excludePaths);
    outputFiles = _.map(files, function(f) {
      return transformPath(f, target, options);
    });
    return [target, files, outputFiles];
  };
  targets = getTargets(cwd);
  allTargetFiles = _.map(targets, filesFor);
  finish = trackCompletion("cleanAssets", targets, next);
  _.each(allTargetFiles, function(_arg) {
    var files, outputFiles, target;
    target = _arg[0], files = _arg[1], outputFiles = _arg[2];
    return clean([target, files, outputFiles], function() {
      return finish(target);
    });
  });
};

trackCompletion = function(title, initial, cb) {
  var done, remaining;
  remaining = [].concat(initial);
  done = function(dir) {
    remaining = _.without(remaining, dir);
    if (remaining.length === 0) {
      log("info", "finished " + title);
      return cb();
    }
  };
  return done;
};

clean = function(_arg, cb) {
  var dirs, files, finish, outputFiles, target;
  target = _arg[0], files = _arg[1], outputFiles = _arg[2];
  _.each(outputFiles, function(f) {
    return deleteFileSync(f);
  });
  dirs = _(outputFiles).map(function(f) {
    return path.dirname(f);
  }).unique().sortBy("length").reverse().value();
  if (dirs.length > 0) {
    finish = trackCompletion("clean", dirs, cb);
    return _(dirs).map(function(dir) {
      return [
        dir, function() {
          return finish(dir);
        }
      ];
    }).each(function(_arg1) {
      var cb, dir;
      dir = _arg1[0], cb = _arg1[1];
      return deleteDirectory(dir, cb);
    });
  } else {
    return cb();
  }
};

module.exports = {
  importAssets: importAssets,
  cleanAssets: cleanAssets
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYzpcXGhvbWVcXGdpdGh1YlxcbWltb3NhLWZ1YnVtdmNcXGxpYlxcZnVidS1pbXBvcnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJjOlxcaG9tZVxcZ2l0aHViXFxtaW1vc2EtZnVidW12Y1xcc3JjXFxmdWJ1LWltcG9ydC5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsWUFBQSxDQUFBO0FBQUEsSUFBQSxnWEFBQTs7QUFBQSxPQUVrQixPQUFBLENBQVEsUUFBUixDQUFsQixFQUFDLFdBQUEsR0FBRCxFQUFNLGdCQUFBLFFBRk4sQ0FBQTs7QUFBQSxLQUdBLEdBQVEsT0FBQSxDQUFRLFlBQVIsQ0FBcUIsQ0FBQyxHQUg5QixDQUFBOztBQUFBLEVBSUEsR0FBSyxPQUFBLENBQVEsSUFBUixDQUpMLENBQUE7O0FBQUEsSUFLQSxHQUFPLE9BQUEsQ0FBUSxNQUFSLENBTFAsQ0FBQTs7QUFBQSxLQU1BLEdBQVEsT0FBQSxDQUFRLFVBQVIsQ0FOUixDQUFBOztBQUFBLE1BT0EsR0FBUyxPQUFBLENBQVEsUUFBUixDQVBULENBQUE7O0FBQUEsQ0FRQSxHQUFJLE9BQUEsQ0FBUSxRQUFSLENBUkosQ0FBQTs7QUFBQSxXQVNBLEdBQWMsT0FBQSxDQUFRLFFBQVIsQ0FBaUIsQ0FBQyxXQVRoQyxDQUFBOztBQUFBLEdBVUEsR0FBTSxPQUFPLENBQUMsR0FBUixDQUFBLENBVk4sQ0FBQTs7QUFBQSxFQVdBLEdBQUssT0FBQSxDQUFRLElBQVIsQ0FYTCxDQUFBOztBQUFBLGVBYUEsR0FBa0IsU0FBQyxJQUFELEVBQU8sVUFBUCxFQUFtQixRQUFuQixHQUFBO1NBQ2hCLE1BQU0sQ0FBQyxvQkFBUCxDQUE0QixJQUE1QixDQUNFLENBQUMsTUFESCxDQUNVLFNBQUMsQ0FBRCxHQUFBO0FBQ04sUUFBQSxnQ0FBQTtBQUFBLElBQUEsWUFBQSxHQUFlLElBQUksQ0FBQyxJQUFMLENBQVUsSUFBVixFQUFnQixDQUFoQixDQUFmLENBQUE7QUFBQSxJQUNB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UFIsQ0FBQTs7QUFBQSxNQTRRTSxDQUFDLE9BQVAsR0FBaUI7QUFBQSxFQUFDLGNBQUEsWUFBRDtBQUFBLEVBQWUsYUFBQSxXQUFmO0NBNVFqQixDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCJcclxuXHJcbntsb2csIHByaW50T2JqfSA9IHJlcXVpcmUgJy4vdXRpbCdcclxuY29sb3IgPSByZXF1aXJlKCdhbnNpLWNvbG9yJykuc2V0XHJcbmZzID0gcmVxdWlyZSAnZnMnXHJcbnBhdGggPSByZXF1aXJlICdwYXRoJ1xyXG53YXRjaCA9IHJlcXVpcmUgJ2Nob2tpZGFyJ1xyXG53cmVuY2ggPSByZXF1aXJlICd3cmVuY2gnXHJcbl8gPSByZXF1aXJlICdsb2Rhc2gnXHJcbnBhcnNlU3RyaW5nID0gcmVxdWlyZSgneG1sMmpzJykucGFyc2VTdHJpbmdcclxuY3dkID0gcHJvY2Vzcy5jd2QoKVxyXG5SeCA9IHJlcXVpcmUgXCJyeFwiXHJcblxyXG5maW5kU291cmNlRmlsZXMgPSAoZnJvbSwgZXh0ZW5zaW9ucywgZXhjbHVkZXMpIC0+XHJcbiAgd3JlbmNoLnJlYWRkaXJTeW5jUmVjdXJzaXZlKGZyb20pXHJcbiAgICAuZmlsdGVyIChmKSAtPlxyXG4gICAgICBvcmlnaW5hbEZpbGUgPSBwYXRoLmpvaW4gZnJvbSwgZlxyXG4gICAgICBpc0ZpbGUgPSBmcy5zdGF0U3luYyhvcmlnaW5hbEZpbGUpLmlzRmlsZSgpXHJcbiAgICAgIGlzSW5jbHVkZWQgPSBzaG91bGRJbmNsdWRlIGYsIGlzRmlsZSwgZXh0ZW5zaW9ucywgZXhjbHVkZXNcclxuICAgICAgaXNJbmNsdWRlZCBhbmQgaXNGaWxlXHJcbiAgICAubWFwIChmKSAtPiBwYXRoLmpvaW4gZnJvbSwgZlxyXG5cclxuc2hvdWxkSW5jbHVkZSA9IChmLCBpc0ZpbGUsIGV4dGVuc2lvbnMsIGV4Y2x1ZGVzKSAtPlxyXG4gICNUT0RPOiBvbmx5IGFkZHMgdGhlIC4gdG8geW91IGZvciBleHRlbnNpb25zIGlmIGl0cyBsZWZ0IG9mZlxyXG4gIGV4dGVuc2lvbnMgPSBleHRlbnNpb25zLm1hcCAoZXh0KSAtPiBcIi4je2V4dH1cIlxyXG4gIGV4dCA9IHBhdGguZXh0bmFtZSBmXHJcbiAgbWF0Y2hlc0V4dGVuc2lvbiA9IG5vdCBpc0ZpbGUgb3IgXy5jb250YWlucyBleHRlbnNpb25zLCBleHRcclxuICBhdFJvb3QgPSBpc0ZpbGUgYW5kIGYuaW5kZXhPZihwYXRoLnNlcCkgPT0gLTFcclxuICBleGNsdWRlZCA9IGlzRXhjbHVkZWRCeUNvbmZpZyBmLCBleGNsdWRlc1xyXG4gIG1hdGNoZXNFeHRlbnNpb24gYW5kIG5vdCBleGNsdWRlZCBhbmQgbm90IGF0Um9vdFxyXG5cclxud2l0aG91dFBhdGggPSAoZnJvbVBhdGgpIC0+XHJcbiAgKGlucHV0KSAtPiBpbnB1dC5yZXBsYWNlIFwiI3tmcm9tUGF0aH0je3BhdGguc2VwfVwiLCAnJ1xyXG5cclxucHJlcGFyZUZpbGVXYXRjaGVyID0gKGZyb20sIGV4dGVuc2lvbnMsIGV4Y2x1ZGVzLCBpc0J1aWxkLCBmaWxlV2F0Y2hlclNldHRpbmdzKSAtPlxyXG4gICNUT0RPOiBubyBtb3JlIHN5bmMgY2FsbHNcclxuICBmaWxlcyAgPSBmaW5kU291cmNlRmlsZXMgZnJvbSwgZXh0ZW5zaW9ucywgZXhjbHVkZXNcclxuICBudW1iZXJPZkZpbGVzICA9IGZpbGVzLmxlbmd0aFxyXG4gIGZpeFBhdGggPSB3aXRob3V0UGF0aCBmcm9tXHJcblxyXG4gIHNldHRpbmdzID1cclxuICAgIGlnbm9yZWQ6IChmaWxlKSAtPlxyXG4gICAgICBpc0ZpbGUgPSBmcy5zdGF0U3luYyhmaWxlKS5pc0ZpbGUoKVxyXG4gICAgICBmID0gZml4UGF0aCBmaWxlXHJcbiAgICAgIG5vdCAoc2hvdWxkSW5jbHVkZSBmLCBpc0ZpbGUsIGV4dGVuc2lvbnMsIGV4Y2x1ZGVzKVxyXG4gICAgcGVyc2lzdGVudDogbm90IGlzQnVpbGRcclxuXHJcbiAgd2F0Y2hTZXR0aW5ncyA9IF8uZXh0ZW5kIHNldHRpbmdzLCBmaWxlV2F0Y2hlclNldHRpbmdzXHJcblxyXG4gIG9ic2VydmFibGVGb3IgPSAoZXZlbnQpIC0+XHJcbiAgICBSeC5PYnNlcnZhYmxlLmZyb21FdmVudCB3YXRjaGVyLCBldmVudFxyXG5cclxuICBsb2cgXCJkZWJ1Z1wiLCBcInN0YXJ0aW5nIGZpbGUgd2F0Y2hlciBvbiBbWyAje2Zyb219IF1dIHVzZVBvbGxpbmc6ICN7d2F0Y2hTZXR0aW5ncy51c2VQb2xsaW5nfVwiXHJcblxyXG4gIHdhdGNoZXIgPSB3YXRjaC53YXRjaCBmcm9tLCB3YXRjaFNldHRpbmdzXHJcbiAgYWRkcyA9IG9ic2VydmFibGVGb3IgXCJhZGRcIlxyXG4gIGNoYW5nZXMgPSBvYnNlcnZhYmxlRm9yIFwiY2hhbmdlXCJcclxuICB1bmxpbmtzID0gb2JzZXJ2YWJsZUZvciBcInVubGlua1wiXHJcbiAgZXJyb3JzID0gKG9ic2VydmFibGVGb3IgXCJlcnJvclwiKS5zZWxlY3RNYW55IChlKSAtPiBSeC5PYnNlcnZhYmxlLnRocm93IGVcclxuICB7bnVtYmVyT2ZGaWxlcywgYWRkcywgY2hhbmdlcywgdW5saW5rcywgZXJyb3JzfVxyXG5cclxuc3RhcnRXYXRjaGluZyA9IChcclxuICBmcm9tLFxyXG4gIHtudW1iZXJPZkZpbGVzLCBhZGRzLCBjaGFuZ2VzLCB1bmxpbmtzLCBlcnJvcnN9LFxyXG4gIG9wdGlvbnMsXHJcbiAgY2IpIC0+XHJcblxyXG4gIGZyb21Tb3VyY2UgPSAob2JzKSAtPlxyXG4gICAgb2JzLm1lcmdlKGVycm9ycylcclxuXHJcbiAgaW5pdGlhbENvcHkgPSBmcm9tU291cmNlKGFkZHMpLnRha2UobnVtYmVyT2ZGaWxlcylcclxuXHJcbiAgaW5pdGlhbENvcHkuc3Vic2NyaWJlKFxyXG4gICAgKGYpIC0+XHJcbiAgICAgIGNvcHlGaWxlIGYsIGZyb20sIG9wdGlvbnNcclxuICAgIChlKSAtPlxyXG4gICAgICBsb2cgXCJ3YXJuXCIsIFwiRmlsZSB3YXRjaGluZyBlcnJvcjogI3tlfVwiXHJcbiAgICAgIGNiKCkgaWYgY2JcclxuICAgICgpIC0+XHJcbiAgICAgIG9uZ29pbmdDb3B5ID0gZnJvbVNvdXJjZShhZGRzLm1lcmdlIGNoYW5nZXMpXHJcbiAgICAgIG9uZ29pbmdDb3B5LnN1YnNjcmliZShcclxuICAgICAgICAoZikgLT4gY29weUZpbGUgZiwgZnJvbSwgb3B0aW9uc1xyXG4gICAgICAgIChlKSAtPiBsb2cgXCJ3YXJuXCIsIFwiRmlsZSB3YXRjaGluZyBlcnJvcjogI3tlfVwiXHJcbiAgICAgIClcclxuICAgICAgbG9nIFwiaW5mb1wiLCBcImZpbmlzaGVkIGluaXRpYWwgY29weSBmb3I6ICN7ZnJvbX1cIlxyXG4gICAgICBjYigpIGlmIGNiXHJcbiAgKVxyXG5cclxuICBkZWxldGVzID0gZnJvbVNvdXJjZSh1bmxpbmtzKVxyXG5cclxuICBkZWxldGVzLnN1YnNjcmliZShcclxuICAgIChmKSAtPlxyXG4gICAgICBvdXRGaWxlID0gdHJhbnNmb3JtUGF0aCBmLCBmcm9tLCBvcHRpb25zXHJcbiAgICAgIGRlbGV0ZUZpbGUgb3V0RmlsZVxyXG4gICAgKGUpIC0+IGxvZyBcIndhcm5cIiwgXCJGaWxlIHdhdGNoaW5nIGVycm9yczogI3tlfVwiXHJcbiAgKVxyXG5cclxuY29weUZpbGUgPSAoZmlsZSwgZnJvbSwgb3B0aW9ucykgLT5cclxuICBmcy5yZWFkRmlsZSBmaWxlLCAoZXJyLCBkYXRhKSAtPlxyXG4gICAgaWYgZXJyXHJcbiAgICAgIGxvZyBcImVycm9yXCIsIFwiRXJyb3IgcmVhZGluZyBmaWxlIFtbICN7ZmlsZX0gXV0sICN7ZXJyfVwiXHJcbiAgICAgIHJldHVyblxyXG5cclxuICAgIG91dEZpbGUgPSB0cmFuc2Zvcm1QYXRoIGZpbGUsIGZyb20sIG9wdGlvbnNcclxuXHJcbiAgICBkaXJuYW1lID0gcGF0aC5kaXJuYW1lIG91dEZpbGVcclxuICAgIHVubGVzcyBmcy5leGlzdHNTeW5jIGRpcm5hbWVcclxuICAgICAgd3JlbmNoLm1rZGlyU3luY1JlY3Vyc2l2ZSBkaXJuYW1lLCAwbzA3NzdcclxuXHJcbiAgICBmcy53cml0ZUZpbGUgb3V0RmlsZSwgZGF0YSwgKGVycikgLT5cclxuICAgICAgaWYgZXJyXHJcbiAgICAgICAgbG9nIFwiZXJyb3JcIiwgXCJFcnJvciByZWFkaW5nIGZpbGUgW1sgI3tmaWxlfSBdXSwgI3tlcnJ9XCJcclxuICAgICAgZWxzZVxyXG4gICAgICAgIGxvZyBcInN1Y2Nlc3NcIiwgXCJGaWxlIGNvcGllZCB0byBkZXN0aW5hdGlvbiBbWyAje291dEZpbGV9IF1dLlwiXHJcblxyXG5kZWxldGVGaWxlU3luYyA9IChmaWxlKSAtPlxyXG4gIGlmIGZzLmV4aXN0c1N5bmMgZmlsZVxyXG4gICAgZnMudW5saW5rU3luYyBmaWxlXHJcbiAgICBsb2cgXCJzdWNjZXNzXCIsIFwiRmlsZSBbWyAje2ZpbGV9IF1dIGRlbGV0ZWQuXCJcclxuXHJcbmRlbGV0ZUZpbGUgPSAoZmlsZSkgLT5cclxuICBmcy5leGlzdHMgZmlsZSwgKGV4aXN0cykgLT5cclxuICAgIGlmIGV4aXN0c1xyXG4gICAgICBmcy51bmxpbmsgZmlsZSwgKGVycikgLT5cclxuICAgICAgICBpZiBlcnJcclxuICAgICAgICAgIGxvZyBcImVycm9yXCIsIFwiRXJyb3IgZGVsZXRpbmcgZmlsZSBbWyAje2ZpbGV9IF1dLCAje2Vycn1cIlxyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgIGxvZyBcInN1Y2Nlc3NcIiwgXCJGaWxlIFtbICN7ZmlsZX0gXV0gZGVsZXRlZC5cIlxyXG5cclxuZGVsZXRlRGlyZWN0b3J5ID0gKGRpciwgY2IpIC0+XHJcbiAgaWYgZnMuZXhpc3RzU3luYyBkaXJcclxuICAgIGZzLnJtZGlyIGRpciwgKGVycikgLT5cclxuICAgICAgaWYgZXJyPy5jb2RlIGlzIG5vdCBcIkVOT1RFTVBUWVwiXHJcbiAgICAgICAgbG9nIFwiZXJyb3JcIiwgXCJVbmFibGUgdG8gZGVsZXRlIGRpcmVjdG9yeSBbWyAje2Rpcn0gXV1cIlxyXG4gICAgICAgIGxvZyBcImVycm9yXCIsIGVyclxyXG4gICAgICBlbHNlXHJcbiAgICAgICAgbG9nIFwiaW5mb1wiLCBcIkRlbGV0ZWQgZW1wdHkgZGlyZWN0b3J5IFtbICN7ZGlyfSBdXVwiXHJcbiAgICAgIGNiKCkgaWYgY2JcclxuICBlbHNlIGNiKCkgaWYgY2JcclxuXHJcbnRyYW5zZm9ybVBhdGggPSAoZmlsZSwgZnJvbSwge3NvdXJjZURpciwgY29udmVudGlvbnN9KSAtPlxyXG4gIGZpeFBhdGggPSB3aXRob3V0UGF0aCBmcm9tXHJcbiAgcmVzdWx0ID0gXy5yZWR1Y2UoY29udmVudGlvbnMsIChhY2MsIHttYXRjaCwgdHJhbnNmb3JtfSkgLT5cclxuICAgIGV4dCA9IHBhdGguZXh0bmFtZSBhY2NcclxuICAgIGlmIG1hdGNoIGFjYywgZXh0LCBsb2cgdGhlbiB0cmFuc2Zvcm0gYWNjLCBwYXRoLCBsb2cgZWxzZSBhY2NcclxuICAsIGZpeFBhdGggZmlsZSlcclxuICBwYXRoLmpvaW4gc291cmNlRGlyLCByZXN1bHRcclxuXHJcbmV4Y2x1ZGVTdHJhdGVnaWVzID1cclxuICBzdHJpbmc6XHJcbiAgICBpZGVudGl0eTogXy5pc1N0cmluZ1xyXG4gICAgcHJlZGljYXRlOiAoZXgsIHBhdGgpIC0+IHBhdGguaW5kZXhPZihleCkgPT0gMFxyXG4gIHJlZ2V4OlxyXG4gICAgaWRlbnRpdHk6IF8uaXNSZWdFeHBcclxuICAgIHByZWRpY2F0ZTogKGV4LCBwYXRoKSAtPiBleC50ZXN0IHBhdGhcclxuXHJcbmlzRXhjbHVkZWRCeUNvbmZpZyA9IChwYXRoLCBleGNsdWRlcykgLT5cclxuICBvZlR5cGUgPSAobWV0aG9kKSAtPlxyXG4gICAgZXhjbHVkZXMuZmlsdGVyIChmKSAtPiBtZXRob2QoZilcclxuXHJcbiAgXy5hbnkgZXhjbHVkZVN0cmF0ZWdpZXMsICh7aWRlbnRpdHksIHByZWRpY2F0ZX0pIC0+XHJcbiAgICBfLmFueSAob2ZUeXBlIGlkZW50aXR5KSwgKGV4KSAtPiBwcmVkaWNhdGUgZXgsIHBhdGhcclxuXHJcbnBhcnNlWG1sID0gKGNvbnRlbnQpIC0+XHJcbiAgcmVzdWx0ID0ge31cclxuICBwYXJzZVN0cmluZyBjb250ZW50LCAoZXJyLCBvdXRwdXQpIC0+XHJcbiAgICByZXN1bHQgPSBvdXRwdXRcclxuICByZXN1bHRcclxuXHJcbmZpbmRCb3R0bGVzID0gKHNvdXJjZURpcikgLT5cclxuICBsaW5rc0ZpbGUgPSBwYXRoLmpvaW4gc291cmNlRGlyLCBcIi5saW5rc1wiXHJcbiAgaWYgZnMuZXhpc3RzU3luYyBsaW5rc0ZpbGVcclxuICAgIGVuY29kaW5nID0gXCJ1dGY4XCJcclxuICAgIGRhdGEgPSBmcy5yZWFkRmlsZVN5bmMgbGlua3NGaWxlLCB7ZW5jb2Rpbmd9XHJcbiAgICBsaW5rc1htbCA9IHBhcnNlWG1sIGRhdGFcclxuICAgIGJvdHRsZXMgPSBsaW5rc1htbD8ubGlua3M/LmluY2x1ZGUgfHwgW11cclxuICAgIHVubGVzcyBib3R0bGVzIGFuZCBfLmlzQXJyYXkgYm90dGxlc1xyXG4gICAgICBsb2cgXCJlcnJvclwiLCBcIi5saW5rcyBmaWxlIG5vdCB2YWxpZFwiXHJcbiAgICAgIHJldHVyblxyXG5cclxuICAgIGJvdHRsZXNcclxuICBlbHNlXHJcbiAgICBbXVxyXG5cclxuYnVpbGRFeHRlbnNpb25zID0gKGNvbmZpZykgLT5cclxuICB7Y29weSwgamF2YXNjcmlwdCwgY3NzfSA9IGNvbmZpZy5leHRlbnNpb25zXHJcbiAgZXh0ZW5zaW9ucyA9IF8udW5pb24gY29weSwgamF2YXNjcmlwdCwgY3NzXHJcblxyXG5pbXBvcnRBc3NldHMgPSAobWltb3NhQ29uZmlnLCBvcHRpb25zLCBuZXh0KSAtPlxyXG4gIGxvZyBcImluZm9cIiwgXCJpbXBvcnRpbmcgYXNzZXRzXCJcclxuICB7ZXhjbHVkZVBhdGhzLCBzb3VyY2VEaXIsIGNvbXBpbGVkRGlyLCBpc0J1aWxkLCBjb252ZW50aW9ucywgdXNlUG9sbGluZywgaW50ZXJ2YWwsIGJpbmFyeUludGVydmFsfSA9XHJcbiAgICBtaW1vc2FDb25maWcuZnVidW12Y1xyXG5cclxuICBleHRlbnNpb25zID0gYnVpbGRFeHRlbnNpb25zIG1pbW9zYUNvbmZpZ1xyXG5cclxuICBsb2cgXCJkZWJ1Z1wiLCBcImFsbG93ZWQgZXh0ZW5zaW9ucyBbWyAje2V4dGVuc2lvbnN9IF1dXCJcclxuICBsb2cgXCJkZWJ1Z1wiLCBcImV4Y2x1ZGVQYXRocyBbWyAje2V4Y2x1ZGVQYXRoc30gXV1cIlxyXG5cclxuICBmaWxlV2F0Y2hlclNldHRpbmdzID0ge3VzZVBvbGxpbmcsIGludGVydmFsLCBiaW5hcnlJbnRlcnZhbH1cclxuXHJcbiAgaW1wb3J0RnJvbSA9ICh0YXJnZXQsIGNhbGxiYWNrKSAtPlxyXG4gICAgZmlsZVdhdGNoZXIgPSBwcmVwYXJlRmlsZVdhdGNoZXIgdGFyZ2V0LCBleHRlbnNpb25zLCBleGNsdWRlUGF0aHMsIGlzQnVpbGQsIGZpbGVXYXRjaGVyU2V0dGluZ3NcclxuICAgIHN0YXJ0V2F0Y2hpbmcgdGFyZ2V0LCBmaWxlV2F0Y2hlciwge3NvdXJjZURpciwgY29udmVudGlvbnN9LCBjYWxsYmFja1xyXG5cclxuICB0YXJnZXRzID0gZ2V0VGFyZ2V0cyBjd2RcclxuXHJcbiAgZmluaXNoID0gdHJhY2tDb21wbGV0aW9uIFwiaW1wb3J0QXNzZXRzXCIsIHRhcmdldHMsIG5leHRcclxuXHJcbiAgXy5lYWNoIHRhcmdldHMsICh0YXJnZXQpIC0+XHJcbiAgICBpbXBvcnRGcm9tIHRhcmdldCwgKCkgLT4gZmluaXNoKHRhcmdldClcclxuICByZXR1cm5cclxuXHJcbmdldFRhcmdldHMgPSAoZGlyKSAtPlxyXG4gIGJvdHRsZXMgPSBfLm1hcCAoZmluZEJvdHRsZXMgZGlyKSwgKGJvdHRsZSkgLT4gcGF0aC5yZXNvbHZlIGRpciwgYm90dGxlXHJcbiAgdGFyZ2V0cyA9IFtdLmNvbmNhdCBib3R0bGVzLCBbZGlyXVxyXG5cclxuY2xlYW5Bc3NldHMgPSAobWltb3NhQ29uZmlnLCBvcHRpb25zLCBuZXh0KSAtPlxyXG4gIGxvZyBcImluZm9cIiwgXCJjbGVhbmluZyBhc3NldHNcIlxyXG4gIHtleHRlbnNpb25zLCBleGNsdWRlUGF0aHMsIHNvdXJjZURpciwgY29tcGlsZWREaXIsIGlzQnVpbGQsIGNvbnZlbnRpb25zfSA9XHJcbiAgICBtaW1vc2FDb25maWcuZnVidW12Y1xyXG4gIGV4dGVuc2lvbnMgPSBidWlsZEV4dGVuc2lvbnMgbWltb3NhQ29uZmlnXHJcbiAgb3B0aW9ucyA9IHtzb3VyY2VEaXIsIGNvbnZlbnRpb25zfVxyXG5cclxuICBmaWxlc0ZvciA9ICh0YXJnZXQpIC0+XHJcbiAgICBsb2cgXCJkZWJ1Z1wiLCBcImZpbmRpbmcgZmlsZXMgZm9yOiAje3RhcmdldH0gd2l0aCBleHRlbnNpb25zOiAje2V4dGVuc2lvbnN9IGFuZCBleGNsdWRlUGF0aHM6ICN7ZXhjbHVkZVBhdGhzfVwiXHJcbiAgICBmaWxlcyAgPSBmaW5kU291cmNlRmlsZXMgdGFyZ2V0LCBleHRlbnNpb25zLCBleGNsdWRlUGF0aHNcclxuICAgIG91dHB1dEZpbGVzID0gXy5tYXAgZmlsZXMsIChmKSAtPiB0cmFuc2Zvcm1QYXRoIGYsIHRhcmdldCwgb3B0aW9uc1xyXG4gICAgW3RhcmdldCwgZmlsZXMsIG91dHB1dEZpbGVzXVxyXG5cclxuICB0YXJnZXRzID0gZ2V0VGFyZ2V0cyBjd2RcclxuXHJcbiAgYWxsVGFyZ2V0RmlsZXMgPSBfLm1hcCB0YXJnZXRzLCBmaWxlc0ZvclxyXG5cclxuICBmaW5pc2ggPSB0cmFja0NvbXBsZXRpb24gXCJjbGVhbkFzc2V0c1wiLCB0YXJnZXRzLCBuZXh0XHJcblxyXG4gIF8uZWFjaCBhbGxUYXJnZXRGaWxlcywgKFt0YXJnZXQsIGZpbGVzLCBvdXRwdXRGaWxlc10pIC0+XHJcbiAgICBjbGVhbiBbdGFyZ2V0LCBmaWxlcywgb3V0cHV0RmlsZXNdLCAoKSAtPiBmaW5pc2godGFyZ2V0KVxyXG4gIHJldHVyblxyXG5cclxudHJhY2tDb21wbGV0aW9uID0gKHRpdGxlLCBpbml0aWFsLCBjYikgLT5cclxuICByZW1haW5pbmcgPSBbXS5jb25jYXQgaW5pdGlhbFxyXG4gIGRvbmUgPSAoZGlyKSAtPlxyXG4gICAgcmVtYWluaW5nID0gXy53aXRob3V0IHJlbWFpbmluZywgZGlyXHJcbiAgICBpZiByZW1haW5pbmcubGVuZ3RoID09IDBcclxuICAgICAgbG9nIFwiaW5mb1wiLCBcImZpbmlzaGVkICN7dGl0bGV9XCJcclxuICAgICAgY2IoKVxyXG4gIGRvbmVcclxuXHJcbmNsZWFuID0gKFt0YXJnZXQsIGZpbGVzLCBvdXRwdXRGaWxlc10sIGNiKSAtPlxyXG4gIF8uZWFjaCBvdXRwdXRGaWxlcywgKGYpIC0+IGRlbGV0ZUZpbGVTeW5jIGZcclxuXHJcbiAgZGlycyA9IF8gb3V0cHV0RmlsZXNcclxuICAgIC5tYXAgKGYpIC0+IHBhdGguZGlybmFtZSBmXHJcbiAgICAudW5pcXVlKClcclxuICAgIC5zb3J0QnkgXCJsZW5ndGhcIlxyXG4gICAgLnJldmVyc2UoKVxyXG4gICAgLnZhbHVlKClcclxuXHJcbiAgaWYgZGlycy5sZW5ndGggPiAwXHJcbiAgICBmaW5pc2ggPSB0cmFja0NvbXBsZXRpb24gXCJjbGVhblwiLCBkaXJzLCBjYlxyXG5cclxuICAgIF8gZGlyc1xyXG4gICAgICAubWFwIChkaXIpIC0+IFtkaXIsICgpIC0+IGZpbmlzaChkaXIpXVxyXG4gICAgICAuZWFjaCAoW2RpciwgY2JdKSAtPlxyXG4gICAgICAgIGRlbGV0ZURpcmVjdG9yeSBkaXIsIGNiXHJcbiAgZWxzZVxyXG4gICAgY2IoKVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSB7aW1wb3J0QXNzZXRzLCBjbGVhbkFzc2V0c31cclxuIl19
