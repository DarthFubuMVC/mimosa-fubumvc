"use strict";
var Bliss, bliss, cleanAssets, copyContents, cwd, findSourceFiles, fs, importAssets, initFiles, isExcluded, logger, makeFolders, makeOptions, mkdirp, parseString, parseXml, path, relativeToThisFile, setupFileSystem, watch, wrench, _;

fs = require('fs');

path = require('path');

watch = require('chokidar');

wrench = require('wrench');

logger = require('logmimosa');

_ = require('lodash');

mkdirp = require('mkdirp');

parseString = require('xml2js').parseString;

Bliss = require('bliss');

bliss = new Bliss({
  ext: ".bliss",
  cacheEnabled: false,
  context: {}
});

cwd = process.cwd();

importAssets = function(mimosaConfig, options, next) {
  var excludes, extensions, sourceFiles;
  extensions = mimosaConfig.extensions.copy;
  excludes = ["bin", "obj", /^\./];
  sourceFiles = findSourceFiles(extensions, excludes);
  logger.info(sourceFiles);
  return next();
};

cleanAssets = function(mimosaConfig, options, next) {
  return next();
};

findSourceFiles = function(extensions, excludes) {
  extensions = extensions.map(function(ext) {
    return "." + ext;
  });
  return wrench.readdirSyncRecursive(cwd).filter(function(f) {
    var excluded, isFile, matchesExtension;
    matchesExtension = _.contains(extensions, path.extname(f));
    isFile = fs.statSync(f).isFile();
    excluded = isExcluded(f, excludes);
    return matchesExtension && isFile && !excluded;
  });
};

isExcluded = function(path, excludes) {
  var excludeStrategies, ofType;
  excludeStrategies = {
    string: {
      identity: _.isString,
      predicate: function(ex) {
        return path.indexOf(ex) === 0;
      }
    },
    regex: {
      identity: _.isRegExp,
      predicate: function(ex) {
        return ex.test(path);
      }
    }
  };
  ofType = function(method) {
    return excludes.filter(function(f) {
      return method(f);
    });
  };
  return _.any(excludeStrategies, function(_arg) {
    var identity, predicate;
    identity = _arg.identity, predicate = _arg.predicate;
    return _.any(ofType(identity), predicate);
  });
};

relativeToThisFile = function(filePath, dirname) {
  if (dirname == null) {
    dirname = __dirname;
  }
  return path.join(dirname, filePath);
};

setupFileSystem = function(args) {
  makeFolders();
  return initFiles(args);
};

makeFolders = function() {
  var folders;
  folders = ['assets/scripts', 'assets/styles', 'public'];
  return _.each(folders, function(dir) {
    logger.info("making sure " + dir + " exists");
    return mkdirp.sync(dir, function(err) {
      return logger.error(err);
    });
  });
};

makeOptions = function() {
  var options;
  return options = {
    name: path.basename(cwd)
  };
};

initFiles = function(flags) {
  var contents, ext, fileWithContents, files, options, pair, useCoffee, _i, _len, _results;
  if (flags == null) {
    flags = false;
  }
  useCoffee = flags === "coffee";
  options = makeOptions();
  ext = useCoffee ? "coffee" : "js";
  files = ["bower.json", "mimosa-config." + ext];
  contents = _(files).map(function(f) {
    return relativeToThisFile("../fubu-import-templates/" + f);
  }).map(function(f) {
    return bliss.render(f, options);
  }).map(function(f) {
    return f.trim();
  }).value();
  fileWithContents = _.zip(files, contents);
  _results = [];
  for (_i = 0, _len = fileWithContents.length; _i < _len; _i++) {
    pair = fileWithContents[_i];
    _results.push(copyContents(pair));
  }
  return _results;
};

copyContents = function(pair) {
  var contents, fileName;
  fileName = pair[0], contents = pair[1];
  if (!fs.existsSync(fileName)) {
    logger.info("creating " + fileName);
    return fs.writeFileSync(fileName, contents);
  }
};

parseXml = function(filePath) {
  var contents, result;
  contents = fs.readFileSync(filePath);
  result = {};
  parseString(contents, function(err, output) {
    return result = output;
  });
  return result;
};

module.exports = {
  importAssets: importAssets,
  cleanAssets: cleanAssets,
  setupFileSystem: setupFileSystem
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYzpcXGhvbWVcXGdpdGh1YlxcbWltb3NhLWZ1YnVtdmNcXGxpYlxcZnVidS1pbXBvcnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJjOlxcaG9tZVxcZ2l0aHViXFxtaW1vc2EtZnVidW12Y1xcc3JjXFxmdWJ1LWltcG9ydC5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsWUFBQSxDQUFBO0FBQUEsSUFBQSxvT0FBQTs7QUFBQSxFQUVBLEdBQUssT0FBQSxDQUFRLElBQVIsQ0FGTCxDQUFBOztBQUFBLElBR0EsR0FBTyxPQUFBLENBQVEsTUFBUixDQUhQLENBQUE7O0FBQUEsS0FJQSxHQUFRLE9BQUEsQ0FBUSxVQUFSLENBSlIsQ0FBQTs7QUFBQSxNQUtBLEdBQVMsT0FBQSxDQUFRLFFBQVIsQ0FMVCxDQUFBOztBQUFBLE1BTUEsR0FBUyxPQUFBLENBQVEsV0FBUixDQU5ULENBQUE7O0FBQUEsQ0FPQSxHQUFJLE9BQUEsQ0FBUSxRQUFSLENBUEosQ0FBQTs7QUFBQSxNQVFBLEdBQVMsT0FBQSxDQUFRLFFBQVIsQ0FSVCxDQUFBOztBQUFBLFdBU0EsR0FBYyxPQUFBLENBQVEsUUFBUixDQUFpQixDQUFDLFdBVGhDLENBQUE7O0FBQUEsS0FVQSxHQUFRLE9BQUEsQ0FBUSxPQUFSLENBVlIsQ0FBQTs7QUFBQSxLQVdBLEdBQVksSUFBQSxLQUFBLENBQ1Y7QUFBQSxFQUFBLEdBQUEsRUFBSyxRQUFMO0FBQUEsRUFDQSxZQUFBLEVBQWMsS0FEZDtBQUFBLEVBRUEsT0FBQSxFQUFTLEVBRlQ7Q0FEVSxDQVhaLENBQUE7O0FBQUEsR0FlQSxHQUFNLE9BQU8sQ0FBQyxHQUFSLENBQUEsQ0FmTixDQUFBOztBQUFBLFlBaUJBLEdBQWUsU0FBQyxZQUFELEVBQWUsT0FBZixFQUF3QixJQUF4QixHQUFBO0FBQ2IsTUFBQSxpQ0FBQTtBQUFBLEVBQUEsVUFBQSxHQUFhLFlBQVksQ0FBQyxVQUFVLENBQUMsSUFBckMsQ0FBQTtBQUFBLEVBRUEsUUFB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dCI6WyJcInVzZSBzdHJpY3RcIlxyXG5cclxuZnMgPSByZXF1aXJlICdmcydcclxucGF0aCA9IHJlcXVpcmUgJ3BhdGgnXHJcbndhdGNoID0gcmVxdWlyZSAnY2hva2lkYXInXHJcbndyZW5jaCA9IHJlcXVpcmUgJ3dyZW5jaCdcclxubG9nZ2VyID0gcmVxdWlyZSAnbG9nbWltb3NhJ1xyXG5fID0gcmVxdWlyZSAnbG9kYXNoJ1xyXG5ta2RpcnAgPSByZXF1aXJlICdta2RpcnAnXHJcbnBhcnNlU3RyaW5nID0gcmVxdWlyZSgneG1sMmpzJykucGFyc2VTdHJpbmdcclxuQmxpc3MgPSByZXF1aXJlICdibGlzcydcclxuYmxpc3MgPSBuZXcgQmxpc3NcclxuICBleHQ6IFwiLmJsaXNzXCJcclxuICBjYWNoZUVuYWJsZWQ6IGZhbHNlLFxyXG4gIGNvbnRleHQ6IHt9XHJcbmN3ZCA9IHByb2Nlc3MuY3dkKClcclxuXHJcbmltcG9ydEFzc2V0cyA9IChtaW1vc2FDb25maWcsIG9wdGlvbnMsIG5leHQpIC0+XHJcbiAgZXh0ZW5zaW9ucyA9IG1pbW9zYUNvbmZpZy5leHRlbnNpb25zLmNvcHlcclxuICAjVE9ETzogZ2V0IGV4Y2x1ZGVzIGZyb20gY29uZmlnIGluc3RlYWQgb2YgaGFyZCBjb2RpbmdcclxuICBleGNsdWRlcyA9IFtcImJpblwiLCBcIm9ialwiLCAvXlxcLi9dXHJcbiAgc291cmNlRmlsZXMgPSBmaW5kU291cmNlRmlsZXMgZXh0ZW5zaW9ucywgZXhjbHVkZXNcclxuICBsb2dnZXIuaW5mbyBzb3VyY2VGaWxlc1xyXG4gICNUT0RPOiBnYXRoZXIgc291cmNlc1xyXG4gICMubGlua3MsIHdpbGwgdXNlIHBhcnNlWG1sIGZvciB0aGlzXHJcbiAgI2Z1YnUtY29udGVudFxyXG4gICNzb3VyY2UgZGlyIChpbmNsdWRpbmcgY29udGVudClcclxuICBuZXh0KClcclxuXHJcbmNsZWFuQXNzZXRzID0gKG1pbW9zYUNvbmZpZywgb3B0aW9ucywgbmV4dCkgLT5cclxuICBuZXh0KClcclxuXHJcbmZpbmRTb3VyY2VGaWxlcyA9IChleHRlbnNpb25zLCBleGNsdWRlcykgLT5cclxuICBleHRlbnNpb25zID0gZXh0ZW5zaW9ucy5tYXAgKGV4dCkgLT4gXCIuI3tleHR9XCJcclxuICB3cmVuY2gucmVhZGRpclN5bmNSZWN1cnNpdmUoY3dkKVxyXG4gICAgLmZpbHRlciAoZikgLT5cclxuICAgICAgbWF0Y2hlc0V4dGVuc2lvbiA9IF8uY29udGFpbnMgZXh0ZW5zaW9ucywgcGF0aC5leHRuYW1lIGZcclxuICAgICAgaXNGaWxlID0gZnMuc3RhdFN5bmMoZikuaXNGaWxlKClcclxuICAgICAgZXhjbHVkZWQgPSBpc0V4Y2x1ZGVkIGYsIGV4Y2x1ZGVzXHJcbiAgICAgIG1hdGNoZXNFeHRlbnNpb24gYW5kIGlzRmlsZSBhbmQgbm90IGV4Y2x1ZGVkXHJcblxyXG5pc0V4Y2x1ZGVkID0gKHBhdGgsIGV4Y2x1ZGVzKSAtPlxyXG4gIGV4Y2x1ZGVTdHJhdGVnaWVzID1cclxuICAgIHN0cmluZzpcclxuICAgICAgaWRlbnRpdHk6IF8uaXNTdHJpbmdcclxuICAgICAgcHJlZGljYXRlOiAoZXgpIC0+IHBhdGguaW5kZXhPZihleCkgPT0gMFxyXG4gICAgcmVnZXg6XHJcbiAgICAgIGlkZW50aXR5OiBfLmlzUmVnRXhwXHJcbiAgICAgIHByZWRpY2F0ZTogKGV4KSAtPiBleC50ZXN0IHBhdGhcclxuICBvZlR5cGUgPSAobWV0aG9kKSAtPlxyXG4gICAgZXhjbHVkZXMuZmlsdGVyIChmKSAtPiBtZXRob2QoZilcclxuXHJcbiAgXy5hbnkgZXhjbHVkZVN0cmF0ZWdpZXMsICh7aWRlbnRpdHksIHByZWRpY2F0ZX0pIC0+XHJcbiAgICBfLmFueSAob2ZUeXBlIGlkZW50aXR5KSwgcHJlZGljYXRlXHJcblxyXG5yZWxhdGl2ZVRvVGhpc0ZpbGUgPSAoZmlsZVBhdGgsIGRpcm5hbWUpIC0+XHJcbiAgZGlybmFtZSA/PSBfX2Rpcm5hbWVcclxuICBwYXRoLmpvaW4gZGlybmFtZSwgZmlsZVBhdGhcclxuXHJcbnNldHVwRmlsZVN5c3RlbSA9IChhcmdzKSAtPlxyXG4gIG1ha2VGb2xkZXJzKClcclxuICBpbml0RmlsZXMoYXJncylcclxuXHJcbm1ha2VGb2xkZXJzID0gLT5cclxuICAjVE9ETzogcmVhZCB0aGlzIGZyb20gY29uZmlnIHNldHRpbmdzIGluc3RlYWQgb2YgaGFyZCBjb2RpbmcgdGhpc1xyXG4gIGZvbGRlcnMgPSBbJ2Fzc2V0cy9zY3JpcHRzJywgJ2Fzc2V0cy9zdHlsZXMnLCAncHVibGljJ11cclxuICBfLmVhY2ggZm9sZGVycywgKGRpcikgLT5cclxuICAgIGxvZ2dlci5pbmZvIFwibWFraW5nIHN1cmUgI3tkaXJ9IGV4aXN0c1wiXHJcbiAgICBta2RpcnAuc3luYyBkaXIsIChlcnIpIC0+XHJcbiAgICAgIGxvZ2dlci5lcnJvcihlcnIpXHJcblxyXG5tYWtlT3B0aW9ucyA9IC0+XHJcbiAgb3B0aW9ucyA9XHJcbiAgICBuYW1lOiBwYXRoLmJhc2VuYW1lIGN3ZFxyXG5cclxuaW5pdEZpbGVzID0gKGZsYWdzID0gZmFsc2UpIC0+XHJcbiAgdXNlQ29mZmVlID0gZmxhZ3MgPT0gXCJjb2ZmZWVcIlxyXG4gIG9wdGlvbnMgPSBtYWtlT3B0aW9ucygpXHJcbiAgZXh0ID0gaWYgdXNlQ29mZmVlIHRoZW4gXCJjb2ZmZWVcIiBlbHNlIFwianNcIlxyXG4gIGZpbGVzID0gW1wiYm93ZXIuanNvblwiLCBcIm1pbW9zYS1jb25maWcuI3tleHR9XCJdXHJcbiAgY29udGVudHMgPSBfIGZpbGVzXHJcbiAgICAubWFwIChmKSAtPiByZWxhdGl2ZVRvVGhpc0ZpbGUgXCIuLi9mdWJ1LWltcG9ydC10ZW1wbGF0ZXMvI3tmfVwiXHJcbiAgICAubWFwIChmKSAtPiBibGlzcy5yZW5kZXIgZiwgb3B0aW9uc1xyXG4gICAgLm1hcCAoZikgLT4gZi50cmltKClcclxuICAgIC52YWx1ZSgpXHJcbiAgZmlsZVdpdGhDb250ZW50cyA9IF8uemlwKGZpbGVzLCBjb250ZW50cylcclxuXHJcbiAgY29weUNvbnRlbnRzIHBhaXIgZm9yIHBhaXIgaW4gZmlsZVdpdGhDb250ZW50c1xyXG5cclxuY29weUNvbnRlbnRzID0gKHBhaXIpIC0+XHJcbiAgW2ZpbGVOYW1lLCBjb250ZW50c10gPSBwYWlyXHJcbiAgdW5sZXNzIGZzLmV4aXN0c1N5bmMgZmlsZU5hbWVcclxuICAgIGxvZ2dlci5pbmZvIFwiY3JlYXRpbmcgI3tmaWxlTmFtZX1cIlxyXG4gICAgZnMud3JpdGVGaWxlU3luYyBmaWxlTmFtZSwgY29udGVudHNcclxuXHJcbnBhcnNlWG1sID0gKGZpbGVQYXRoKSAtPlxyXG4gIGNvbnRlbnRzID0gZnMucmVhZEZpbGVTeW5jIGZpbGVQYXRoXHJcbiAgcmVzdWx0ID0ge31cclxuICBwYXJzZVN0cmluZyBjb250ZW50cywgKGVyciwgb3V0cHV0KSAtPlxyXG4gICAgcmVzdWx0ID0gb3V0cHV0XHJcbiAgcmVzdWx0XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHtpbXBvcnRBc3NldHMsIGNsZWFuQXNzZXRzLCBzZXR1cEZpbGVTeXN0ZW19XHJcbiJdfQ==
